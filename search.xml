<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>JavaScriptç¼–ç¨‹é£æ ¼</title>
      <link href="/2019/01/23/6js-coding-style/"/>
      <url>/2019/01/23/6js-coding-style/</url>
      
        <content type="html"><![CDATA[<p><img src="/2019/01/23/6js-coding-style/./jscs.jpg" width="500px"><br>å¯¹äºå›¢é˜Ÿåä½œçš„å¼€å‘è€…ï¼Œç¼–ç¨‹è§„èŒƒæ˜¯å¾ˆé‡è¦çš„ã€‚æœ¬æ–‡æŒç»­æ”¶é›†/æ•´ç†/æ›´æ–°ä¸€äº›jså¼€å‘çš„è‰¯å¥½ä»£ç è§„èŒƒï¼Œå½“åšç¬”è®°ï¼Œè§„èŒƒè‡ªå·±çš„ä»£ç é£æ ¼ï¼Œè®©è‡ªå·±çš„ä»£ç æ›´å¥½çœ‹ğŸ‘€ã€‚</p><a id="more"></a><hr><h3 id="let-const"><a href="#let-const" class="headerlink" title="let const"></a>let const</h3><p>å»ºè®®ä¼˜å…ˆä½¿ç”¨constï¼Œå°¤å…¶æ˜¯åœ¨å…¨å±€ç¯å¢ƒã€‚<br>æ‰€æœ‰å‡½æ•°éƒ½åº”è¯¥è®¾ç½®ä¸ºconstã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">1</span>, b = <span class="number">2</span>, c = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">const</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">const</span> b = <span class="number">2</span>;</span><br><span class="line"><span class="keyword">const</span> c = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// best</span></span><br><span class="line"><span class="keyword">const</span> [a, b, c] = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br></pre></td></tr></table></figure><h3 id="å­—ç¬¦ä¸²"><a href="#å­—ç¬¦ä¸²" class="headerlink" title="å­—ç¬¦ä¸²"></a>å­—ç¬¦ä¸²</h3><p>é™æ€å­—ç¬¦ä¸²ä¸€å¾‹ä½¿ç”¨å•å¼•å·æˆ–åå¼•å·ï¼Œä¸ä½¿ç”¨åŒå¼•å·ï¼ŒåŠ¨æ€å­—ç¬¦ä¸²ä½¿ç”¨åå¼•å·ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">const</span> a = <span class="string">"foobar"</span>;</span><br><span class="line"><span class="keyword">const</span> b = <span class="string">'foo'</span> + a + <span class="string">'bar'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// acceptable</span></span><br><span class="line"><span class="keyword">const</span> c = <span class="string">`foobar`</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">const</span> a = <span class="string">'foobar'</span>;</span><br><span class="line"><span class="keyword">const</span> b = <span class="string">`foo<span class="subst">$&#123;a&#125;</span>bar`</span>;</span><br></pre></td></tr></table></figure><h3 id="è§£æ„èµ‹å€¼"><a href="#è§£æ„èµ‹å€¼" class="headerlink" title="è§£æ„èµ‹å€¼"></a>è§£æ„èµ‹å€¼</h3><p>ç”¨æ•°ç»„æˆå‘˜å¯¹å˜é‡èµ‹å€¼æ—¶ï¼Œä¼˜å…ˆä½¿ç”¨è§£æ„èµ‹å€¼ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">const</span> first = arr[<span class="number">0</span>];</span><br><span class="line"><span class="keyword">const</span> second = arr[<span class="number">1</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">const</span> [first, second] = arr;</span><br></pre></td></tr></table></figure></p><p>å‡½æ•°çš„å‚æ•°å¦‚æœæ˜¯å¯¹è±¡çš„æˆå‘˜ï¼Œä¼˜å…ˆä½¿ç”¨è§£æ„èµ‹å€¼ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFullName</span>(<span class="params">user</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> firstName = user.firstName;</span><br><span class="line">  <span class="keyword">const</span> lastName = user.lastName;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFullName</span>(<span class="params">obj</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; firstName, lastName &#125; = obj;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// best</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFullName</span>(<span class="params">&#123; firstName, lastName &#125;</span>) </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å¦‚æœå‡½æ•°è¿”å›å¤šä¸ªå€¼ï¼Œä¼˜å…ˆä½¿ç”¨å¯¹è±¡çš„è§£æ„èµ‹å€¼ï¼Œè€Œä¸æ˜¯æ•°ç»„çš„è§£æ„èµ‹å€¼ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">processInput</span>(<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> [left, right, top, bottom];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">processInput</span>(<span class="params">input</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123; left, right, top, bottom &#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; left, right &#125; = processInput(input);</span><br></pre></td></tr></table></figure></p><h3 id="å¯¹è±¡"><a href="#å¯¹è±¡" class="headerlink" title="å¯¹è±¡"></a>å¯¹è±¡</h3><p>å•è¡Œå®šä¹‰çš„å¯¹è±¡ï¼Œæœ€åä¸€ä¸ªæˆå‘˜ä¸ä»¥é€—å·ç»“å°¾ï¼›<br>å¤šè¡Œå®šä¹‰çš„å¯¹è±¡ï¼Œæœ€åä¸€ä¸ªæˆå‘˜ä»¥é€—å·ç»“å°¾ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> a = &#123; <span class="attr">k1</span>: v1, <span class="attr">k2</span>: v2 &#125;;</span><br><span class="line"><span class="keyword">const</span> b = &#123;</span><br><span class="line">  k1: v1,</span><br><span class="line">  k2: v2,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><p>å¯¹è±¡å°½é‡é™æ€åŒ–ï¼Œä¸€æ—¦å®šä¹‰ä¸å¾—éšæ„æ·»åŠ æ–°çš„å±æ€§ï¼Œå®åœ¨è¦æ·»åŠ ï¼Œä½¿ç”¨Object.assginåˆå¹¶<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">const</span> a = &#123;&#125;;</span><br><span class="line">a.x = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// if reshape unavoidable</span></span><br><span class="line"><span class="keyword">const</span> a = &#123;&#125;;</span><br><span class="line"><span class="built_in">Object</span>.assign(a, &#123; <span class="attr">x</span>: <span class="number">3</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">const</span> a = &#123; <span class="attr">x</span>: <span class="literal">null</span> &#125;;</span><br><span class="line">a.x = <span class="number">3</span>;</span><br></pre></td></tr></table></figure></p><p>å¦‚æœå¯¹è±¡çš„å±æ€§åæ˜¯åŠ¨æ€çš„ï¼Œå¯ä»¥åœ¨åˆ›é€ å¯¹è±¡çš„æ—¶å€™å°±ç”¨å±æ€§è¡¨è¾¾å¼å®šä¹‰ï¼Œå°†å…¶ä¸å…¶ä»–å±æ€§å®šä¹‰åœ¨ä¸€èµ·ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  id: <span class="number">5</span>,</span><br><span class="line">  name: <span class="string">'San Francisco'</span>,</span><br><span class="line">&#125;;</span><br><span class="line">obj[getKey(<span class="string">'enabled'</span>)] = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">const</span> obj = &#123;</span><br><span class="line">  id: <span class="number">5</span>,</span><br><span class="line">  name: <span class="string">'San Francisco'</span>,</span><br><span class="line">  [getKey(<span class="string">'enabled'</span>)]: <span class="literal">true</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><p>å¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ï¼Œå°½é‡é‡‡ç”¨ç®€æ´è¡¨è¾¾æ³•ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> ref = <span class="string">'some value'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">const</span> atom = &#123;</span><br><span class="line">  ref: ref,</span><br><span class="line"></span><br><span class="line">  value: <span class="number">1</span>,</span><br><span class="line"></span><br><span class="line">  addValue: <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> atom.value + value;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">const</span> atom = &#123;</span><br><span class="line">  ref,</span><br><span class="line"></span><br><span class="line">  value: <span class="number">1</span>,</span><br><span class="line"></span><br><span class="line">  addValue(value) &#123;</span><br><span class="line">    <span class="keyword">return</span> atom.value + value;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><h3 id="æ•°ç»„"><a href="#æ•°ç»„" class="headerlink" title="æ•°ç»„"></a>æ•°ç»„</h3><p>ä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦æ‹·è´æ•°ç»„<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">const</span> len = items.length;</span><br><span class="line"><span class="keyword">const</span> itemsCopy = [];</span><br><span class="line"><span class="keyword">let</span> i;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">  itemsCopy[i] = items[i];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">const</span> itemsCopy = [...items];</span><br></pre></td></tr></table></figure></p><p>ä½¿ç”¨Array.fromæ–¹æ³•ï¼Œå°†ç±»æ•°ç»„çš„å¯¹è±¡è½¬ä¸ºæ•°ç»„<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> foo = <span class="built_in">document</span>.querySelectorAll(<span class="string">'.foo'</span>);</span><br><span class="line"><span class="keyword">const</span> nodes = <span class="built_in">Array</span>.from(foo);</span><br></pre></td></tr></table></figure></p><h3 id="Mapç»“æ„"><a href="#Mapç»“æ„" class="headerlink" title="Mapç»“æ„"></a>Mapç»“æ„</h3><p>æ³¨æ„åŒºåˆ†Objectå’ŒMapï¼Œåªæœ‰æ¨¡æ‹Ÿç°å®ä¸–ç•Œçš„å®ä½“å¯¹è±¡æ—¶ï¼Œæ‰ä½¿ç”¨Objectã€‚å¦‚æœåªæ˜¯éœ€è¦<code>key: value</code>çš„æ•°æ®ç»“æ„ï¼Œä½¿ç”¨Mapç»“æ„ã€‚å› ä¸ºMapæœ‰å†…å»ºçš„éå†æœºåˆ¶ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>(arr);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">of</span> map.keys()) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(key);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> value <span class="keyword">of</span> map.values()) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> map.entries()) &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(item[<span class="number">0</span>], item[<span class="number">1</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="Class"><a href="#Class" class="headerlink" title="Class"></a>Class</h3><p>æ€»æ˜¯ç”¨Classæ¥å†™éœ€è¦prototypeçš„æ“ä½œï¼Œç”¨extendså®ç°ç»§æ‰¿ã€‚</p><h3 id="æ¨¡å—"><a href="#æ¨¡å—" class="headerlink" title="æ¨¡å—"></a>æ¨¡å—</h3><p>ä½¿ç”¨importæ›¿ä»£requireã€‚</p><p>ä½¿ç”¨exportæ›¿ä»£module.exportsã€‚</p><p>export defaultä¸æ™®é€šçš„exportå°½é‡ä¸è¦æ··ç”¨ã€‚</p><h3 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a>å˜é‡</h3><p>ä½¿ç”¨æœ‰æ„ä¹‰å¹¶ä¸”å¯è¯»æ€§å¼ºçš„å˜é‡å<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">const</span> yyyymmdstr = moment().format(<span class="string">'YYYY/MM/DD'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">const</span> currentDate = moment().format(<span class="string">'YYYY/MM/DD'</span>);</span><br></pre></td></tr></table></figure></p><p>ä½¿ç”¨åŒæ ·çš„çš„å•è¯æ¥å‘½ååŒæ ·ç±»å‹çš„å˜é‡</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line">getUserInfo();</span><br><span class="line">getClientData();</span><br><span class="line">getCustomerRecord();</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line">getUser();</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨å¯æœç´¢çš„åç§°: <em>è®©ä»£ç å…·æœ‰å¯è¯»æ€§å’Œå¯æœç´¢æ€§æ˜¯å¾ˆé‡è¦çš„</em><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="comment">// What the heck is 86400000 for?</span></span><br><span class="line">setTimeout(blastOff, <span class="number">86400000</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="comment">// å£°æ˜å®ƒä»¬ä¸ºå¤§å†™çš„å¸¸é‡</span></span><br><span class="line"><span class="keyword">const</span> MILLISECONDS_IN_A_DAY = <span class="number">86400000</span>;</span><br><span class="line">setTimeout(blastOff, MILLISECONDS_IN_A_DAY);</span><br></pre></td></tr></table></figure></p><p>ä½¿ç”¨æœ‰è§£é‡Šæ€§çš„å˜é‡<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">const</span> address = <span class="string">'One Infinite Loop, Cupertino 95014'</span>;</span><br><span class="line"><span class="keyword">const</span> cityZipCodeRegex = <span class="regexp">/^[^,\\]+[,\\\s]+(.+?)\s*(\d&#123;5&#125;)?$/</span>;</span><br><span class="line">saveCityZipCode(address.match(cityZipCodeRegex)[<span class="number">1</span>], address.match(cityZipCodeRegex)[<span class="number">2</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">const</span> address = <span class="string">'One Infinite Loop, Cupertino 95014'</span>;</span><br><span class="line"><span class="keyword">const</span> cityZipCodeRegex = <span class="regexp">/^[^,\\]+[,\\\s]+(.+?)\s*(\d&#123;5&#125;)?$/</span>;</span><br><span class="line"><span class="keyword">const</span> [, city, zipCode] = address.match(cityZipCodeRegex) || [];</span><br><span class="line">saveCityZipCode(city, zipCode);</span><br></pre></td></tr></table></figure></p><p>é¿å…ä¸æ¸…æ™°çš„mapping <em>æ˜ç¡®çš„æ¯”éšå¼çš„è¦å¥½</em><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">const</span> locations = [<span class="string">'Austin'</span>, <span class="string">'New York'</span>, <span class="string">'San Francisco'</span>];</span><br><span class="line">locations.forEach(<span class="function">(<span class="params">l</span>) =&gt;</span> &#123;</span><br><span class="line">  doStuff();</span><br><span class="line">  doSomeOtherStuff();</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="comment">// Wait, what is `l` for again?</span></span><br><span class="line">  dispatch(l);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">const</span> locations = [<span class="string">'Austin'</span>, <span class="string">'New York'</span>, <span class="string">'San Francisco'</span>];</span><br><span class="line">locations.forEach(<span class="function">(<span class="params">location</span>) =&gt;</span> &#123;</span><br><span class="line">  doStuff();</span><br><span class="line">  doSomeOtherStuff();</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  dispatch(location);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><p>ä¸è¦æ·»åŠ æ²¡æœ‰å¿…è¦çš„å¤šä½™çš„æ–‡æœ¬ï¼š<em>å¦‚æœä½ çš„å¯¹è±¡åæˆ–è€…ç±»åå·²ç»æ¸…æ™°çš„æŒ‡æ˜äº†å®ƒçš„ä½œç”¨ï¼Œæ²¡æœ‰å¿…è¦å†åœ¨å±æ€§åä¸­é‡å¤çš„å†™å¤šä½™çš„å†…å®¹</em></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">const</span> Car = &#123;</span><br><span class="line">  carMake: <span class="string">'Honda'</span>,</span><br><span class="line">  carModel: <span class="string">'Accord'</span>,</span><br><span class="line">  carColor: <span class="string">'Blue'</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">paintCar</span>(<span class="params">car</span>) </span>&#123;</span><br><span class="line">  car.carColor = <span class="string">'Red'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">const</span> Car = &#123;</span><br><span class="line">  make: <span class="string">'Honda'</span>,</span><br><span class="line">  model: <span class="string">'Accord'</span>,</span><br><span class="line">  color: <span class="string">'Blue'</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">paintCar</span>(<span class="params">car</span>) </span>&#123;</span><br><span class="line">  car.color = <span class="string">'Red'</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®šä¹‰é»˜è®¤çš„å‚æ•°ï¼Œè€Œä¸æ˜¯åœ¨å‡½æ•°ä¸­ç”¨æ¡ä»¶è¯­å¥å®šä¹‰å‚æ•°ï¼š<em>å®šä¹‰é»˜è®¤å‚æ•°å¾€å¾€æ¯”çŸ­ç«–çº¿æ¡ä»¶è¯­å¥æ›´åŠ æ¸…æ™°ï¼Œè€Œä¸”æœ€å¤§çš„åŒºåˆ«åœ¨äºï¼Œä½ çš„å‡½æ•°ä»…ä»…ä¼šåœ¨å‚æ•°æ˜¯<code>undefined</code>çš„æ—¶å€™æ‰ä¼šæä¾›é»˜è®¤å‚æ•°ã€‚è€Œå…¶ä»–çš„â€œfalsyâ€å€¼ï¼Œæ¯”å¦‚<code>&#39;&#39;ï¼Œfalseï¼Œnullï¼Œ0ï¼ŒNaN</code>éƒ½ä¸ä¼šè¢«é»˜è®¤å€¼æ›¿ä»£ã€‚ç„¶è€Œï¼ŒçŸ­ç«–çº¿çš„æ¡ä»¶è¯­å¥å°±ä¸æ˜¯è¿™æ ·ã€‚</em><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createMicrobrewery</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> breweryName = name || <span class="string">'Hipster Brew Co.'</span>;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createMicrobrewery</span>(<span class="params">name = <span class="string">'Hipster Brew Co.'</span></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="å‡½æ•°1"><a href="#å‡½æ•°1" class="headerlink" title="å‡½æ•°1"></a>å‡½æ•°1</h3><p>ç«‹å³æ‰§è¡Œçš„å‡½æ•°å¯ä»¥å†™æˆç®­å¤´å‡½æ•°å½¢å¼ã€‚</p><p>éœ€è¦ä½¿ç”¨å‡½æ•°è¡¨è¾¾å¼çš„åœºåˆï¼Œå°½é‡ç”¨ç®­å¤´å‡½æ•°ä»£æ›¿ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// best</span></span><br><span class="line"><span class="keyword">let</span> a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>].map(<span class="function"><span class="params">x</span> =&gt;</span> x * x);</span><br></pre></td></tr></table></figure></p><p>ç”¨ç®­å¤´å‡½æ•°å–ä»£Function.prototype.bindï¼Œç®€å•çš„ã€å•è¡Œçš„ã€ä¸ä¼šå¤ç”¨çš„å‡½æ•°ï¼Œå»ºè®®ä½¿ç”¨ç®­å¤´å‡½æ•°ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">const</span> self = <span class="keyword">this</span>;</span><br><span class="line"><span class="keyword">const</span> boundMethod = <span class="function"><span class="keyword">function</span>(<span class="params">...params</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> method.apply(self, params);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// acceptable</span></span><br><span class="line"><span class="keyword">const</span> boundMethod = method.bind(<span class="keyword">this</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// best</span></span><br><span class="line"><span class="keyword">const</span> boundMethod = <span class="function">(<span class="params">...params</span>) =&gt;</span> method.apply(<span class="keyword">this</span>, params);</span><br></pre></td></tr></table></figure></p><p>å‡½æ•°æ‰€æœ‰é…ç½®é¡¹optionéƒ½åº”è¯¥é›†ä¸­åœ¨ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œå¹¶ä¸”æ”¾åœ¨å‡½æ•°çš„æœ€åä¸€å‚æ•°ä¸­ï¼Œå¸ƒå°”å€¼ä¸è¦ç›´æ¥å½“åšå‚æ•°ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">divide</span>(<span class="params">a, b, option = false </span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">divide</span>(<span class="params">a, b, &#123; option = false &#125; = &#123;&#125;</span>) </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä¸è¦åœ¨å‡½æ•°ä½“å†…ä½¿ç”¨argumentså˜é‡ï¼Œä½¿ç”¨restè¿ç®—ç¬¦ï¼ˆæ‰©å±•è¿ç®—ç¬¦çš„é€†è¿ç®—ï¼‰ä»£æ›¿ã€‚å› ä¸ºargumentsæ˜¯ä¸€ä¸ªç±»æ•°ç»„å¯¹è±¡ï¼Œè€Œrestè¿ç®—ç¬¦æä¾›çš„æ˜¯ä¸€ä¸ªçœŸæ­£çš„æ•°ç»„ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">concatenateAll</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> args = <span class="built_in">Array</span>.prototype.slice.call(<span class="built_in">arguments</span>);</span><br><span class="line">  <span class="keyword">return</span> args.join(<span class="string">''</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">concatenateAll</span>(<span class="params">...args</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> args.join(<span class="string">''</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ä½¿ç”¨é»˜è®¤å€¼è¯­æ³•è®¾ç½®å‡½æ•°å‚æ•°çš„é»˜è®¤å€¼ï¼Œè€Œä¸æ˜¯åœ¨å‡½æ•°å†…éƒ¨è®¾ç½®ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleThings</span>(<span class="params">opts</span>) </span>&#123;</span><br><span class="line">  opts = opts || &#123;&#125;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleThings</span>(<span class="params">opts = &#123;&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="å‡½æ•°2"><a href="#å‡½æ•°2" class="headerlink" title="å‡½æ•°2"></a>å‡½æ•°2</h3><p>å‡½æ•°çš„å‚æ•°ï¼Œåœ¨ç†æƒ³æƒ…å†µä¸‹ï¼Œå®šä¹‰æˆå°‘äºç­‰äº2ä¸ªã€‚<br><em>é™åˆ¶å‡½æ•°å‚æ•°çš„æ•°é‡æ˜¯éå¸¸é‡è¦çš„ï¼Œå› ä¸ºè¿™æ ·å¯ä»¥ä½¿å¾—æµ‹è¯•ä½ çš„å‡½æ•°æ›´åŠ ç®€å•ã€‚å‡½æ•°å®šä¹‰è¶…è¿‡ä¸‰ä¸ªå˜é‡æ—¶ï¼Œå½“ä½ é’ˆå¯¹æ¯ä¸ªç‹¬ç«‹çš„å‚æ•°ä½¿ç”¨å¤§é‡çš„ä¸åŒçš„æƒ…å†µæ¥æµ‹è¯•å‡½æ•°æ—¶ï¼Œä¼šè¯±å‘ç»„åˆæ€§çš„çˆ†ç‚¸ã€‚</em></p><p><em>ä¸€ä¸ªæˆ–è€…ä¸¤ä¸ªå‚æ•°æ˜¯æœ€ç†æƒ³çš„æƒ…å†µï¼Œä¸‰ä¸ªå‚æ•°çš„æƒ…å†µè¦å°½é‡é¿å…ã€‚ä»»ä½•æ›´å¤šçš„å‚æ•°çš„æƒ…å†µï¼Œå‚æ•°åº”è¯¥è¢«åˆå¹¶ã€‚é€šå¸¸ï¼Œå¦‚æœä¸€ä¸ªå‡½æ•°æœ‰è¶…è¿‡ä¸¤ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆä½¿ç”¨ä¸€ä¸ªé«˜çº§çš„å¯¹è±¡å½“åšå‡½æ•°çš„å‚æ•°å°±å¯ä»¥äº†ã€‚</em></p><p><em>ä¸ºäº†æ›´æ¸…æ™°çš„ä½“ç°å‡½æ•°æœŸæœ›çš„å‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ES6çš„è§£æ„èµ‹å€¼è¯­æ³•ï¼Œå®ƒçš„ä¼˜ç‚¹åœ¨äºï¼š</em></p><blockquote><ol><li>å‡½æ•°çš„å‚æ•°æ¸…æ™°æ˜äº†ï¼Œå¯ä»¥æ¸…æ™°ç›´è§‚åœ°çœ‹åˆ°å‡½æ•°è¦ç”¨åˆ°å“ªäº›å±æ€§ã€‚</li><li>è§£æ„èµ‹å€¼æ‹·è´äº†ä¼ é€’ç»™å‡½æ•°çš„å‚æ•°å¯¹è±¡çš„æŒ‡å®šçš„åŸå§‹å€¼ã€‚ï¼ˆps: ä»å‚æ•°å¯¹è±¡ä¸­è§£æ„å‡ºæ¥çš„å¯¹è±¡å’Œæ•°ç»„æ˜¯æ²¡æœ‰è¢«æ‹·è´çš„ï¼‰</li><li>Linters can warn you about unused properties, which would be impossible without destructuringã€‚(ä½†æˆ‘å°è¯•äº†ä¸€ä¸‹ï¼Œæ— è®ºæœ‰æ²¡æœ‰è§£æ„ä¼ å‚ï¼Œeslintéƒ½ä¼šæç¤ºunusedå‚æ•°ï¼ŒğŸ¤” å¥‡æ€ª ï¼‰</li></ol></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createMenu</span>(<span class="params">title, body, buttonText, cancellable</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createMenu</span>(<span class="params">&#123; title, body, buttonText, cancellable &#125;</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">createMenu(&#123;</span><br><span class="line">  title: <span class="string">'Foo'</span>,</span><br><span class="line">  body: <span class="string">'Bar'</span>,</span><br><span class="line">  buttonText: <span class="string">'Baz'</span>,</span><br><span class="line">  cancellable: <span class="literal">true</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>ä¸€ä¸ªå‡½æ•°åº”è¯¥åªåšä¸€ä»¶äº‹ï¼š<em>å‡½æ•°æ›´å®¹æ˜“é‡æ„ï¼Œä»£ç æ›´åŠ å¯è¯»ï¼Œæ›´åŠ å¹²å‡€ã€‚</em><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">emailClients</span>(<span class="params">clients</span>) </span>&#123;</span><br><span class="line">  clients.forEach(<span class="function">(<span class="params">client</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> clientRecord = database.lookup(client);</span><br><span class="line">    <span class="keyword">if</span> (clientRecord.isActive()) &#123;</span><br><span class="line">      email(client);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">emailActiveClients</span>(<span class="params">clients</span>) </span>&#123;</span><br><span class="line">  clients</span><br><span class="line">    .filter(isActiveClient)</span><br><span class="line">    .forEach(email);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isActiveClient</span>(<span class="params">client</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> clientRecord = database.lookup(client);</span><br><span class="line">  <span class="keyword">return</span> clientRecord.isActive();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>å‡½æ•°çš„å‘½ååº”è¯¥è¡¨è¾¾æ¸…æ¥šè¿™ä¸ªå‡½æ•°åšäº†ä»€ä¹ˆã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addToDate</span>(<span class="params">date, month</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line"><span class="comment">// It's hard to tell from the function name what is added</span></span><br><span class="line">addToDate(date, <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addMonthToDate</span>(<span class="params">month, date</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">addMonthToDate(<span class="number">1</span>, date);</span><br></pre></td></tr></table></figure></p><p>å‡½æ•°åº”è¯¥åªæœ‰ä¸€å±‚çš„æŠ½è±¡æ¦‚å¿µ</p><p>ç§»é™¤é‡å¤çš„ä»£ç : <em>é‡å¤çš„ä»£ç çš„ç¼ºç‚¹åœ¨äºï¼Œå¦‚æœéœ€è¦ä¿®æ”¹ç›¸åŒçš„é€»è¾‘ï¼Œä½ éœ€è¦ä¿®æ”¹ä¸åŒçš„å¥½å‡ ä¸ªåœ°æ–¹</em></p><p>ä½¿ç”¨Object.assignæ¥è®¾ç½®é»˜è®¤å¯¹è±¡å‚æ•°<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad:</span></span><br><span class="line"><span class="keyword">const</span> menuConfig = &#123;</span><br><span class="line">  title: <span class="literal">null</span>,</span><br><span class="line">  body: <span class="string">'Bar'</span>,</span><br><span class="line">  buttonText: <span class="literal">null</span>,</span><br><span class="line">  cancellable: <span class="literal">true</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createMenu</span>(<span class="params">config</span>) </span>&#123;</span><br><span class="line">  config.title = config.title || <span class="string">'Foo'</span>;</span><br><span class="line">  config.body = config.body || <span class="string">'Bar'</span>;</span><br><span class="line">  config.buttonText = config.buttonText || <span class="string">'Baz'</span>;</span><br><span class="line">  config.cancellable = config.cancellable !== <span class="literal">undefined</span> ? config.cancellable : <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">createMenu(menuConfig);</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="keyword">const</span> menuConfig = &#123;</span><br><span class="line">  title: <span class="string">'Order'</span>,</span><br><span class="line">  <span class="comment">// User did not include 'body' key</span></span><br><span class="line">  buttonText: <span class="string">'Send'</span>,</span><br><span class="line">  cancellable: <span class="literal">true</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createMenu</span>(<span class="params">config</span>) </span>&#123;</span><br><span class="line">  config = <span class="built_in">Object</span>.assign(&#123;</span><br><span class="line">    title: <span class="string">'Foo'</span>,</span><br><span class="line">    body: <span class="string">'Bar'</span>,</span><br><span class="line">    buttonText: <span class="string">'Baz'</span>,</span><br><span class="line">    cancellable: <span class="literal">true</span></span><br><span class="line">  &#125;, config);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// config now equals: &#123;title: "Order", body: "Bar", buttonText: "Send", cancellable: true&#125;</span></span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">createMenu(menuConfig);</span><br></pre></td></tr></table></figure></p><p>ä¸è¦æŠŠæ ‡å¿—ä½å½“åšå‡½æ•°çš„å‚æ•°æ¥ä¼ é€’:<em>å‡½æ•°åº”è¯¥åªåšä¸€ä»¶äº‹æƒ…ï¼Œä½†æ ‡å¿—ä½çš„ä½¿ç”¨ï¼Œè¯´æ˜ä½ ç”¨ä¸€ä¸ªå‡½æ•°æ¥åšäº†ä¸æ­¢ä¸€ä»¶äº‹æƒ…ã€‚å¦‚æœä½ é€šè¿‡ä¸€ä¸ªBooleanå€¼æ¥å†³å®šäº†ä¸åŒçš„ä»£ç è·¯å¾„ï¼Œé‚£ä¹ˆè¯·æ‹†åˆ†æˆä¸åŒçš„å‡½æ•°ã€‚</em><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// bad:</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createFile</span>(<span class="params">name, temp</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (temp) &#123;</span><br><span class="line">    fs.create(<span class="string">`./temp/<span class="subst">$&#123;name&#125;</span>`</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    fs.create(name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createFile</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  fs.create(name);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createTempFile</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  createFile(<span class="string">`./temp/<span class="subst">$&#123;name&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>é¿å…å‡½æ•°çš„å‰¯ä½œç”¨ï¼ˆä¸¤ä¸ªä¾‹å­ï¼‰<br>1) é¿å…ä¿®æ”¹å‡½æ•°ä½“å¤–çš„å…¨å±€å˜é‡<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad:</span></span><br><span class="line"><span class="comment">// Global variable referenced by following function.</span></span><br><span class="line"><span class="comment">// If we had another function that used this name, now it'd be an array and it could break it.</span></span><br><span class="line"><span class="keyword">let</span> name = <span class="string">'Ryan McDermott'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">splitIntoFirstAndLastName</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  name = name.split(<span class="string">' '</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">splitIntoFirstAndLastName();</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(name); <span class="comment">// ['Ryan', 'McDermott'];</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// good</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">splitIntoFirstAndLastName</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> name.split(<span class="string">' '</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> name = <span class="string">'Ryan McDermott'</span>;</span><br><span class="line"><span class="keyword">const</span> newName = splitIntoFirstAndLastName(name);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(name); <span class="comment">// 'Ryan McDermott';</span></span><br><span class="line"><span class="built_in">console</span>.log(newName); <span class="comment">// ['Ryan', 'McDermott'];</span></span><br></pre></td></tr></table></figure></p><p>2ï¼‰å¦‚æœéœ€è¦å¤„ç†ä¼ é€’è¿›æ¥çš„å‚æ•°ï¼Œæ€»æ˜¯æ‹·è´å®ƒå†ç¼–è¾‘å®ƒï¼Œé¿å…ç›´æ¥ä¿®æ”¹ä¼ é€’çš„å‚æ•°ã€‚<br><em>è´­ç‰©è½¦æ¡ˆä¾‹ï¼šè´­ç‰©è½¦cartæ˜¯ä¸€ä¸ªåŒ…å«äº†æ‰€æœ‰è¦è´­ä¹°çš„ç‰©å“itemçš„æ•°ç»„ï¼Œå®ƒæ˜¯purchaseè¯·æ±‚çš„ä¸€ä¸ªå‚æ•°ã€‚å½“ç½‘ç»œæ¯”è¾ƒå·®çš„æ—¶å€™ï¼Œpurchaseæ¥å£å¯èƒ½ä¼šä¸€ç›´å¤„äºå°è¯•å‘é€è¯·æ±‚çš„çŠ¶æ€ï¼Œè€Œåœ¨è¿™ä¸ªæ—¶å€™ï¼Œå¦‚æœç”¨æˆ·ä¸å°å¿ƒç‚¹å‡»äº†ä¸€ä¸ªä¸æƒ³è´­ä¹°çš„ç‰©å“ï¼Œæ·»åŠ åˆ°äº†è´­ç‰©è½¦ï¼Œç„¶åè¿™æ—¶å€™å¼€å§‹äº†ç½‘ç»œè¯·æ±‚ï¼Œæ­¤æ—¶çš„å‰¯ä½œç”¨å°±æ˜¯ï¼Œè¯·æ±‚å¯èƒ½ä¼šä¼ é€’ä¿®æ”¹åçš„cartå¯¹è±¡ã€‚</em><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// bad</span></span><br><span class="line"><span class="keyword">const</span> addItemToCart = <span class="function">(<span class="params">cart, item</span>) =&gt;</span> &#123;</span><br><span class="line">  cart.push(&#123; item, <span class="attr">date</span>: <span class="built_in">Date</span>.now() &#125;);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// good:</span></span><br><span class="line"><span class="keyword">const</span> addItemToCart = <span class="function">(<span class="params">cart, item</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> [...cart, &#123; item, <span class="attr">date</span>: <span class="built_in">Date</span>.now() &#125;];</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p><p>ä¸è¦å†™å…¨å±€çš„å‡½æ•°</p><h3 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h3><blockquote><p><a href="http://es6.ruanyifeng.com/#docs/style" target="_blank" rel="noopener">http://es6.ruanyifeng.com/#docs/style</a><br><a href="https://github.com/ryanmcdermott/clean-code-javascript" target="_blank" rel="noopener">https://github.com/ryanmcdermott/clean-code-javascript</a> ï¼ˆè¯‘ï¼‰</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> study notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> study notes </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ä½ ä¸çŸ¥é“çš„JavaScriptï¼ˆä¸Šå·ï¼‰è¯»ä¹¦ç¬”è®°</title>
      <link href="/2018/11/20/5you-dont-know-js-1/"/>
      <url>/2018/11/20/5you-dont-know-js-1/</url>
      
        <content type="html"><![CDATA[<p><img src="/2018/11/20/5you-dont-know-js-1/./cover-image.jpg" width="250px"><br>æœ¬æ–‡è®°å½•äº†æˆ‘åœ¨<a href="https://read.douban.com/ebook/12051836/" title="ä½ ä¸çŸ¥é“çš„JavaScriptï¼ˆä¸Šå·ï¼‰" target="_blank" rel="noopener">è±†ç“£è¯»ä¹¦</a>é˜…è¯»ã€Šä½ ä¸çŸ¥é“çš„JavaScriptï¼ˆä¸Šå·ï¼‰ã€‹çš„è¿‡ç¨‹ä¸­ï¼Œå¯¹ä¸€äº›é‡è¦çš„å†…å®¹è¿›è¡Œçš„åˆ’çº¿å’Œæ‰¹æ³¨ï¼Œç»å¸¸æ¥çœ‹çœ‹ï¼Œå·©å›ºå·©å›ºåŸºç¡€ã€‚</p><a id="more"></a><hr><h2 id="ç« èŠ‚ï¼š1-2-ç†è§£ä½œç”¨åŸŸ"><a href="#ç« èŠ‚ï¼š1-2-ç†è§£ä½œç”¨åŸŸ" class="headerlink" title="ç« èŠ‚ï¼š1.2ã€€ç†è§£ä½œç”¨åŸŸ"></a>ç« èŠ‚ï¼š1.2ã€€ç†è§£ä½œç”¨åŸŸ</h2><blockquote><p>LHS</p></blockquote><p>Left-Hand-Side</p><blockquote><p>RHS</p></blockquote><p>Right-Hand-Side</p><h2 id="ç« èŠ‚ï¼š4-1-å…ˆæœ‰é¸¡è¿˜æ˜¯å…ˆæœ‰è›‹"><a href="#ç« èŠ‚ï¼š4-1-å…ˆæœ‰é¸¡è¿˜æ˜¯å…ˆæœ‰è›‹" class="headerlink" title="ç« èŠ‚ï¼š4.1ã€€å…ˆæœ‰é¸¡è¿˜æ˜¯å…ˆæœ‰è›‹"></a>ç« èŠ‚ï¼š4.1ã€€å…ˆæœ‰é¸¡è¿˜æ˜¯å…ˆæœ‰è›‹</h2><blockquote><p>è€ƒè™‘å¦å¤–ä¸€æ®µä»£ç ï¼š</p></blockquote><p>æ‰“å°æ¼äº†ï¼ŒåŸä¹¦æ˜¯ï¼š var a; console.log(a); a=2;</p><h2 id="ç« èŠ‚ï¼š4-2-ç¼–è¯‘å™¨å†åº¦æ¥è¢­"><a href="#ç« èŠ‚ï¼š4-2-ç¼–è¯‘å™¨å†åº¦æ¥è¢­" class="headerlink" title="ç« èŠ‚ï¼š4.2ã€€ç¼–è¯‘å™¨å†åº¦æ¥è¢­"></a>ç« èŠ‚ï¼š4.2ã€€ç¼–è¯‘å™¨å†åº¦æ¥è¢­</h2><blockquote><p>æ­£ç¡®çš„æ€è€ƒæ€è·¯æ˜¯ï¼ŒåŒ…æ‹¬å˜é‡å’Œå‡½æ•°åœ¨å†…çš„æ‰€æœ‰å£°æ˜éƒ½ä¼šåœ¨ä»»ä½•ä»£ç è¢«æ‰§è¡Œå‰é¦–å…ˆè¢«å¤„ç†ã€‚</p></blockquote><blockquote><p>å½“ä½ çœ‹åˆ°var a = 2;æ—¶ï¼Œå¯èƒ½ä¼šè®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªå£°æ˜ã€‚ä½†JavaScriptå®é™…ä¸Šä¼šå°†å…¶çœ‹æˆä¸¤ä¸ªå£°æ˜ï¼švar a;å’Œa = 2;ã€‚ç¬¬ä¸€ä¸ªå®šä¹‰å£°æ˜æ˜¯åœ¨ç¼–è¯‘é˜¶æ®µè¿›è¡Œçš„ã€‚ç¬¬äºŒä¸ªèµ‹å€¼å£°æ˜ä¼šè¢«ç•™åœ¨åŸåœ°ç­‰å¾…æ‰§è¡Œé˜¶æ®µã€‚</p></blockquote><blockquote><p>è¿™ä¸ªè¿‡ç¨‹å°±å¥½åƒå˜é‡å’Œå‡½æ•°å£°æ˜ä»å®ƒä»¬åœ¨ä»£ç ä¸­å‡ºç°çš„ä½ç½®è¢«â€œç§»åŠ¨â€åˆ°äº†æœ€ä¸Šé¢ã€‚è¿™ä¸ªè¿‡ç¨‹å°±å«ä½œæå‡ã€‚<br>æ¢å¥è¯è¯´ï¼Œå…ˆæœ‰è›‹ï¼ˆå£°æ˜ï¼‰åæœ‰é¸¡ï¼ˆèµ‹å€¼ï¼‰ã€‚</p></blockquote><blockquote><p>åªæœ‰å£°æ˜æœ¬èº«ä¼šè¢«æå‡ï¼Œè€Œèµ‹å€¼æˆ–å…¶ä»–è¿è¡Œé€»è¾‘ä¼šç•™åœ¨åŸåœ°ã€‚</p></blockquote><blockquote><p>å‡½æ•°å£°æ˜ä¼šè¢«æå‡ï¼Œä½†æ˜¯å‡½æ•°è¡¨è¾¾å¼å´ä¸ä¼šè¢«æå‡ã€‚</p></blockquote><h2 id="ç« èŠ‚ï¼š4-3-å‡½æ•°ä¼˜å…ˆ"><a href="#ç« èŠ‚ï¼š4-3-å‡½æ•°ä¼˜å…ˆ" class="headerlink" title="ç« èŠ‚ï¼š4.3ã€€å‡½æ•°ä¼˜å…ˆ"></a>ç« èŠ‚ï¼š4.3ã€€å‡½æ•°ä¼˜å…ˆ</h2><blockquote><p>å‡½æ•°å£°æ˜å’Œå˜é‡å£°æ˜éƒ½ä¼šè¢«æå‡ã€‚ä½†æ˜¯ä¸€ä¸ªå€¼å¾—æ³¨æ„çš„ç»†èŠ‚ï¼ˆè¿™ä¸ªç»†èŠ‚å¯ä»¥å‡ºç°åœ¨æœ‰å¤šä¸ªâ€œé‡å¤â€å£°æ˜çš„ä»£ç ä¸­ï¼‰æ˜¯å‡½æ•°ä¼šé¦–å…ˆè¢«æå‡ï¼Œç„¶åæ‰æ˜¯å˜é‡ã€‚</p></blockquote><blockquote><p>å°½ç®¡é‡å¤çš„varå£°æ˜ä¼šè¢«å¿½ç•¥æ‰ï¼Œä½†å‡ºç°åœ¨åé¢çš„å‡½æ•°å£°æ˜è¿˜æ˜¯å¯ä»¥è¦†ç›–å‰é¢çš„ã€‚</p></blockquote><blockquote><p>å°½ç®¡é‡å¤çš„varå£°æ˜ä¼šè¢«å¿½ç•¥æ‰ï¼Œä½†å‡ºç°åœ¨åé¢çš„å‡½æ•°å£°æ˜è¿˜æ˜¯å¯ä»¥è¦†ç›–å‰é¢çš„ã€‚</p></blockquote><p>åˆæ¼å°äº†ï¼Œæœ€å‰é¢å°‘ä¸€è¡Œä»£ç ï¼š foo(); // 3</p><h2 id="ç« èŠ‚ï¼š4-4-å°ç»“"><a href="#ç« èŠ‚ï¼š4-4-å°ç»“" class="headerlink" title="ç« èŠ‚ï¼š4.4ã€€å°ç»“"></a>ç« èŠ‚ï¼š4.4ã€€å°ç»“</h2><blockquote><p>æˆ‘ä»¬ä¹ æƒ¯å°†var a = 2;çœ‹ä½œä¸€ä¸ªå£°æ˜ï¼Œè€Œå®é™…ä¸ŠJavaScriptå¼•æ“å¹¶ä¸è¿™ä¹ˆè®¤ä¸ºã€‚å®ƒå°†var aå’Œa = 2å½“ä½œä¸¤ä¸ªå•ç‹¬çš„å£°æ˜ï¼Œç¬¬ä¸€ä¸ªæ˜¯ç¼–è¯‘é˜¶æ®µçš„ä»»åŠ¡ï¼Œè€Œç¬¬äºŒä¸ªåˆ™æ˜¯æ‰§è¡Œé˜¶æ®µçš„ä»»åŠ¡ã€‚</p></blockquote><blockquote><p>æ„å‘³ç€æ— è®ºä½œç”¨åŸŸä¸­çš„å£°æ˜å‡ºç°åœ¨ä»€ä¹ˆåœ°æ–¹ï¼Œéƒ½å°†åœ¨ä»£ç æœ¬èº«è¢«æ‰§è¡Œå‰é¦–å…ˆè¿›è¡Œå¤„ç†ã€‚å¯ä»¥å°†è¿™ä¸ªè¿‡ç¨‹å½¢è±¡åœ°æƒ³è±¡æˆæ‰€æœ‰çš„å£°æ˜ï¼ˆå˜é‡å’Œå‡½æ•°ï¼‰éƒ½ä¼šè¢«â€œç§»åŠ¨â€åˆ°å„è‡ªä½œç”¨åŸŸçš„æœ€é¡¶ç«¯ï¼Œè¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸ºæå‡ã€‚</p></blockquote><blockquote><p>å£°æ˜æœ¬èº«ä¼šè¢«æå‡ï¼Œè€ŒåŒ…æ‹¬å‡½æ•°è¡¨è¾¾å¼çš„èµ‹å€¼åœ¨å†…çš„èµ‹å€¼æ“ä½œå¹¶ä¸ä¼šæå‡ã€‚</p></blockquote><h2 id="ç« èŠ‚ï¼š5-2-å®è´¨é—®é¢˜"><a href="#ç« èŠ‚ï¼š5-2-å®è´¨é—®é¢˜" class="headerlink" title="ç« èŠ‚ï¼š5.2ã€€å®è´¨é—®é¢˜"></a>ç« èŠ‚ï¼š5.2ã€€å®è´¨é—®é¢˜</h2><blockquote><p>å½“å‡½æ•°å¯ä»¥è®°ä½å¹¶è®¿é—®æ‰€åœ¨çš„è¯æ³•ä½œç”¨åŸŸæ—¶ï¼Œå°±äº§ç”Ÿäº†é—­åŒ…ï¼Œå³ä½¿å‡½æ•°æ˜¯åœ¨å½“å‰è¯æ³•ä½œç”¨åŸŸä¹‹å¤–æ‰§è¡Œã€‚</p></blockquote><blockquote><p>é—­åŒ…ä½¿å¾—å‡½æ•°å¯ä»¥ç»§ç»­è®¿é—®å®šä¹‰æ—¶çš„è¯æ³•ä½œç”¨åŸŸã€‚</p></blockquote><h2 id="ç« èŠ‚ï¼š5-3-ç°åœ¨æˆ‘æ‡‚äº†"><a href="#ç« èŠ‚ï¼š5-3-ç°åœ¨æˆ‘æ‡‚äº†" class="headerlink" title="ç« èŠ‚ï¼š5.3ã€€ç°åœ¨æˆ‘æ‡‚äº†"></a>ç« èŠ‚ï¼š5.3ã€€ç°åœ¨æˆ‘æ‡‚äº†</h2><blockquote><p>æœ¬è´¨ä¸Šæ— è®ºä½•æ—¶ä½•åœ°ï¼Œå¦‚æœå°†å‡½æ•°ï¼ˆè®¿é—®å®ƒä»¬å„è‡ªçš„è¯æ³•ä½œç”¨åŸŸï¼‰å½“ä½œç¬¬ä¸€çº§çš„å€¼ç±»å‹å¹¶åˆ°å¤„ä¼ é€’ï¼Œä½ å°±ä¼šçœ‹åˆ°é—­åŒ…åœ¨è¿™äº›å‡½æ•°ä¸­çš„åº”ç”¨ã€‚åœ¨å®šæ—¶å™¨ã€äº‹ä»¶ç›‘å¬å™¨ã€Ajaxè¯·æ±‚ã€è·¨çª—å£é€šä¿¡ã€Web Workersæˆ–è€…ä»»ä½•å…¶ä»–çš„å¼‚æ­¥ï¼ˆæˆ–è€…åŒæ­¥ï¼‰ä»»åŠ¡ä¸­ï¼Œåªè¦ä½¿ç”¨äº†å›è°ƒå‡½æ•°ï¼Œå®é™…ä¸Šå°±æ˜¯åœ¨ä½¿ç”¨é—­åŒ…ï¼</p></blockquote><h2 id="ç« èŠ‚ï¼š5-6-å°ç»“"><a href="#ç« èŠ‚ï¼š5-6-å°ç»“" class="headerlink" title="ç« èŠ‚ï¼š5.6ã€€å°ç»“"></a>ç« èŠ‚ï¼š5.6ã€€å°ç»“</h2><blockquote><p>å½“å‡½æ•°å¯ä»¥è®°ä½å¹¶è®¿é—®æ‰€åœ¨çš„è¯æ³•ä½œç”¨åŸŸï¼Œå³ä½¿å‡½æ•°æ˜¯åœ¨å½“å‰è¯æ³•ä½œç”¨åŸŸä¹‹å¤–æ‰§è¡Œï¼Œè¿™æ—¶å°±äº§ç”Ÿäº†é—­åŒ…ã€‚</p></blockquote><blockquote><p>é—­åŒ…ä¹Ÿæ˜¯ä¸€ä¸ªéå¸¸å¼ºå¤§çš„å·¥å…·ï¼Œå¯ä»¥ç”¨å¤šç§å½¢å¼æ¥å®ç°æ¨¡å—ç­‰æ¨¡å¼ã€‚</p></blockquote><blockquote><p>æ¨¡å—æœ‰ä¸¤ä¸ªä¸»è¦ç‰¹å¾ï¼š(1)ä¸ºåˆ›å»ºå†…éƒ¨ä½œç”¨åŸŸè€Œè°ƒç”¨äº†ä¸€ä¸ªåŒ…è£…å‡½æ•°ï¼›(2)åŒ…è£…å‡½æ•°çš„è¿”å›å€¼å¿…é¡»è‡³å°‘åŒ…æ‹¬ä¸€ä¸ªå¯¹å†…éƒ¨å‡½æ•°çš„å¼•ç”¨ï¼Œè¿™æ ·å°±ä¼šåˆ›å»ºæ¶µç›–æ•´ä¸ªåŒ…è£…å‡½æ•°å†…éƒ¨ä½œç”¨åŸŸçš„é—­åŒ…ã€‚</p></blockquote><h2 id="ç« èŠ‚ï¼šé™„å½•C-this-è¯æ³•"><a href="#ç« èŠ‚ï¼šé™„å½•C-this-è¯æ³•" class="headerlink" title="ç« èŠ‚ï¼šé™„å½•Cã€€ this è¯æ³•"></a>ç« èŠ‚ï¼šé™„å½•Cã€€ this è¯æ³•</h2><blockquote><p>ç®­å¤´å‡½æ•°åœ¨æ¶‰åŠthisç»‘å®šæ—¶çš„è¡Œä¸ºå’Œæ™®é€šå‡½æ•°çš„è¡Œä¸ºå®Œå…¨ä¸ä¸€è‡´ã€‚å®ƒæ”¾å¼ƒäº†æ‰€æœ‰æ™®é€šthisç»‘å®šçš„è§„åˆ™ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ç”¨å½“å‰çš„è¯æ³•ä½œç”¨åŸŸè¦†ç›–äº†thisæœ¬æ¥çš„å€¼ã€‚</p></blockquote><h2 id="ç« èŠ‚ï¼š1-2-è¯¯è§£"><a href="#ç« èŠ‚ï¼š1-2-è¯¯è§£" class="headerlink" title="ç« èŠ‚ï¼š1.2ã€€è¯¯è§£"></a>ç« èŠ‚ï¼š1.2ã€€è¯¯è§£</h2><blockquote><p>thisåœ¨ä»»ä½•æƒ…å†µä¸‹éƒ½ä¸æŒ‡å‘å‡½æ•°çš„è¯æ³•ä½œç”¨åŸŸ</p></blockquote><h2 id="ç« èŠ‚ï¼š1-3-this-åˆ°åº•æ˜¯ä»€ä¹ˆ"><a href="#ç« èŠ‚ï¼š1-3-this-åˆ°åº•æ˜¯ä»€ä¹ˆ" class="headerlink" title="ç« èŠ‚ï¼š1.3ã€€ this åˆ°åº•æ˜¯ä»€ä¹ˆ"></a>ç« èŠ‚ï¼š1.3ã€€ this åˆ°åº•æ˜¯ä»€ä¹ˆ</h2><blockquote><p>thisæ˜¯åœ¨è¿è¡Œæ—¶è¿›è¡Œç»‘å®šçš„ï¼Œå¹¶ä¸æ˜¯åœ¨ç¼–å†™æ—¶ç»‘å®šï¼Œå®ƒçš„ä¸Šä¸‹æ–‡å–å†³äºå‡½æ•°è°ƒç”¨æ—¶çš„å„ç§æ¡ä»¶ã€‚thisçš„ç»‘å®šå’Œå‡½æ•°å£°æ˜çš„ä½ç½®æ²¡æœ‰ä»»ä½•å…³ç³»ï¼Œåªå–å†³äºå‡½æ•°çš„è°ƒç”¨æ–¹å¼ã€‚</p></blockquote><h2 id="ç« èŠ‚ï¼š1-4-å°ç»“"><a href="#ç« èŠ‚ï¼š1-4-å°ç»“" class="headerlink" title="ç« èŠ‚ï¼š1.4ã€€å°ç»“"></a>ç« èŠ‚ï¼š1.4ã€€å°ç»“</h2><blockquote><p>å­¦ä¹ thisçš„ç¬¬ä¸€æ­¥æ˜¯æ˜ç™½thisæ—¢ä¸æŒ‡å‘å‡½æ•°è‡ªèº«ä¹Ÿä¸æŒ‡å‘å‡½æ•°çš„è¯æ³•ä½œç”¨åŸŸï¼Œä½ ä¹Ÿè®¸è¢«è¿™æ ·çš„è§£é‡Šè¯¯å¯¼è¿‡ï¼Œä½†å…¶å®å®ƒä»¬éƒ½æ˜¯é”™è¯¯çš„</p></blockquote><blockquote><p>thiså®é™…ä¸Šæ˜¯åœ¨å‡½æ•°è¢«è°ƒç”¨æ—¶å‘ç”Ÿçš„ç»‘å®šï¼Œå®ƒæŒ‡å‘ä»€ä¹ˆå®Œå…¨å–å†³äºå‡½æ•°åœ¨å“ªé‡Œè¢«è°ƒç”¨ã€‚</p></blockquote><h2 id="ç« èŠ‚ï¼š2-1-è°ƒç”¨ä½ç½®"><a href="#ç« èŠ‚ï¼š2-1-è°ƒç”¨ä½ç½®" class="headerlink" title="ç« èŠ‚ï¼š2.1ã€€è°ƒç”¨ä½ç½®"></a>ç« èŠ‚ï¼š2.1ã€€è°ƒç”¨ä½ç½®</h2><blockquote><p>è°ƒç”¨ä½ç½®ï¼šè°ƒç”¨ä½ç½®å°±æ˜¯å‡½æ•°åœ¨ä»£ç ä¸­è¢«è°ƒç”¨çš„ä½ç½®ï¼ˆè€Œä¸æ˜¯å£°æ˜çš„ä½ç½®ï¼‰</p></blockquote><blockquote><p>å¯»æ‰¾è°ƒç”¨ä½ç½®å°±æ˜¯å¯»æ‰¾â€œå‡½æ•°è¢«è°ƒç”¨çš„ä½ç½®â€</p></blockquote><blockquote><p>æœ€é‡è¦çš„æ˜¯è¦åˆ†æè°ƒç”¨æ ˆï¼ˆå°±æ˜¯ä¸ºäº†åˆ°è¾¾å½“å‰æ‰§è¡Œä½ç½®æ‰€è°ƒç”¨çš„æ‰€æœ‰å‡½æ•°ï¼‰ã€‚æˆ‘ä»¬å…³å¿ƒçš„è°ƒç”¨ä½ç½®å°±åœ¨å½“å‰æ­£åœ¨æ‰§è¡Œçš„å‡½æ•°çš„å‰ä¸€ä¸ªè°ƒç”¨ä¸­</p></blockquote><blockquote><p>ç»å¤§å¤šæ•°ç°ä»£æ¡Œé¢æµè§ˆå™¨éƒ½å†…ç½®äº†å¼€å‘è€…å·¥å…·ï¼Œå…¶ä¸­åŒ…å«JavaScriptè°ƒè¯•å™¨ã€‚å°±æœ¬ä¾‹æ¥è¯´ï¼Œä½ å¯ä»¥åœ¨å·¥å…·ä¸­ç»™foo()å‡½æ•°çš„ç¬¬ä¸€è¡Œä»£ç è®¾ç½®ä¸€ä¸ªæ–­ç‚¹ï¼Œæˆ–è€…ç›´æ¥åœ¨ç¬¬ä¸€è¡Œä»£ç ä¹‹å‰æ’å…¥ä¸€æ¡debugger;è¯­å¥ã€‚è¿è¡Œä»£ç æ—¶ï¼Œè°ƒè¯•å™¨ä¼šåœ¨é‚£ä¸ªä½ç½®æš‚åœï¼ŒåŒæ—¶ä¼šå±•ç¤ºå½“å‰ä½ç½®çš„å‡½æ•°è°ƒç”¨åˆ—è¡¨ï¼Œè¿™å°±æ˜¯ä½ çš„è°ƒç”¨æ ˆã€‚å› æ­¤ï¼Œå¦‚æœä½ æƒ³è¦åˆ†æthisçš„ç»‘å®šï¼Œä½¿ç”¨å¼€å‘è€…å·¥å…·å¾—åˆ°è°ƒç”¨æ ˆï¼Œç„¶åæ‰¾åˆ°æ ˆä¸­ç¬¬äºŒä¸ªå…ƒç´ ï¼Œè¿™å°±æ˜¯çœŸæ­£çš„è°ƒç”¨ä½ç½®ã€‚</p></blockquote><h2 id="ç« èŠ‚ï¼š2-2-ç»‘å®šè§„åˆ™"><a href="#ç« èŠ‚ï¼š2-2-ç»‘å®šè§„åˆ™" class="headerlink" title="ç« èŠ‚ï¼š2.2ã€€ç»‘å®šè§„åˆ™"></a>ç« èŠ‚ï¼š2.2ã€€ç»‘å®šè§„åˆ™</h2><blockquote><p>æˆ‘ä»¬æ¥çœ‹çœ‹åœ¨å‡½æ•°çš„æ‰§è¡Œè¿‡ç¨‹ä¸­è°ƒç”¨ä½ç½®å¦‚ä½•å†³å®šthisçš„ç»‘å®šå¯¹è±¡ã€‚<br>ä½ å¿…é¡»æ‰¾åˆ°è°ƒç”¨ä½ç½®ï¼Œç„¶ååˆ¤æ–­éœ€è¦åº”ç”¨ä¸‹é¢å››æ¡è§„åˆ™ä¸­çš„å“ªä¸€æ¡</p></blockquote><p>é»˜è®¤ç»‘å®š éšå¼ç»‘å®š æ˜¾ç¤ºç»‘å®š newç»‘å®š</p><blockquote><p>2.2.1ã€€é»˜è®¤ç»‘å®š<br>é¦–å…ˆè¦ä»‹ç»çš„æ˜¯æœ€å¸¸ç”¨çš„å‡½æ•°è°ƒç”¨ç±»å‹ï¼šç‹¬ç«‹å‡½æ•°è°ƒç”¨ã€‚å¯ä»¥æŠŠè¿™æ¡è§„åˆ™çœ‹ä½œæ˜¯æ— æ³•åº”ç”¨å…¶ä»–è§„åˆ™æ—¶çš„é»˜è®¤è§„åˆ™ã€‚</p></blockquote><blockquote><p>foo()æ˜¯ç›´æ¥ä½¿ç”¨ä¸å¸¦ä»»ä½•ä¿®é¥°çš„å‡½æ•°å¼•ç”¨è¿›è¡Œè°ƒç”¨çš„ï¼Œå› æ­¤åªèƒ½ä½¿ç”¨é»˜è®¤ç»‘å®šï¼Œæ— æ³•åº”ç”¨å…¶ä»–è§„åˆ™ã€‚</p></blockquote><blockquote><p>2.2.2ã€€éšå¼ç»‘å®š<br>å¦ä¸€æ¡éœ€è¦è€ƒè™‘çš„è§„åˆ™æ˜¯è°ƒç”¨ä½ç½®æ˜¯å¦æœ‰ä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œæˆ–è€…è¯´æ˜¯å¦è¢«æŸä¸ªå¯¹è±¡æ‹¥æœ‰æˆ–è€…åŒ…å«ï¼Œ</p></blockquote><blockquote><p>å½“å‡½æ•°å¼•ç”¨æœ‰ä¸Šä¸‹æ–‡å¯¹è±¡æ—¶ï¼Œéšå¼ç»‘å®šè§„åˆ™ä¼šæŠŠå‡½æ•°è°ƒç”¨ä¸­çš„thisç»‘å®šåˆ°è¿™ä¸ªä¸Šä¸‹æ–‡å¯¹è±¡ã€‚</p></blockquote><blockquote><p>å¯¹è±¡å±æ€§å¼•ç”¨é“¾ä¸­åªæœ‰æœ€é¡¶å±‚æˆ–è€…è¯´æœ€åä¸€å±‚ä¼šå½±å“è°ƒç”¨ä½ç½®ã€‚</p></blockquote><blockquote><p>éšå¼ä¸¢å¤±<br>ä¸€ä¸ªæœ€å¸¸è§çš„thisç»‘å®šé—®é¢˜å°±æ˜¯è¢«éšå¼ç»‘å®šçš„å‡½æ•°ä¼šä¸¢å¤±ç»‘å®šå¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä¼šåº”ç”¨é»˜è®¤ç»‘å®š</p></blockquote><blockquote><p>è™½ç„¶baræ˜¯obj.fooçš„ä¸€ä¸ªå¼•ç”¨ï¼Œä½†æ˜¯å®é™…ä¸Šï¼Œå®ƒå¼•ç”¨çš„æ˜¯fooå‡½æ•°æœ¬èº«ï¼Œå› æ­¤æ­¤æ—¶çš„bar()å…¶å®æ˜¯ä¸€ä¸ªä¸å¸¦ä»»ä½•ä¿®é¥°çš„å‡½æ•°è°ƒç”¨ï¼Œå› æ­¤åº”ç”¨äº†é»˜è®¤ç»‘å®šã€‚</p></blockquote><blockquote><p>å‚æ•°ä¼ é€’å…¶å®å°±æ˜¯ä¸€ç§éšå¼èµ‹å€¼ï¼Œå› æ­¤æˆ‘ä»¬ä¼ å…¥å‡½æ•°æ—¶ä¹Ÿä¼šè¢«éšå¼èµ‹å€¼</p></blockquote><blockquote><p>2.2.3ã€€æ˜¾å¼ç»‘å®š</p></blockquote><blockquote><p>è¿™ä¸¤ä¸ªæ–¹æ³•æ˜¯å¦‚ä½•å·¥ä½œçš„å‘¢ï¼Ÿå®ƒä»¬çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒä»¬ä¼šæŠŠè¿™ä¸ªå¯¹è±¡ç»‘å®šåˆ°thisï¼Œæ¥ç€åœ¨è°ƒç”¨å‡½æ•°æ—¶æŒ‡å®šè¿™ä¸ªthisã€‚å› ä¸ºä½ å¯ä»¥ç›´æ¥æŒ‡å®šthisçš„ç»‘å®šå¯¹è±¡ï¼Œå› æ­¤æˆ‘ä»¬ç§°ä¹‹ä¸ºæ˜¾å¼ç»‘å®šã€‚</p></blockquote><p>call() / apply()</p><blockquote><p>å¦‚æœä½ ä¼ å…¥äº†ä¸€ä¸ªåŸå§‹å€¼ï¼ˆå­—ç¬¦ä¸²ç±»å‹ã€å¸ƒå°”ç±»å‹æˆ–è€…æ•°å­—ç±»å‹ï¼‰æ¥å½“ä½œthisçš„ç»‘å®šå¯¹è±¡ï¼Œè¿™ä¸ªåŸå§‹å€¼ä¼šè¢«è½¬æ¢æˆå®ƒçš„å¯¹è±¡å½¢å¼ï¼ˆä¹Ÿå°±æ˜¯new String(..)ã€new Boolean(..)æˆ–è€…new Number(..)ï¼‰ã€‚è¿™é€šå¸¸è¢«ç§°ä¸ºâ€œè£…ç®±â€ã€‚</p></blockquote><blockquote><ol><li>ç¡¬ç»‘å®š</li></ol></blockquote><blockquote><p>ç¡¬ç»‘å®šçš„å…¸å‹åº”ç”¨åœºæ™¯å°±æ˜¯åˆ›å»ºä¸€ä¸ªåŒ…è£¹å‡½æ•°ï¼Œä¼ å…¥æ‰€æœ‰çš„å‚æ•°å¹¶è¿”å›æ¥æ”¶åˆ°çš„æ‰€æœ‰å€¼ï¼š</p></blockquote><blockquote><p>ç”±äºç¡¬ç»‘å®šæ˜¯ä¸€ç§éå¸¸å¸¸ç”¨çš„æ¨¡å¼ï¼Œæ‰€ä»¥åœ¨ES5ä¸­æä¾›äº†å†…ç½®çš„æ–¹æ³•Function.prototype.bind</p></blockquote><blockquote><p>bind(..)ä¼šè¿”å›ä¸€ä¸ªç¡¬ç¼–ç çš„æ–°å‡½æ•°ï¼Œå®ƒä¼šæŠŠå‚æ•°è®¾ç½®ä¸ºthisçš„ä¸Šä¸‹æ–‡å¹¶è°ƒç”¨åŸå§‹å‡½æ•°ã€‚</p></blockquote><blockquote><ol start="2"><li>APIè°ƒç”¨çš„â€œä¸Šä¸‹æ–‡â€</li></ol></blockquote><blockquote><p>ç¬¬ä¸‰æ–¹åº“çš„è®¸å¤šå‡½æ•°ï¼Œä»¥åŠJavaScriptè¯­è¨€å’Œå®¿ä¸»ç¯å¢ƒä¸­è®¸å¤šæ–°çš„å†…ç½®å‡½æ•°ï¼Œéƒ½æä¾›äº†ä¸€ä¸ªå¯é€‰çš„å‚æ•°ï¼Œé€šå¸¸è¢«ç§°ä¸ºâ€œä¸Šä¸‹æ–‡â€ï¼ˆcontextï¼‰ï¼Œå…¶ä½œç”¨å’Œbind(..)ä¸€æ ·ï¼Œç¡®ä¿ä½ çš„å›è°ƒå‡½æ•°ä½¿ç”¨æŒ‡å®šçš„thisã€‚</p></blockquote><blockquote><p>2.2.4ã€€newç»‘å®š</p></blockquote><blockquote><p>åœ¨ä¼ ç»Ÿçš„é¢å‘ç±»çš„è¯­è¨€ä¸­ï¼Œâ€œæ„é€ å‡½æ•°â€æ˜¯ç±»ä¸­çš„ä¸€äº›ç‰¹æ®Šæ–¹æ³•ï¼Œä½¿ç”¨newåˆå§‹åŒ–ç±»æ—¶ä¼šè°ƒç”¨ç±»ä¸­çš„æ„é€ å‡½æ•°ã€‚</p></blockquote><p>æ³¨æ„ï¼šè¯´çš„æ˜¯åœ¨ä¼ ç»Ÿé¢å‘ç±»çš„è¯­è¨€ä¸­ï¼</p><blockquote><p>ç»å¤§å¤šæ•°å¼€å‘è€…éƒ½è®¤ä¸ºJavaScriptä¸­newçš„æœºåˆ¶ä¹Ÿå’Œé‚£äº›è¯­è¨€ä¸€æ ·ã€‚ç„¶è€Œï¼ŒJavaScriptä¸­newçš„æœºåˆ¶å®é™…ä¸Šå’Œé¢å‘ç±»çš„è¯­è¨€å®Œå…¨ä¸åŒã€‚</p></blockquote><blockquote><p>é¦–å…ˆæˆ‘ä»¬é‡æ–°å®šä¹‰ä¸€ä¸‹JavaScriptä¸­çš„â€œæ„é€ å‡½æ•°â€ã€‚JavaScriptï¼Œæ„é€ å‡½æ•°åªæ˜¯ä¸€äº›ä½¿ç”¨newæ“ä½œç¬¦æ—¶è¢«è°ƒç”¨çš„å‡½æ•°ã€‚å®ƒä»¬å¹¶ä¸ä¼šå±äºæŸä¸ªç±»ï¼Œä¹Ÿä¸ä¼šå®ä¾‹åŒ–ä¸€ä¸ªç±»ã€‚å®é™…ä¸Šï¼Œå®ƒä»¬ç”šè‡³éƒ½ä¸èƒ½è¯´æ˜¯ä¸€ç§ç‰¹æ®Šçš„å‡½æ•°ç±»å‹ï¼Œå®ƒä»¬åªæ˜¯è¢«newæ“ä½œç¬¦è°ƒç”¨çš„æ™®é€šå‡½æ•°è€Œå·²ã€‚</p></blockquote><blockquote><p>åŒ…æ‹¬å†…ç½®å¯¹è±¡å‡½æ•°ï¼ˆæ¯”å¦‚Number(..)ï¼Œè¯¦æƒ…è¯·æŸ¥çœ‹ç¬¬3ç« ï¼‰åœ¨å†…çš„æ‰€æœ‰å‡½æ•°éƒ½å¯ä»¥ç”¨newæ¥è°ƒç”¨ï¼Œè¿™ç§å‡½æ•°è°ƒç”¨è¢«ç§°ä¸ºæ„é€ å‡½æ•°è°ƒç”¨ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªé‡è¦ä½†æ˜¯éå¸¸ç»†å¾®çš„åŒºåˆ«ï¼šå®é™…ä¸Šå¹¶ä¸å­˜åœ¨æ‰€è°“çš„â€œæ„é€ å‡½æ•°â€ï¼Œåªæœ‰å¯¹äºå‡½æ•°çš„â€œæ„é€ è°ƒç”¨â€ã€‚</p></blockquote><blockquote><p>ä½¿ç”¨newæ¥è°ƒç”¨å‡½æ•°ï¼Œæˆ–è€…è¯´å‘ç”Ÿæ„é€ å‡½æ•°è°ƒç”¨æ—¶ï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œä¸‹é¢çš„æ“ä½œã€‚</p><ol><li>åˆ›å»ºï¼ˆæˆ–è€…è¯´æ„é€ ï¼‰ä¸€ä¸ªå…¨æ–°çš„å¯¹è±¡ã€‚</li><li>è¿™ä¸ªæ–°å¯¹è±¡ä¼šè¢«æ‰§è¡Œ[[åŸå‹]]è¿æ¥ã€‚</li><li>è¿™ä¸ªæ–°å¯¹è±¡ä¼šç»‘å®šåˆ°å‡½æ•°è°ƒç”¨çš„thisã€‚</li><li>å¦‚æœå‡½æ•°æ²¡æœ‰è¿”å›å…¶ä»–å¯¹è±¡ï¼Œé‚£ä¹ˆnewè¡¨è¾¾å¼ä¸­çš„å‡½æ•°è°ƒç”¨ä¼šè‡ªåŠ¨è¿”å›è¿™ä¸ªæ–°å¯¹è±¡ã€‚</li></ol><ul><li>js é«˜ç¨‹å†™çš„ï¼š</li></ul><ol><li>åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡</li><li>å°†æ„é€ å‡½æ•°çš„ä½œç”¨åŸŸèµ‹ç»™æ–°å¯¹è±¡ï¼ˆå› æ­¤thiså°±æŒ‡å‘äº†è¿™ä¸ªæ–°å¯¹è±¡ï¼‰</li><li>æ‰§è¡Œæ„é€ å‡½æ•°ä¸­çš„ä»£ç ï¼ˆä¸ºè¿™ä¸ªæ–°å¯¹è±¡æ·»åŠ å±æ€§ï¼‰</li><li>è¿”å›è¿™ä¸ªæ–°å¯¹è±¡</li></ol></blockquote><h2 id="ç« èŠ‚ï¼š2-3-ä¼˜å…ˆçº§"><a href="#ç« èŠ‚ï¼š2-3-ä¼˜å…ˆçº§" class="headerlink" title="ç« èŠ‚ï¼š2.3ã€€ä¼˜å…ˆçº§"></a>ç« èŠ‚ï¼š2.3ã€€ä¼˜å…ˆçº§</h2><blockquote><p>é»˜è®¤ç»‘å®šçš„ä¼˜å…ˆçº§æ˜¯å››æ¡è§„åˆ™ä¸­æœ€ä½çš„</p></blockquote><blockquote><p>æ˜¾å¼ç»‘å®šä¼˜å…ˆçº§æ›´é«˜ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨åˆ¤æ–­æ—¶åº”å½“å…ˆè€ƒè™‘æ˜¯å¦å¯ä»¥åº”ç”¨æ˜¾å¼ç»‘å®šã€‚</p></blockquote><blockquote><p>newç»‘å®šæ¯”éšå¼ç»‘å®šä¼˜å…ˆçº§é«˜</p></blockquote><blockquote><p>MDNæä¾›çš„ä¸€ç§bind(..)å®ç°</p></blockquote><p>bindå®ç°</p><blockquote><p>å¯ä»¥æŒ‰ç…§ä¸‹é¢çš„é¡ºåºæ¥è¿›è¡Œåˆ¤æ–­ï¼š</p><ol><li>å‡½æ•°æ˜¯å¦åœ¨newä¸­è°ƒç”¨ï¼ˆnewç»‘å®šï¼‰ï¼Ÿå¦‚æœæ˜¯çš„è¯thisç»‘å®šçš„æ˜¯æ–°åˆ›å»ºçš„å¯¹è±¡ã€‚<br>var bar = new foo()</li><li>å‡½æ•°æ˜¯å¦é€šè¿‡callã€applyï¼ˆæ˜¾å¼ç»‘å®šï¼‰æˆ–è€…ç¡¬ç»‘å®šè°ƒç”¨ï¼Ÿå¦‚æœæ˜¯çš„è¯ï¼Œthisç»‘å®šçš„æ˜¯æŒ‡å®šçš„å¯¹è±¡ã€‚<br>var bar = foo.call(obj2)</li><li>å‡½æ•°æ˜¯å¦åœ¨æŸä¸ªä¸Šä¸‹æ–‡å¯¹è±¡ä¸­è°ƒç”¨ï¼ˆéšå¼ç»‘å®šï¼‰ï¼Ÿå¦‚æœæ˜¯çš„è¯ï¼Œthisç»‘å®šçš„æ˜¯é‚£ä¸ªä¸Šä¸‹æ–‡å¯¹è±¡ã€‚<br>var bar = obj1.foo()</li><li>å¦‚æœéƒ½ä¸æ˜¯çš„è¯ï¼Œä½¿ç”¨é»˜è®¤ç»‘å®šã€‚å¦‚æœåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ï¼Œå°±ç»‘å®šåˆ°undefinedï¼Œå¦åˆ™ç»‘å®šåˆ°å…¨å±€å¯¹è±¡ã€‚<br>var bar = foo()<br>å°±æ˜¯è¿™æ ·ã€‚</li></ol></blockquote><h2 id="ç« èŠ‚ï¼š3-1-è¯­æ³•"><a href="#ç« èŠ‚ï¼š3-1-è¯­æ³•" class="headerlink" title="ç« èŠ‚ï¼š3.1ã€€è¯­æ³•"></a>ç« èŠ‚ï¼š3.1ã€€è¯­æ³•</h2><blockquote><p>å¯¹è±¡å¯ä»¥é€šè¿‡ä¸¤ç§å½¢å¼å®šä¹‰ï¼šå£°æ˜ï¼ˆæ–‡å­—ï¼‰å½¢å¼å’Œæ„é€ å½¢å¼ã€‚</p></blockquote><h2 id="ç« èŠ‚ï¼š3-2-ç±»å‹"><a href="#ç« èŠ‚ï¼š3-2-ç±»å‹" class="headerlink" title="ç« èŠ‚ï¼š3.2ã€€ç±»å‹"></a>ç« èŠ‚ï¼š3.2ã€€ç±»å‹</h2><blockquote><p>å¯¹è±¡æ˜¯JavaScriptçš„åŸºç¡€ã€‚åœ¨JavaScriptä¸­ä¸€å…±æœ‰å…­ç§ä¸»è¦ç±»å‹ï¼ˆæœ¯è¯­æ˜¯â€œè¯­è¨€ç±»å‹â€ï¼‰ï¼š<br>â€¢ string<br>â€¢ number<br>â€¢ boolean<br>â€¢ null<br>â€¢ undefined<br>â€¢ object</p></blockquote><blockquote><p>æ³¨æ„ï¼Œç®€å•åŸºæœ¬ç±»å‹ï¼ˆstringã€booleanã€numberã€nullå’Œundefinedï¼‰æœ¬èº«å¹¶ä¸æ˜¯å¯¹è±¡</p></blockquote><blockquote><p>æœ‰ä¸€ç§å¸¸è§çš„é”™è¯¯è¯´æ³•æ˜¯â€œJavaScriptä¸­ä¸‡ç‰©çš†æ˜¯å¯¹è±¡â€ï¼Œè¿™æ˜¾ç„¶æ˜¯é”™è¯¯çš„ã€‚</p></blockquote><blockquote><p>æ„é€ å‡½æ•°ï¼ˆç”±newäº§ç”Ÿçš„å‡½æ•°è°ƒç”¨</p></blockquote><blockquote><p>æˆ‘ä»¬éƒ½å¯ä»¥ç›´æ¥åœ¨å­—ç¬¦ä¸²å­—é¢é‡ä¸Šè®¿é—®å±æ€§æˆ–è€…æ–¹æ³•ï¼Œä¹‹æ‰€ä»¥å¯ä»¥è¿™æ ·åšï¼Œæ˜¯å› ä¸ºå¼•æ“è‡ªåŠ¨æŠŠå­—é¢é‡è½¬æ¢æˆStringå¯¹è±¡ï¼Œæ‰€ä»¥å¯ä»¥è®¿é—®å±æ€§å’Œæ–¹æ³•ã€‚</p></blockquote><blockquote><p>nullå’Œundefinedæ²¡æœ‰å¯¹åº”çš„æ„é€ å½¢å¼ï¼Œå®ƒä»¬åªæœ‰æ–‡å­—å½¢å¼ã€‚ç›¸åï¼ŒDateåªæœ‰æ„é€ ï¼Œæ²¡æœ‰æ–‡å­—å½¢å¼ã€‚</p></blockquote><blockquote><p>å¯¹äºObjectã€Arrayã€Functionå’ŒRegExpï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼‰æ¥è¯´ï¼Œæ— è®ºä½¿ç”¨æ–‡å­—å½¢å¼è¿˜æ˜¯æ„é€ å½¢å¼ï¼Œå®ƒä»¬éƒ½æ˜¯å¯¹è±¡ï¼Œä¸æ˜¯å­—é¢é‡ã€‚</p></blockquote><h2 id="ç« èŠ‚ï¼š3-3-å†…å®¹"><a href="#ç« èŠ‚ï¼š3-3-å†…å®¹" class="headerlink" title="ç« èŠ‚ï¼š3.3ã€€å†…å®¹"></a>ç« èŠ‚ï¼š3.3ã€€å†…å®¹</h2><blockquote><p>ES6å¢åŠ äº†å¯è®¡ç®—å±æ€§åï¼Œå¯ä»¥åœ¨æ–‡å­—å½¢å¼ä¸­ä½¿ç”¨[]åŒ…è£¹ä¸€ä¸ªè¡¨è¾¾å¼æ¥å½“ä½œå±æ€§å</p></blockquote><blockquote><p>ES6å®šä¹‰äº†Object.assign(..)æ–¹æ³•æ¥å®ç°æµ…å¤åˆ¶ã€‚Object.assign(..)æ–¹æ³•çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ç›®æ ‡å¯¹è±¡ï¼Œä¹‹åè¿˜å¯ä»¥è·Ÿä¸€ä¸ªæˆ–å¤šä¸ªæºå¯¹è±¡ã€‚å®ƒä¼šéå†ä¸€ä¸ªæˆ–å¤šä¸ªæºå¯¹è±¡çš„æ‰€æœ‰å¯æšä¸¾ï¼ˆenumerableï¼Œå‚è§ä¸‹é¢çš„ä»£ç ï¼‰çš„è‡ªæœ‰é”®ï¼ˆowned keyï¼Œå¾ˆå¿«ä¼šä»‹ç»ï¼‰å¹¶æŠŠå®ƒä»¬å¤åˆ¶ï¼ˆä½¿ç”¨=æ“ä½œç¬¦èµ‹å€¼ï¼‰åˆ°ç›®æ ‡å¯¹è±¡ï¼Œæœ€åè¿”å›ç›®æ ‡å¯¹è±¡</p></blockquote><blockquote><p>å®ƒè¿˜åŒ…å«å¦å¤–ä¸‰ä¸ªç‰¹æ€§ï¼šwritableï¼ˆå¯å†™ï¼‰ã€enumerableï¼ˆå¯æšä¸¾ï¼‰å’Œconfigurableï¼ˆå¯é…ç½®ï¼‰ã€‚</p></blockquote><blockquote><p>åœ¨åˆ›å»ºæ™®é€šå±æ€§æ—¶å±æ€§æè¿°ç¬¦ä¼šä½¿ç”¨é»˜è®¤å€¼ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨Object.defineProperty(..)æ¥æ·»åŠ ä¸€ä¸ªæ–°å±æ€§æˆ–è€…ä¿®æ”¹ä¸€ä¸ªå·²æœ‰å±æ€§ï¼ˆå¦‚æœå®ƒæ˜¯configurableï¼‰å¹¶å¯¹ç‰¹æ€§è¿›è¡Œè®¾ç½®ã€‚</p></blockquote><blockquote><ol><li>Writable<br>writableå†³å®šæ˜¯å¦å¯ä»¥ä¿®æ”¹å±æ€§çš„å€¼ã€‚</li></ol></blockquote><blockquote><ol start="2"><li>Configurable<br>åªè¦å±æ€§æ˜¯å¯é…ç½®çš„ï¼Œå°±å¯ä»¥ä½¿ç”¨defineProperty(..)æ–¹æ³•æ¥ä¿®æ”¹å±æ€§</li></ol></blockquote><blockquote><ol start="3"><li>Enumerable</li></ol></blockquote><blockquote><p>myObject.aåœ¨myObjectä¸Šå®é™…ä¸Šæ˜¯å®ç°äº†[[Get]]æ“ä½œï¼ˆæœ‰ç‚¹åƒå‡½æ•°è°ƒç”¨ï¼š<a href="">[Get]</a>ï¼‰</p></blockquote><h2 id="ç« èŠ‚ï¼š4-1-ç±»ç†è®º"><a href="#ç« èŠ‚ï¼š4-1-ç±»ç†è®º" class="headerlink" title="ç« èŠ‚ï¼š4.1ã€€ç±»ç†è®º"></a>ç« èŠ‚ï¼š4.1ã€€ç±»ç†è®º</h2><blockquote><p>å…¶ä»–è¯­è¨€ä¸­çš„ç±»å’ŒJavaScriptä¸­çš„â€œç±»â€å¹¶ä¸ä¸€æ ·</p></blockquote><h2 id="ç« èŠ‚ï¼š4-2-ç±»çš„æœºåˆ¶"><a href="#ç« èŠ‚ï¼š4-2-ç±»çš„æœºåˆ¶" class="headerlink" title="ç« èŠ‚ï¼š4.2ã€€ç±»çš„æœºåˆ¶"></a>ç« èŠ‚ï¼š4.2ã€€ç±»çš„æœºåˆ¶</h2><blockquote><p>ç±»å®ä¾‹æ˜¯ç”±ä¸€ä¸ªç‰¹æ®Šçš„ç±»æ–¹æ³•æ„é€ çš„ï¼Œè¿™ä¸ªæ–¹æ³•åé€šå¸¸å’Œç±»åç›¸åŒï¼Œè¢«ç§°ä¸ºæ„é€ å‡½æ•°ã€‚</p></blockquote><h2 id="ç« èŠ‚ï¼š4-3-ç±»çš„ç»§æ‰¿"><a href="#ç« èŠ‚ï¼š4-3-ç±»çš„ç»§æ‰¿" class="headerlink" title="ç« èŠ‚ï¼š4.3 ç±»çš„ç»§æ‰¿"></a>ç« èŠ‚ï¼š4.3 ç±»çš„ç»§æ‰¿</h2><blockquote><p>è¿™ä¸ªæŠ€æœ¯è¢«ç§°ä¸ºå¤šæ€æˆ–è€…è™šæ‹Ÿå¤šæ€ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œæ›´æ°å½“çš„è¯´æ³•æ˜¯ç›¸å¯¹å¤šæ€ã€‚</p></blockquote><h2 id="ç« èŠ‚ï¼š5-1-Prototype"><a href="#ç« èŠ‚ï¼š5-1-Prototype" class="headerlink" title="ç« èŠ‚ï¼š5.1ã€€ [[Prototype]]"></a>ç« èŠ‚ï¼š5.1ã€€ [[Prototype]]</h2><blockquote><p>JavaScriptä¸­çš„å¯¹è±¡æœ‰ä¸€ä¸ªç‰¹æ®Šçš„[[Prototype]]å†…ç½®å±æ€§ï¼Œå…¶å®å°±æ˜¯å¯¹äºå…¶ä»–å¯¹è±¡çš„å¼•ç”¨ã€‚</p></blockquote><blockquote><p>Object.create(..)çš„åŸç†ï¼Œç°åœ¨åªéœ€è¦çŸ¥é“å®ƒä¼šåˆ›å»ºä¸€ä¸ªå¯¹è±¡å¹¶æŠŠè¿™ä¸ªå¯¹è±¡çš„[[Prototype]]å…³è”åˆ°æŒ‡å®šçš„å¯¹è±¡ã€‚</p></blockquote><blockquote><p>ä½¿ç”¨for..inéå†å¯¹è±¡æ—¶åŸç†å’ŒæŸ¥æ‰¾[[Prototype]]é“¾ç±»ä¼¼ï¼Œä»»ä½•å¯ä»¥é€šè¿‡åŸå‹é“¾è®¿é—®åˆ°ï¼ˆå¹¶ä¸”æ˜¯enumerableï¼Œå‚è§ç¬¬3ç« ï¼‰çš„å±æ€§éƒ½ä¼šè¢«æšä¸¾ã€‚ä½¿ç”¨inæ“ä½œç¬¦æ¥æ£€æŸ¥å±æ€§åœ¨å¯¹è±¡ä¸­æ˜¯å¦å­˜åœ¨æ—¶ï¼ŒåŒæ ·ä¼šæŸ¥æ‰¾å¯¹è±¡çš„æ•´æ¡åŸå‹é“¾ï¼ˆæ— è®ºå±æ€§æ˜¯å¦å¯æšä¸¾ï¼‰</p></blockquote><blockquote><p>æ‰€æœ‰æ™®é€šçš„[[Prototype]]é“¾æœ€ç»ˆéƒ½ä¼šæŒ‡å‘å†…ç½®çš„Object.prototypeã€‚</p></blockquote><blockquote><p>ä½ å¸Œæœ›åœ¨ç¬¬äºŒç§å’Œç¬¬ä¸‰ç§æƒ…å†µä¸‹ä¹Ÿå±è”½fooï¼Œé‚£å°±ä¸èƒ½ä½¿ç”¨=æ“ä½œç¬¦æ¥èµ‹å€¼ï¼Œè€Œæ˜¯ä½¿ç”¨Object.defineProperty(..)ï¼ˆå‚è§ç¬¬3ç« ï¼‰æ¥å‘myObjectæ·»åŠ fooã€‚</p></blockquote><h2 id="ç« èŠ‚ï¼š5-2-â€œç±»â€"><a href="#ç« èŠ‚ï¼š5-2-â€œç±»â€" class="headerlink" title="ç« èŠ‚ï¼š5.2ã€€â€œç±»â€"></a>ç« èŠ‚ï¼š5.2ã€€â€œç±»â€</h2><blockquote><p>å› ä¸ºæ ¹æœ¬å°±ä¸å­˜åœ¨ç±»</p></blockquote><blockquote><p>å†è¯´ä¸€éï¼ŒJavaScriptä¸­åªæœ‰å¯¹è±¡</p></blockquote><blockquote><p>æ‰€æœ‰çš„å‡½æ•°é»˜è®¤éƒ½ä¼šæ‹¥æœ‰ä¸€ä¸ªåä¸ºprototypeçš„å…¬æœ‰å¹¶ä¸”ä¸å¯æšä¸¾ï¼ˆå‚è§ç¬¬3ç« ï¼‰çš„å±æ€§ï¼Œå®ƒä¼šæŒ‡å‘å¦ä¸€ä¸ªå¯¹è±¡ï¼š<br>function Foo() {<br>    // â€¦<br>}</p><p>Foo.prototype; // { }<br>è¿™ä¸ªå¯¹è±¡é€šå¸¸è¢«ç§°ä¸ºFooçš„åŸå‹ï¼Œå› ä¸ºæˆ‘ä»¬é€šè¿‡åä¸ºFoo.prototypeçš„å±æ€§å¼•ç”¨æ¥è®¿é—®å®ƒã€‚</p></blockquote><blockquote><p>è¿™ä¸ªå¯¹è±¡æ˜¯åœ¨è°ƒç”¨new Foo()ï¼ˆå‚è§ç¬¬2ç« ï¼‰æ—¶åˆ›å»ºçš„ï¼Œæœ€åä¼šè¢«ï¼ˆæœ‰ç‚¹æ­¦æ–­åœ°ï¼‰å…³è”åˆ°è¿™ä¸ªâ€œFooç‚¹prototypeâ€å¯¹è±¡ä¸Š</p></blockquote><blockquote><p>è°ƒç”¨new Foo()æ—¶ä¼šåˆ›å»ºaï¼ˆå…·ä½“çš„4ä¸ªæ­¥éª¤å‚è§ç¬¬2ç« ï¼‰ï¼Œå…¶ä¸­çš„ä¸€æ­¥å°±æ˜¯ç»™aä¸€ä¸ªå†…éƒ¨çš„[[Prototype]]é“¾æ¥ï¼Œå…³è”åˆ°Foo.prototypeæŒ‡å‘çš„é‚£ä¸ªå¯¹è±¡ã€‚</p></blockquote><blockquote><p>ä½ ä¸èƒ½åˆ›å»ºä¸€ä¸ªç±»çš„å¤šä¸ªå®ä¾‹ï¼Œåªèƒ½åˆ›å»ºå¤šä¸ªå¯¹è±¡ï¼Œå®ƒä»¬[[Prototype]]å…³è”çš„æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚</p></blockquote><blockquote><p>new Foo()è¿™ä¸ªå‡½æ•°è°ƒç”¨å®é™…ä¸Šå¹¶æ²¡æœ‰ç›´æ¥åˆ›å»ºå…³è”ï¼Œè¿™ä¸ªå…³è”åªæ˜¯ä¸€ä¸ªæ„å¤–çš„å‰¯ä½œç”¨ã€‚new Foo()åªæ˜¯é—´æ¥å®Œæˆäº†æˆ‘ä»¬çš„ç›®æ ‡ï¼šä¸€ä¸ªå…³è”åˆ°å…¶ä»–å¯¹è±¡çš„æ–°å¯¹è±¡ã€‚</p></blockquote><blockquote><p>Foo.prototypeé»˜è®¤ï¼ˆåœ¨ä»£ç ä¸­ç¬¬ä¸€è¡Œå£°æ˜æ—¶ï¼ï¼‰æœ‰ä¸€ä¸ªå…¬æœ‰å¹¶ä¸”ä¸å¯æšä¸¾ï¼ˆå‚è§ç¬¬3ç« ï¼‰çš„å±æ€§.constructorï¼Œè¿™ä¸ªå±æ€§å¼•ç”¨çš„æ˜¯å¯¹è±¡å…³è”çš„å‡½æ•°ï¼ˆæœ¬ä¾‹ä¸­æ˜¯Fooï¼‰</p></blockquote><blockquote><p>è¿™å¾ˆä»¤äººåƒæƒŠï¼Œæˆ‘ä»¬ç«Ÿç„¶ä¼šå¦‚æ­¤åŠªåŠ›åœ°ç»´æŠ¤JavaScriptä¸­ï¼ˆå‡ï¼‰â€œé¢å‘ç±»â€çš„æƒåŠ›ï¼Œå°½ç®¡å¯¹äºJavaScriptå¼•æ“æ¥è¯´é¦–å­—æ¯å¤§å†™æ²¡æœ‰ä»»ä½•æ„ä¹‰ã€‚</p></blockquote><blockquote><p>å®é™…ä¸Šï¼ŒFooå’Œä½ ç¨‹åºä¸­çš„å…¶ä»–å‡½æ•°æ²¡æœ‰ä»»ä½•åŒºåˆ«ã€‚å‡½æ•°æœ¬èº«å¹¶ä¸æ˜¯æ„é€ å‡½æ•°ï¼Œç„¶è€Œï¼Œå½“ä½ åœ¨æ™®é€šçš„å‡½æ•°è°ƒç”¨å‰é¢åŠ ä¸Šnewå…³é”®å­—ä¹‹åï¼Œå°±ä¼šæŠŠè¿™ä¸ªå‡½æ•°è°ƒç”¨å˜æˆä¸€ä¸ªâ€œæ„é€ å‡½æ•°è°ƒç”¨â€ã€‚å®é™…ä¸Šï¼Œnewä¼šåŠ«æŒæ‰€æœ‰æ™®é€šå‡½æ•°å¹¶ç”¨æ„é€ å¯¹è±¡çš„å½¢å¼æ¥è°ƒç”¨å®ƒã€‚</p></blockquote><blockquote><p>ï¼Œåœ¨JavaScriptä¸­å¯¹äºâ€œæ„é€ å‡½æ•°â€æœ€å‡†ç¡®çš„è§£é‡Šæ˜¯ï¼Œæ‰€æœ‰å¸¦newçš„å‡½æ•°è°ƒç”¨ã€‚</p></blockquote><blockquote><p>å‡½æ•°ä¸æ˜¯æ„é€ å‡½æ•°ï¼Œä½†æ˜¯å½“ä¸”ä»…å½“ä½¿ç”¨newæ—¶ï¼Œå‡½æ•°è°ƒç”¨ä¼šå˜æˆâ€œæ„é€ å‡½æ•°è°ƒç”¨â€</p></blockquote><blockquote><p>ä¹‹å‰è®¨è®º.constructorå±æ€§æ—¶æˆ‘ä»¬è¯´è¿‡ï¼Œçœ‹èµ·æ¥a.constructor === Fooä¸ºçœŸæ„å‘³ç€aç¡®å®æœ‰ä¸€ä¸ªæŒ‡å‘Fooçš„.constructorå±æ€§ï¼Œä½†æ˜¯äº‹å®ä¸æ˜¯è¿™æ ·ã€‚<br>è¿™æ˜¯ä¸€ä¸ªå¾ˆä¸å¹¸çš„è¯¯è§£ã€‚å®é™…ä¸Šï¼Œ.constructorå¼•ç”¨åŒæ ·è¢«å§”æ‰˜ç»™äº†Foo.prototypeï¼Œè€ŒFoo.prototype.constructoré»˜è®¤æŒ‡å‘Fooã€‚<br>æŠŠ.constructorå±æ€§æŒ‡å‘Fooçœ‹ä½œæ˜¯aå¯¹è±¡ç”±Fooâ€œæ„é€ â€éå¸¸å®¹æ˜“ç†è§£ï¼Œä½†è¿™åªä¸è¿‡æ˜¯ä¸€ç§è™šå‡çš„å®‰å…¨æ„Ÿã€‚a.constructoråªæ˜¯é€šè¿‡é»˜è®¤çš„[[Prototype]]å§”æ‰˜æŒ‡å‘Fooï¼Œè¿™å’Œâ€œæ„é€ â€æ¯«æ— å…³ç³»ã€‚ç›¸åï¼Œå¯¹äº.constructorçš„é”™è¯¯ç†è§£å¾ˆå®¹æ˜“å¯¹ä½ è‡ªå·±äº§ç”Ÿè¯¯å¯¼ã€‚<br>ä¸¾ä¾‹æ¥è¯´ï¼ŒFoo.prototypeçš„.constructorå±æ€§åªæ˜¯Fooå‡½æ•°åœ¨å£°æ˜æ—¶çš„é»˜è®¤å±æ€§ã€‚å¦‚æœä½ åˆ›å»ºäº†ä¸€ä¸ªæ–°å¯¹è±¡å¹¶æ›¿æ¢äº†å‡½æ•°é»˜è®¤çš„.prototypeå¯¹è±¡ [â€¦]</p></blockquote><blockquote><p>.constructorå¹¶ä¸æ˜¯ä¸€ä¸ªä¸å¯å˜å±æ€§ã€‚å®ƒæ˜¯ä¸å¯æšä¸¾ï¼ˆå‚è§ä¸Šé¢çš„ä»£ç ï¼‰çš„ï¼Œä½†æ˜¯å®ƒçš„å€¼æ˜¯å¯å†™çš„ï¼ˆå¯ä»¥è¢«ä¿®æ”¹ï¼‰ã€‚</p></blockquote><blockquote><p>a1.constructoræ˜¯ä¸€ä¸ªéå¸¸ä¸å¯é å¹¶ä¸”ä¸å®‰å…¨çš„å¼•ç”¨ã€‚é€šå¸¸æ¥è¯´è¦å°½é‡é¿å…ä½¿ç”¨è¿™äº›å¼•ç”¨ã€‚</p></blockquote><h2 id="ç« èŠ‚ï¼š5-3-ï¼ˆåŸå‹ï¼‰ç»§æ‰¿"><a href="#ç« èŠ‚ï¼š5-3-ï¼ˆåŸå‹ï¼‰ç»§æ‰¿" class="headerlink" title="ç« èŠ‚ï¼š5.3ã€€ï¼ˆåŸå‹ï¼‰ç»§æ‰¿"></a>ç« èŠ‚ï¼š5.3ã€€ï¼ˆåŸå‹ï¼‰ç»§æ‰¿</h2><blockquote><p>å¦‚æœå¿½ç•¥æ‰Object.create(..)æ–¹æ³•å¸¦æ¥çš„è½»å¾®æ€§èƒ½æŸå¤±ï¼ˆæŠ›å¼ƒçš„å¯¹è±¡éœ€è¦è¿›è¡Œåƒåœ¾å›æ”¶ï¼‰ï¼Œå®ƒå®é™…ä¸Šæ¯”ES6åŠå…¶ä¹‹åçš„æ–¹æ³•æ›´çŸ­è€Œä¸”å¯è¯»æ€§æ›´é«˜ã€‚ä¸è¿‡æ— è®ºå¦‚ä½•ï¼Œè¿™æ˜¯ä¸¤ç§å®Œå…¨ä¸åŒçš„è¯­æ³•ã€‚</p></blockquote><blockquote><p>å‡è®¾æœ‰å¯¹è±¡aï¼Œå¦‚ä½•å¯»æ‰¾å¯¹è±¡aå§”æ‰˜çš„å¯¹è±¡ï¼ˆå¦‚æœå­˜åœ¨çš„è¯ï¼‰å‘¢ï¼Ÿåœ¨ä¼ ç»Ÿçš„é¢å‘ç±»ç¯å¢ƒä¸­ï¼Œæ£€æŸ¥ä¸€ä¸ªå®ä¾‹ï¼ˆJavaScriptä¸­çš„å¯¹è±¡ï¼‰çš„ç»§æ‰¿ç¥–å…ˆï¼ˆJavaScriptä¸­çš„å§”æ‰˜å…³è”ï¼‰é€šå¸¸è¢«ç§°ä¸ºå†…çœï¼ˆæˆ–è€…åå°„ï¼‰</p></blockquote><blockquote><p>instanceofæ“ä½œç¬¦çš„å·¦æ“ä½œæ•°æ˜¯ä¸€ä¸ªæ™®é€šçš„å¯¹è±¡ï¼Œå³æ“ä½œæ•°æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚instanceofå›ç­”çš„é—®é¢˜æ˜¯ï¼šåœ¨açš„æ•´æ¡[[Prototype]]é“¾ä¸­æ˜¯å¦æœ‰æŒ‡å‘Foo.prototypeçš„å¯¹è±¡ï¼Ÿ</p></blockquote><blockquote><p>instanceofæ“ä½œç¬¦çš„å·¦æ“ä½œæ•°æ˜¯ä¸€ä¸ªæ™®é€šçš„å¯¹è±¡ï¼Œå³æ“ä½œæ•°æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚instanceofå›ç­”çš„é—®é¢˜æ˜¯ï¼šåœ¨açš„æ•´æ¡[[Prototype]]é“¾ä¸­æ˜¯å¦æœ‰æŒ‡å‘Foo.prototypeçš„å¯¹è±¡ï¼Ÿ</p></blockquote><p>instanceof</p><blockquote><p>å¯æƒœï¼Œè¿™ä¸ªæ–¹æ³•åªèƒ½å¤„ç†å¯¹è±¡ï¼ˆaï¼‰å’Œå‡½æ•°ï¼ˆå¸¦.prototypeå¼•ç”¨çš„Fooï¼‰ä¹‹é—´çš„å…³ç³»ã€‚å¦‚æœä½ æƒ³åˆ¤æ–­ä¸¤ä¸ªå¯¹è±¡ï¼ˆæ¯”å¦‚aå’Œbï¼‰ä¹‹é—´æ˜¯å¦é€šè¿‡[[Prototype]]é“¾å…³è”ï¼Œåªç”¨instanceofæ— æ³•å®ç°ã€‚</p></blockquote><blockquote><p>å¦‚æœä½¿ç”¨å†…ç½®çš„.bind(..)å‡½æ•°æ¥ç”Ÿæˆä¸€ä¸ªç¡¬ç»‘å®šå‡½æ•°ï¼ˆå‚è§ç¬¬2ç« ï¼‰çš„è¯ï¼Œè¯¥å‡½æ•°æ˜¯æ²¡æœ‰.prototypeå±æ€§çš„ã€‚åœ¨è¿™æ ·çš„å‡½æ•°ä¸Šä½¿ç”¨instanceofçš„è¯ï¼Œç›®æ ‡å‡½æ•°çš„.prototypeä¼šä»£æ›¿ç¡¬ç»‘å®šå‡½æ•°çš„.prototypeã€‚</p></blockquote><blockquote><p>é€šå¸¸æˆ‘ä»¬ä¸ä¼šåœ¨â€œæ„é€ å‡½æ•°è°ƒç”¨â€ä¸­ä½¿ç”¨ç¡¬ç»‘å®šå‡½æ•°ï¼Œä¸è¿‡å¦‚æœä½ è¿™ä¹ˆåšçš„è¯ï¼Œå®é™…ä¸Šç›¸å½“äºç›´æ¥è°ƒç”¨ç›®æ ‡å‡½æ•°ã€‚åŒç†ï¼Œåœ¨ç¡¬ç»‘å®šå‡½æ•°ä¸Šä½¿ç”¨instanceofä¹Ÿç›¸å½“äºç›´æ¥åœ¨ç›®æ ‡å‡½æ•°ä¸Šä½¿ç”¨instanceofã€‚</p></blockquote><blockquote><p>ä¸‹é¢æ˜¯ç¬¬äºŒç§åˆ¤æ–­[[Prototype]]åå°„çš„æ–¹æ³•ï¼Œå®ƒæ›´åŠ ç®€æ´ï¼š<br>Foo.prototype.isPrototypeOf( a ); // true<br>æ³¨æ„ï¼Œåœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬å®é™…ä¸Šå¹¶ä¸å…³å¿ƒï¼ˆç”šè‡³ä¸éœ€è¦ï¼‰Fooï¼Œæˆ‘ä»¬åªéœ€è¦ä¸€ä¸ªå¯ä»¥ç”¨æ¥åˆ¤æ–­çš„å¯¹è±¡ï¼ˆæœ¬ä¾‹ä¸­æ˜¯Foo.prototypeï¼‰å°±è¡Œã€‚isPrototypeOf(..)å›ç­”çš„é—®é¢˜æ˜¯ï¼šåœ¨açš„æ•´æ¡[[Prototype]]é“¾ä¸­æ˜¯å¦å‡ºç°è¿‡Foo.prototypeï¼Ÿ</p></blockquote><blockquote><p>æˆ‘ä»¬åªéœ€è¦ä¸¤ä¸ªå¯¹è±¡å°±å¯ä»¥åˆ¤æ–­å®ƒä»¬ä¹‹é—´çš„å…³ç³»ã€‚ä¸¾ä¾‹æ¥è¯´ï¼š<br>// éå¸¸ç®€å•ï¼šbæ˜¯å¦å‡ºç°åœ¨cçš„[[Prototype]]é“¾ä¸­ï¼Ÿ<br>b.isPrototypeOf( c );<br>æ³¨æ„ï¼Œè¿™ä¸ªæ–¹æ³•å¹¶ä¸éœ€è¦ä½¿ç”¨å‡½æ•°ï¼ˆâ€œç±»â€ï¼‰ï¼Œå®ƒç›´æ¥ä½¿ç”¨bå’Œcä¹‹é—´çš„å¯¹è±¡å¼•ç”¨æ¥åˆ¤æ–­å®ƒä»¬çš„å…³ç³»ã€‚æ¢å¥è¯è¯´ï¼Œè¯­è¨€å†…ç½®çš„isPrototypeOf(..)å‡½æ•°å°±æ˜¯æˆ‘ä»¬çš„isRelatedTo(..)å‡½æ•°ã€‚</p></blockquote><blockquote><p>è¿™ä¸ªå¥‡æ€ªçš„.<strong>proto</strong>ï¼ˆåœ¨ES6ä¹‹å‰å¹¶ä¸æ˜¯æ ‡å‡†ï¼ï¼‰å±æ€§â€œç¥å¥‡åœ°â€å¼•ç”¨äº†å†…éƒ¨çš„[[Prototype]]å¯¹è±¡ï¼Œå¦‚æœä½ æƒ³ç›´æ¥æŸ¥æ‰¾ï¼ˆç”šè‡³å¯ä»¥é€šè¿‡.<strong>proto</strong>.<strong>ptoto</strong>â€¦æ¥éå†ï¼‰åŸå‹é“¾çš„è¯ï¼Œè¿™ä¸ªæ–¹æ³•éå¸¸æœ‰ç”¨ã€‚<br>å’Œæˆ‘ä»¬ä¹‹å‰è¯´è¿‡çš„.constructorä¸€æ ·ï¼Œ.<strong>proto</strong>å®é™…ä¸Šå¹¶ä¸å­˜åœ¨äºä½ æ­£åœ¨ä½¿ç”¨çš„å¯¹è±¡ä¸­ï¼ˆæœ¬ä¾‹ä¸­æ˜¯aï¼‰ã€‚å®é™…ä¸Šï¼Œå®ƒå’Œå…¶ä»–çš„å¸¸ç”¨å‡½æ•°ï¼ˆ.toString()ã€.isPrototypeOf(..)ï¼Œç­‰ç­‰ï¼‰ä¸€æ ·ï¼Œå­˜åœ¨äºå†…ç½®çš„Object.prototypeä¸­ã€‚</p></blockquote><blockquote><p>JavaScriptç¤¾åŒºä¸­å¯¹äºåŒä¸‹åˆ’çº¿æœ‰ä¸€ä¸ªéå®˜æ–¹çš„ç§°å‘¼ï¼Œä»–ä»¬ä¼šæŠŠç±»ä¼¼<strong>proto</strong>çš„å±æ€§ç§°ä¸ºâ€œç¬¨è›‹ï¼ˆdunderï¼‰â€ã€‚æ‰€ä»¥ï¼ŒJavaScriptæ½®äººä¼šæŠŠ<strong>proto</strong>å«ä½œâ€œç¬¨è›‹protoâ€ã€‚</p></blockquote><h2 id="ç« èŠ‚ï¼š5-4-å¯¹è±¡å…³è”"><a href="#ç« èŠ‚ï¼š5-4-å¯¹è±¡å…³è”" class="headerlink" title="ç« èŠ‚ï¼š5.4ã€€å¯¹è±¡å…³è”"></a>ç« èŠ‚ï¼š5.4ã€€å¯¹è±¡å…³è”</h2><blockquote><p>ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†ï¼Œ[[Prototype]]æœºåˆ¶å°±æ˜¯å­˜åœ¨äºå¯¹è±¡ä¸­çš„ä¸€ä¸ªå†…éƒ¨é“¾æ¥ï¼Œå®ƒä¼šå¼•ç”¨å…¶ä»–å¯¹è±¡ã€‚<br>é€šå¸¸æ¥è¯´ï¼Œè¿™ä¸ªé“¾æ¥çš„ä½œç”¨æ˜¯ï¼šå¦‚æœåœ¨å¯¹è±¡ä¸Šæ²¡æœ‰æ‰¾åˆ°éœ€è¦çš„å±æ€§æˆ–è€…æ–¹æ³•å¼•ç”¨ï¼Œå¼•æ“å°±ä¼šç»§ç»­åœ¨[[Prototype]]å…³è”çš„å¯¹è±¡ä¸Šè¿›è¡ŒæŸ¥æ‰¾ã€‚åŒç†ï¼Œå¦‚æœåœ¨åè€…ä¸­ä¹Ÿæ²¡æœ‰æ‰¾åˆ°éœ€è¦çš„å¼•ç”¨å°±ä¼šç»§ç»­æŸ¥æ‰¾å®ƒçš„[[Prototype]]ï¼Œä»¥æ­¤ç±»æ¨ã€‚è¿™ä¸€ç³»åˆ—å¯¹è±¡çš„é“¾æ¥è¢«ç§°ä¸ºâ€œåŸå‹é“¾â€ã€‚</p></blockquote><blockquote><p>æˆ‘ä»¬å¹¶ä¸éœ€è¦ç±»æ¥åˆ›å»ºä¸¤ä¸ªå¯¹è±¡ä¹‹é—´çš„å…³ç³»ï¼Œåªéœ€è¦é€šè¿‡å§”æ‰˜æ¥å…³è”å¯¹è±¡å°±è¶³å¤Ÿäº†ã€‚è€ŒObject.create(..)ä¸åŒ…å«ä»»ä½•â€œç±»çš„è¯¡è®¡â€ï¼Œæ‰€ä»¥å®ƒå¯ä»¥å®Œç¾åœ°åˆ›å»ºæˆ‘ä»¬æƒ³è¦çš„å…³è”å…³ç³»ã€‚</p></blockquote><blockquote><p>æˆ‘å¹¶ä¸èµåŒè¿™ä¸ªä¸¥æ ¼çš„è§‚ç‚¹ï¼Œç›¸åï¼Œæˆ‘å¾ˆèµåŒåœ¨ES5ä¸­ä½¿ç”¨ä¸Šé¢é‚£æ®µpolyfillä»£ç ã€‚å¦‚ä½•é€‰æ‹©å–å†³äºä½ ã€‚</p></blockquote><blockquote><p>åœ¨ES6ä¸­æœ‰ä¸€ä¸ªè¢«ç§°ä¸ºâ€œä»£ç†â€ï¼ˆProxyï¼‰çš„é«˜ç«¯åŠŸèƒ½ï¼Œå®ƒå®ç°çš„å°±æ˜¯â€œæ–¹æ³•æ— æ³•æ‰¾åˆ°â€æ—¶çš„è¡Œä¸ºã€‚</p></blockquote><blockquote><p>åƒä¸‡ä¸è¦å¿½ç•¥è¿™ä¸ªå¾®å¦™ä½†æ˜¯éå¸¸é‡è¦çš„åŒºåˆ«ã€‚</p></blockquote><blockquote><p>ä½†æ˜¯ä½ å¯ä»¥è®©ä½ çš„APIè®¾è®¡ä¸é‚£ä¹ˆâ€œç¥å¥‡â€ï¼ŒåŒæ—¶ä»ç„¶èƒ½å‘æŒ¥[[Prototype]]å…³è”çš„å¨åŠ›ï¼š<br>var anotherObject = {<br>    cool: function() {<br>        console.log( â€œcool!â€ );<br>    }<br>};</p><p>var myObject = Object.create( anotherObject );</p><p>myObject.doCool = function() {<br>    this.cool(); // å†…éƒ¨å§”æ‰˜ï¼<br>};</p><p>myObject.doCool(); // â€œcool!â€<br>è¿™é‡Œæˆ‘ä»¬è°ƒç”¨çš„myObject.doCool()æ˜¯å®é™…å­˜åœ¨äºmyObjectä¸­çš„ï¼Œè¿™å¯ä»¥è®©æˆ‘ä»¬çš„APIè®¾è®¡æ›´åŠ æ¸…æ™°ï¼ˆä¸é‚£ä¹ˆâ€œç¥å¥‡â€ï¼‰ã€‚ä»å†…éƒ¨æ¥è¯´ï¼Œæˆ‘ä»¬çš„å®ç°éµå¾ªçš„æ˜¯å§”æ‰˜è®¾è®¡æ¨¡å¼ï¼ˆå‚è§ç¬¬6ç« ï¼‰ï¼Œé€šè¿‡[[Prototype]]å§”æ‰˜åˆ°anotherObj [â€¦]</p></blockquote><h2 id="ç« èŠ‚ï¼š5-5-å°ç»“"><a href="#ç« èŠ‚ï¼š5-5-å°ç»“" class="headerlink" title="ç« èŠ‚ï¼š5.5ã€€å°ç»“"></a>ç« èŠ‚ï¼š5.5ã€€å°ç»“</h2><blockquote><p>æ‰€æœ‰æ™®é€šå¯¹è±¡éƒ½æœ‰å†…ç½®çš„Object.prototypeï¼ŒæŒ‡å‘åŸå‹é“¾çš„é¡¶ç«¯ï¼ˆæ¯”å¦‚è¯´å…¨å±€ä½œç”¨åŸŸï¼‰ï¼Œå¦‚æœåœ¨åŸå‹é“¾ä¸­æ‰¾ä¸åˆ°æŒ‡å®šçš„å±æ€§å°±ä¼šåœæ­¢ã€‚</p></blockquote><blockquote><p>å…³è”ä¸¤ä¸ªå¯¹è±¡æœ€å¸¸ç”¨çš„æ–¹æ³•æ˜¯ä½¿ç”¨newå…³é”®è¯è¿›è¡Œå‡½æ•°è°ƒç”¨ï¼Œåœ¨è°ƒç”¨çš„4ä¸ªæ­¥éª¤ï¼ˆç¬¬2ç« ï¼‰ä¸­ä¼šåˆ›å»ºä¸€ä¸ªå…³è”å…¶ä»–å¯¹è±¡çš„æ–°å¯¹è±¡ã€‚<br>ä½¿ç”¨newè°ƒç”¨å‡½æ•°æ—¶ä¼šæŠŠæ–°å¯¹è±¡çš„.prototypeå±æ€§å…³è”åˆ°â€œå…¶ä»–å¯¹è±¡â€ã€‚å¸¦newçš„å‡½æ•°è°ƒç”¨é€šå¸¸è¢«ç§°ä¸ºâ€œæ„é€ å‡½æ•°è°ƒç”¨â€ï¼Œå°½ç®¡å®ƒä»¬å®é™…ä¸Šå’Œä¼ ç»Ÿé¢å‘ç±»è¯­è¨€ä¸­çš„ç±»æ„é€ å‡½æ•°ä¸ä¸€æ ·ã€‚</p></blockquote><blockquote><p>è™½ç„¶è¿™äº›JavaScriptæœºåˆ¶å’Œä¼ ç»Ÿé¢å‘ç±»è¯­è¨€ä¸­çš„â€œç±»åˆå§‹åŒ–â€å’Œâ€œç±»ç»§æ‰¿â€å¾ˆç›¸ä¼¼ï¼Œä½†æ˜¯JavaScriptä¸­çš„æœºåˆ¶æœ‰ä¸€ä¸ªæ ¸å¿ƒåŒºåˆ«ï¼Œé‚£å°±æ˜¯ä¸ä¼šè¿›è¡Œå¤åˆ¶ï¼Œå¯¹è±¡ä¹‹é—´æ˜¯é€šè¿‡å†…éƒ¨çš„[[Prototype]]é“¾å…³è”çš„ã€‚<br>å‡ºäºå„ç§åŸå› ï¼Œä»¥â€œç»§æ‰¿â€ç»“å°¾çš„æœ¯è¯­ï¼ˆåŒ…æ‹¬â€œåŸå‹ç»§æ‰¿â€ï¼‰å’Œå…¶ä»–é¢å‘å¯¹è±¡çš„æœ¯è¯­éƒ½æ— æ³•å¸®åŠ©ä½ ç†è§£JavaScriptçš„çœŸå®æœºåˆ¶ï¼ˆä¸ä»…ä»…æ˜¯é™åˆ¶æˆ‘ä»¬çš„æ€ç»´æ¨¡å¼ï¼‰ã€‚<br>ç›¸æ¯”ä¹‹ä¸‹ï¼Œâ€œå§”æ‰˜â€æ˜¯ä¸€ä¸ªæ›´åˆé€‚çš„æœ¯è¯­ï¼Œå› ä¸ºå¯¹è±¡ä¹‹é—´çš„å…³ç³»ä¸æ˜¯å¤åˆ¶è€Œæ˜¯å§”æ‰˜ã€‚</p></blockquote><h2 id="ç« èŠ‚ï¼šç¬¬-6-ç« -è¡Œä¸ºå§”æ‰˜"><a href="#ç« èŠ‚ï¼šç¬¬-6-ç« -è¡Œä¸ºå§”æ‰˜" class="headerlink" title="ç« èŠ‚ï¼šç¬¬ 6 ç« ã€€è¡Œä¸ºå§”æ‰˜"></a>ç« èŠ‚ï¼šç¬¬ 6 ç« ã€€è¡Œä¸ºå§”æ‰˜</h2><blockquote><p>ä¸å‡ºæ„å¤–ï¼Œç»å¤§å¤šæ•°JavaScriptå¼€å‘è€…ä»æ¥æ²¡æœ‰å¦‚æ­¤æ·±å…¥åœ°äº†è§£è¿‡JavaScriptï¼Œä»–ä»¬åªæ˜¯æŠŠè¿™äº›äº¤ç»™ä¸€ä¸ªâ€œç±»â€åº“æ¥å¤„ç†ã€‚</p></blockquote><blockquote><p>[[Prototype]]æœºåˆ¶å°±æ˜¯æŒ‡å¯¹è±¡ä¸­çš„ä¸€ä¸ªå†…éƒ¨é“¾æ¥å¼•ç”¨å¦ä¸€ä¸ªå¯¹è±¡ã€‚</p></blockquote><blockquote><p>å¦‚æœåœ¨ç¬¬ä¸€ä¸ªå¯¹è±¡ä¸Šæ²¡æœ‰æ‰¾åˆ°éœ€è¦çš„å±æ€§æˆ–è€…æ–¹æ³•å¼•ç”¨ï¼Œå¼•æ“å°±ä¼šç»§ç»­åœ¨[[Prototype]]å…³è”çš„å¯¹è±¡ä¸Šè¿›è¡ŒæŸ¥æ‰¾ã€‚åŒç†ï¼Œå¦‚æœåœ¨åè€…ä¸­ä¹Ÿæ²¡æœ‰æ‰¾åˆ°éœ€è¦çš„å¼•ç”¨å°±ä¼šç»§ç»­æŸ¥æ‰¾å®ƒçš„[[Prototype]]ï¼Œä»¥æ­¤ç±»æ¨ã€‚è¿™ä¸€ç³»åˆ—å¯¹è±¡çš„é“¾æ¥è¢«ç§°ä¸ºâ€œåŸå‹é“¾â€ã€‚</p></blockquote><blockquote><p>å¦‚æœåœ¨ç¬¬ä¸€ä¸ªå¯¹è±¡ä¸Šæ²¡æœ‰æ‰¾åˆ°éœ€è¦çš„å±æ€§æˆ–è€…æ–¹æ³•å¼•ç”¨ï¼Œå¼•æ“å°±ä¼šç»§ç»­åœ¨[[Prototype]]å…³è”çš„å¯¹è±¡ä¸Šè¿›è¡ŒæŸ¥æ‰¾ã€‚åŒç†ï¼Œå¦‚æœåœ¨åè€…ä¸­ä¹Ÿæ²¡æœ‰æ‰¾åˆ°éœ€è¦çš„å¼•ç”¨å°±ä¼šç»§ç»­æŸ¥æ‰¾å®ƒçš„[[Prototype]]ï¼Œä»¥æ­¤ç±»æ¨ã€‚è¿™ä¸€ç³»åˆ—å¯¹è±¡çš„é“¾æ¥è¢«ç§°ä¸ºâ€œåŸå‹é“¾â€ã€‚</p></blockquote><p>åˆ’é‡ç‚¹</p><blockquote><p>JavaScriptä¸­è¿™ä¸ªæœºåˆ¶çš„æœ¬è´¨å°±æ˜¯å¯¹è±¡ä¹‹é—´çš„å…³è”å…³ç³»ã€‚</p></blockquote><h2 id="ç« èŠ‚ï¼š6-1-é¢å‘å§”æ‰˜çš„è®¾è®¡"><a href="#ç« èŠ‚ï¼š6-1-é¢å‘å§”æ‰˜çš„è®¾è®¡" class="headerlink" title="ç« èŠ‚ï¼š6.1ã€€é¢å‘å§”æ‰˜çš„è®¾è®¡"></a>ç« èŠ‚ï¼š6.1ã€€é¢å‘å§”æ‰˜çš„è®¾è®¡</h2><blockquote><p>æˆ‘ä»¬éœ€è¦è¯•ç€æŠŠæ€è·¯ä»ç±»å’Œç»§æ‰¿çš„è®¾è®¡æ¨¡å¼è½¬æ¢åˆ°å§”æ‰˜è¡Œä¸ºçš„è®¾è®¡æ¨¡å¼ã€‚</p></blockquote><blockquote><p>éå¸¸é‡è¦çš„æ˜¯ï¼Œç±»è®¾è®¡æ¨¡å¼é¼“åŠ±ä½ åœ¨ç»§æ‰¿æ—¶ä½¿ç”¨æ–¹æ³•é‡å†™ï¼ˆå’Œå¤šæ€ï¼‰ï¼Œæ¯”å¦‚è¯´åœ¨XYZä»»åŠ¡ä¸­é‡å†™Taskä¸­å®šä¹‰çš„ä¸€äº›é€šç”¨æ–¹æ³•ï¼Œç”šè‡³åœ¨æ·»åŠ æ–°è¡Œä¸ºæ—¶é€šè¿‡superè°ƒç”¨è¿™ä¸ªæ–¹æ³•çš„åŸå§‹ç‰ˆæœ¬ã€‚ä½ ä¼šå‘ç°è®¸å¤šè¡Œä¸ºå¯ä»¥å…ˆâ€œæŠ½è±¡â€åˆ°çˆ¶ç±»ç„¶åå†ç”¨å­ç±»è¿›è¡Œç‰¹æ®ŠåŒ–ï¼ˆé‡å†™ï¼‰ã€‚</p></blockquote><blockquote><p>é¦–å…ˆä½ ä¼šå®šä¹‰ä¸€ä¸ªåä¸ºTaskçš„å¯¹è±¡ï¼ˆå’Œè®¸å¤šJavaScriptå¼€å‘è€…å‘Šè¯‰ä½ çš„ä¸åŒï¼Œå®ƒæ—¢ä¸æ˜¯ç±»ä¹Ÿä¸æ˜¯å‡½æ•°ï¼‰ï¼Œå®ƒä¼šåŒ…å«æ‰€æœ‰ä»»åŠ¡éƒ½å¯ä»¥ä½¿ç”¨ï¼ˆå†™ä½œä½¿ç”¨ï¼Œè¯»ä½œå§”æ‰˜ï¼‰çš„å…·ä½“è¡Œä¸ºã€‚æ¥ç€ï¼Œå¯¹äºæ¯ä¸ªä»»åŠ¡ï¼ˆâ€œXYZâ€ã€â€œABCâ€ï¼‰ä½ éƒ½ä¼šå®šä¹‰ä¸€ä¸ªå¯¹è±¡æ¥å­˜å‚¨å¯¹åº”çš„æ•°æ®å’Œè¡Œä¸ºã€‚ä½ ä¼šæŠŠç‰¹å®šçš„ä»»åŠ¡å¯¹è±¡éƒ½å…³è”åˆ°TaskåŠŸèƒ½å¯¹è±¡ä¸Šï¼Œè®©å®ƒä»¬åœ¨éœ€è¦çš„æ—¶å€™å¯ä»¥è¿›è¡Œå§”æ‰˜ã€‚</p></blockquote><blockquote><p>ç›¸æ¯”äºé¢å‘ç±»ï¼ˆæˆ–è€…è¯´é¢å‘å¯¹è±¡ï¼‰ï¼Œæˆ‘ä¼šæŠŠè¿™ç§ç¼–ç é£æ ¼ç§°ä¸ºâ€œå¯¹è±¡å…³è”â€ï¼ˆOLOOï¼Œobjects linked to other objectsï¼‰ã€‚æˆ‘ä»¬çœŸæ­£å…³å¿ƒçš„åªæ˜¯XYZå¯¹è±¡ï¼ˆå’ŒABCå¯¹è±¡ï¼‰å§”æ‰˜äº†Taskå¯¹è±¡ã€‚</p></blockquote><blockquote><p>ç›¸æ¯”äºé¢å‘ç±»ï¼ˆæˆ–è€…è¯´é¢å‘å¯¹è±¡ï¼‰ï¼Œæˆ‘ä¼šæŠŠè¿™ç§ç¼–ç é£æ ¼ç§°ä¸ºâ€œå¯¹è±¡å…³è”â€ï¼ˆOLOOï¼Œobjects linked to other objectsï¼‰ã€‚æˆ‘ä»¬çœŸæ­£å…³å¿ƒçš„åªæ˜¯XYZå¯¹è±¡ï¼ˆå’ŒABCå¯¹è±¡ï¼‰å§”æ‰˜äº†Taskå¯¹è±¡ã€‚</p></blockquote><p>OLOO objects linked to other objects</p><blockquote><p>æ— è®ºä½ å¤šä¹ˆåŠªåŠ›åœ°è¯´æœè‡ªå·±ï¼ŒJavaScriptä¸­å°±æ˜¯æ²¡æœ‰ç±»ä¼¼â€œç±»â€çš„æŠ½è±¡æœºåˆ¶</p></blockquote><blockquote><ol><li>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œidå’Œlabelæ•°æ®æˆå‘˜éƒ½æ˜¯ç›´æ¥å­˜å‚¨åœ¨XYZä¸Šï¼ˆè€Œä¸æ˜¯Taskï¼‰ã€‚é€šå¸¸æ¥è¯´ï¼Œåœ¨[[Prototype]]å§”æ‰˜ä¸­æœ€å¥½æŠŠçŠ¶æ€ä¿å­˜åœ¨å§”æ‰˜è€…ï¼ˆXYZã€ABCï¼‰è€Œä¸æ˜¯å§”æ‰˜ç›®æ ‡ï¼ˆTaskï¼‰ä¸Šã€‚</li><li>åœ¨ç±»è®¾è®¡æ¨¡å¼ä¸­ï¼Œæˆ‘ä»¬æ•…æ„è®©çˆ¶ç±»ï¼ˆTaskï¼‰å’Œå­ç±»ï¼ˆXYZï¼‰ä¸­éƒ½æœ‰outputTaskæ–¹æ³•ï¼Œè¿™æ ·å°±å¯ä»¥åˆ©ç”¨é‡å†™ï¼ˆå¤šæ€ï¼‰çš„ä¼˜åŠ¿ã€‚åœ¨å§”æ‰˜è¡Œä¸ºä¸­åˆ™æ°å¥½ç›¸åï¼šæˆ‘ä»¬ä¼šå°½é‡é¿å…åœ¨[[Prototype]]é“¾çš„ä¸åŒçº§åˆ«ä¸­ä½¿ç”¨ç›¸åŒçš„å‘½åï¼Œå¦åˆ™å°±éœ€è¦ä½¿ç”¨ç¬¨æ‹™å¹¶ä¸”è„†å¼±çš„è¯­æ³•æ¥æ¶ˆé™¤å¼•ç”¨æ­§ä¹‰ï¼ˆå‚è§ç¬¬4ç« ï¼‰ã€‚</li></ol></blockquote><blockquote><p>è¿™ä¸ªè®¾è®¡æ¨¡å¼è¦æ±‚å°½é‡å°‘ä½¿ç”¨å®¹æ˜“è¢«é‡å†™çš„é€šç”¨æ–¹æ³•åï¼Œæå€¡ä½¿ç”¨æ›´æœ‰æè¿°æ€§çš„æ–¹æ³•åï¼Œå°¤å…¶æ˜¯è¦å†™æ¸…ç›¸åº”å¯¹è±¡è¡Œä¸ºçš„ç±»å‹ã€‚</p></blockquote><blockquote><p>å§”æ‰˜è¡Œä¸ºæ„å‘³ç€æŸäº›å¯¹è±¡ï¼ˆXYZï¼‰åœ¨æ‰¾ä¸åˆ°å±æ€§æˆ–è€…æ–¹æ³•å¼•ç”¨æ—¶ä¼šæŠŠè¿™ä¸ªè¯·æ±‚å§”æ‰˜ç»™å¦ä¸€ä¸ªå¯¹è±¡ï¼ˆTaskï¼‰</p></blockquote><blockquote><p>è¿™æ˜¯ä¸€ç§æå…¶å¼ºå¤§çš„è®¾è®¡æ¨¡å¼ï¼Œå’Œçˆ¶ç±»ã€å­ç±»ã€ç»§æ‰¿ã€å¤šæ€ç­‰æ¦‚å¿µå®Œå…¨ä¸åŒã€‚åœ¨ä½ çš„è„‘æµ·ä¸­å¯¹è±¡å¹¶ä¸æ˜¯æŒ‰ç…§çˆ¶ç±»åˆ°å­ç±»çš„å…³ç³»å‚ç›´ç»„ç»‡çš„ï¼Œè€Œæ˜¯é€šè¿‡ä»»æ„æ–¹å‘çš„å§”æ‰˜å…³è”å¹¶æ’ç»„ç»‡çš„ã€‚</p></blockquote><blockquote><p>è¿™æ˜¯ä¸€ç§æå…¶å¼ºå¤§çš„è®¾è®¡æ¨¡å¼ï¼Œå’Œçˆ¶ç±»ã€å­ç±»ã€ç»§æ‰¿ã€å¤šæ€ç­‰æ¦‚å¿µå®Œå…¨ä¸åŒã€‚åœ¨ä½ çš„è„‘æµ·ä¸­å¯¹è±¡å¹¶ä¸æ˜¯æŒ‰ç…§çˆ¶ç±»åˆ°å­ç±»çš„å…³ç³»å‚ç›´ç»„ç»‡çš„ï¼Œè€Œæ˜¯é€šè¿‡ä»»æ„æ–¹å‘çš„å§”æ‰˜å…³è”å¹¶æ’ç»„ç»‡çš„ã€‚</p></blockquote><p>è®°ä½è¿™ä¸ªæè¿°</p><blockquote><ol><li>äº’ç›¸å§”æ‰˜ï¼ˆç¦æ­¢ï¼‰<br>ä½ æ— æ³•åœ¨ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šäº’ç›¸ï¼ˆåŒå‘ï¼‰å§”æ‰˜çš„å¯¹è±¡ä¹‹é—´åˆ›å»ºå¾ªç¯å§”æ‰˜ã€‚å¦‚æœä½ æŠŠBå…³è”åˆ°Aç„¶åè¯•ç€æŠŠAå…³è”åˆ°Bï¼Œå°±ä¼šå‡ºé”™ã€‚</li></ol></blockquote><blockquote><ol start="2"><li>è°ƒè¯•</li></ol></blockquote><blockquote><p>é¦–å…ˆï¼Œç±»é£æ ¼ä»£ç çš„æ€ç»´æ¨¡å‹å¼ºè°ƒå®ä½“ä»¥åŠå®ä½“é—´çš„å…³ç³»ï¼š</p></blockquote><blockquote><p>JavaScriptä¸­çš„å‡½æ•°ä¹‹æ‰€ä»¥å¯ä»¥è®¿é—®call(..)ã€apply(..)å’Œbind(..)ï¼ˆå‚è§ç¬¬2ç« ï¼‰ï¼Œå°±æ˜¯å› ä¸ºå‡½æ•°æœ¬èº«æ˜¯å¯¹è±¡ã€‚è€Œå‡½æ•°å¯¹è±¡åŒæ ·æœ‰[[Prototype]]å±æ€§å¹¶ä¸”å…³è”åˆ°Function.prototypeå¯¹è±¡ï¼Œå› æ­¤æ‰€æœ‰å‡½æ•°å¯¹è±¡éƒ½å¯ä»¥é€šè¿‡å§”æ‰˜è°ƒç”¨è¿™äº›é»˜è®¤æ–¹æ³•ã€‚JavaScriptèƒ½åšåˆ°è¿™ä¸€ç‚¹ï¼Œä½ ä¹Ÿå¯ä»¥ï¼</p></blockquote><blockquote><p>é€šè¿‡æ¯”è¾ƒå¯ä»¥çœ‹å‡ºï¼Œå¯¹è±¡å…³è”é£æ ¼çš„ä»£ç æ˜¾ç„¶æ›´åŠ ç®€æ´ï¼Œå› ä¸ºè¿™ç§ä»£ç åªå…³æ³¨ä¸€ä»¶äº‹ï¼šå¯¹è±¡ä¹‹é—´çš„å…³è”å…³ç³»ã€‚</p></blockquote><h2 id="ç« èŠ‚ï¼š6-2-ç±»ä¸å¯¹è±¡"><a href="#ç« èŠ‚ï¼š6-2-ç±»ä¸å¯¹è±¡" class="headerlink" title="ç« èŠ‚ï¼š6.2ã€€ç±»ä¸å¯¹è±¡"></a>ç« èŠ‚ï¼š6.2ã€€ç±»ä¸å¯¹è±¡</h2><blockquote><p>ä½¿ç”¨ç±»æ„é€ å‡½æ•°çš„è¯ï¼Œä½ éœ€è¦ï¼ˆå¹¶ä¸æ˜¯ç¡¬æ€§è¦æ±‚ï¼Œä½†æ˜¯å¼ºçƒˆå»ºè®®ï¼‰åœ¨åŒä¸€ä¸ªæ­¥éª¤ä¸­å®ç°æ„é€ å’Œåˆå§‹åŒ–ã€‚ç„¶è€Œï¼Œåœ¨è®¸å¤šæƒ…å†µä¸‹æŠŠè¿™ä¸¤æ­¥åˆ†å¼€ï¼ˆå°±åƒå¯¹è±¡å…³è”ä»£ç ä¸€æ ·ï¼‰æ›´çµæ´»ã€‚</p></blockquote><blockquote><p>å¯¹è±¡å…³è”å¯ä»¥æ›´å¥½åœ°æ”¯æŒå…³æ³¨åˆ†ç¦»ï¼ˆseparation of concernsï¼‰åŸåˆ™ï¼Œåˆ›å»ºå’Œåˆå§‹åŒ–å¹¶ä¸éœ€è¦åˆå¹¶ä¸ºä¸€ä¸ªæ­¥éª¤ã€‚</p></blockquote><h2 id="ç« èŠ‚ï¼š6-3-æ›´ç®€æ´çš„è®¾è®¡"><a href="#ç« èŠ‚ï¼š6-3-æ›´ç®€æ´çš„è®¾è®¡" class="headerlink" title="ç« èŠ‚ï¼š6.3ã€€æ›´ç®€æ´çš„è®¾è®¡"></a>ç« èŠ‚ï¼š6.3ã€€æ›´ç®€æ´çš„è®¾è®¡</h2><blockquote><p>æ‰€æœ‰æ§åˆ¶å™¨å…±äº«çš„åŸºç¡€è¡Œä¸ºæ˜¯success(..)ã€failure(..)å’ŒshowDialog(..)ã€‚å­ç±»LoginControllerå’ŒAuthControlleré€šè¿‡é‡å†™failure(..)å’Œsuccess(..)æ¥æ‰©å±•é»˜è®¤åŸºç¡€ç±»è¡Œä¸ºã€‚æ­¤å¤–ï¼Œæ³¨æ„AuthControlleréœ€è¦ä¸€ä¸ªLoginControllerçš„å®ä¾‹æ¥å’Œç™»å½•è¡¨å•è¿›è¡Œäº¤äº’ï¼Œå› æ­¤è¿™ä¸ªå®ä¾‹å˜æˆäº†ä¸€ä¸ªæ•°æ®å±æ€§ã€‚<br>å¦ä¸€ä¸ªéœ€è¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬åœ¨ç»§æ‰¿çš„åŸºç¡€ä¸Šè¿›è¡Œäº†ä¸€äº›åˆæˆã€‚AuthControlleréœ€è¦ä½¿ç”¨LoginControllerï¼Œå› æ­¤æˆ‘ä»¬å®ä¾‹åŒ–åè€…ï¼ˆnew LoginController()ï¼‰å¹¶ç”¨ä¸€ä¸ªç±»æˆå‘˜å±æ€§this.loginæ¥å¼•ç”¨å®ƒï¼Œè¿™æ ·AuthControllerå°±å¯ä»¥è°ƒç”¨LoginControllerçš„è¡Œä¸ºã€‚</p></blockquote><p>ä¸Šé¢ğŸ‘†ä»£ç æœ€åå®ä¾‹åŒ–çš„éƒ¨åˆ†å†™é”™äº†ï¼Œç‰¹æ„ç¿»äº†çº¸è´¨ç‰ˆåŸä¹¦ï¼Œæœç„¶å†™é”™äº†ï¼Œæ­£ç¡®çš„æ˜¯è¿™æ ·ï¼š var auth = new AuthController( new LoginController() );  auth.checkAuth();</p><blockquote><p>ç”±äºAuthControlleråªæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ˆLoginControllerä¹Ÿä¸€æ ·ï¼‰ï¼Œå› æ­¤æˆ‘ä»¬ä¸éœ€è¦å®ä¾‹åŒ–ï¼ˆæ¯”å¦‚new AuthController()ï¼‰ï¼Œåªéœ€è¦ä¸€è¡Œä»£ç å°±è¡Œï¼š</p></blockquote><blockquote><p>è¿™ç§æ¨¡å¼çš„é‡ç‚¹åœ¨äºåªéœ€è¦ä¸¤ä¸ªå®ä½“ï¼ˆLoginControllerå’ŒAuthControllerï¼‰ï¼Œè€Œä¹‹å‰çš„æ¨¡å¼éœ€è¦ä¸‰ä¸ªã€‚</p></blockquote><blockquote><p>æˆ‘ä»¬ä¸éœ€è¦ControlleråŸºç±»æ¥â€œå…±äº«â€ä¸¤ä¸ªå®ä½“ä¹‹é—´çš„è¡Œä¸ºï¼Œå› ä¸ºå§”æ‰˜è¶³ä»¥æ»¡è¶³æˆ‘ä»¬éœ€è¦çš„åŠŸèƒ½ã€‚åŒæ ·ï¼Œå‰é¢æåˆ°è¿‡ï¼Œæˆ‘ä»¬ä¹Ÿä¸éœ€è¦å®ä¾‹åŒ–ç±»ï¼Œå› ä¸ºå®ƒä»¬æ ¹æœ¬å°±ä¸æ˜¯ç±»ï¼Œå®ƒä»¬åªæ˜¯å¯¹è±¡ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬ä¹Ÿä¸éœ€è¦åˆæˆï¼Œå› ä¸ºä¸¤ä¸ªå¯¹è±¡å¯ä»¥é€šè¿‡å§”æ‰˜è¿›è¡Œåˆä½œã€‚</p></blockquote><blockquote><p>æ€»ç»“ï¼šæˆ‘ä»¬ç”¨ä¸€ç§ï¼ˆæå…¶ï¼‰ç®€å•çš„è®¾è®¡å®ç°äº†åŒæ ·çš„åŠŸèƒ½ï¼Œè¿™å°±æ˜¯å¯¹è±¡å…³è”é£æ ¼ä»£ç å’Œè¡Œä¸ºå§”æ‰˜è®¾è®¡æ¨¡å¼çš„åŠ›é‡ã€‚</p></blockquote><h2 id="ç« èŠ‚ï¼š6-4-æ›´å¥½çš„è¯­æ³•"><a href="#ç« èŠ‚ï¼š6-4-æ›´å¥½çš„è¯­æ³•" class="headerlink" title="ç« èŠ‚ï¼š6.4ã€€æ›´å¥½çš„è¯­æ³•"></a>ç« èŠ‚ï¼š6.4ã€€æ›´å¥½çš„è¯­æ³•</h2><blockquote><p>åœ¨ES6ä¸­æˆ‘ä»¬å¯ä»¥åœ¨ä»»æ„å¯¹è±¡çš„å­—é¢å½¢å¼ä¸­ä½¿ç”¨ç®€æ´æ–¹æ³•å£°æ˜ï¼ˆconcise method declarationï¼‰ï¼Œæ‰€ä»¥å¯¹è±¡å…³è”é£æ ¼çš„å¯¹è±¡å¯ä»¥è¿™æ ·å£°æ˜ï¼ˆå’Œclassçš„è¯­æ³•ç³–ä¸€æ ·ï¼‰ï¼š<br>var LoginController = {<br>    errors: [],<br>    getUser() { // å¦ˆå¦ˆå†ä¹Ÿä¸ç”¨æ‹…å¿ƒä»£ç é‡Œæœ‰functionäº†ï¼<br>        // â€¦<br>    },<br>    getPassword() {<br>        // â€¦<br>    }<br>    // â€¦<br>};<br>å”¯ä¸€çš„åŒºåˆ«æ˜¯å¯¹è±¡çš„å­—é¢å½¢å¼ä»ç„¶éœ€è¦ä½¿ç”¨â€œ,â€æ¥åˆ†éš”å…ƒç´ ï¼Œè€Œclassè¯­æ³•ä¸éœ€è¦ã€‚è¿™ä¸ªåŒºåˆ«å¯¹äºæ•´ä½“çš„è®¾è®¡æ¥è¯´æ— å…³ç´§è¦ã€‚</p></blockquote><blockquote><p>ä½¿ç”¨ç®€æ´æ–¹æ³•æ—¶ä¸€å®šè¦å°å¿ƒè¿™ä¸€ç‚¹ã€‚å¦‚æœä½ éœ€è¦è‡ªæˆ‘å¼•ç”¨çš„è¯ï¼Œé‚£æœ€å¥½ä½¿ç”¨ä¼ ç»Ÿçš„å…·åå‡½æ•°è¡¨è¾¾å¼æ¥å®šä¹‰å¯¹åº”çš„å‡½æ•°ï¼ˆÂ·baz: function baz(){..}Â·ï¼‰ï¼Œä¸è¦ä½¿ç”¨ç®€æ´æ–¹æ³•ã€‚</p></blockquote><h2 id="ç« èŠ‚ï¼š6-5-å†…çœ"><a href="#ç« èŠ‚ï¼š6-5-å†…çœ" class="headerlink" title="ç« èŠ‚ï¼š6.5ã€€å†…çœ"></a>ç« èŠ‚ï¼š6.5ã€€å†…çœ</h2><blockquote><p>è‡ªçœå°±æ˜¯æ£€æŸ¥å®ä¾‹çš„ç±»å‹ã€‚ç±»å®ä¾‹çš„è‡ªçœä¸»è¦ç›®çš„æ˜¯é€šè¿‡åˆ›å»ºæ–¹å¼æ¥åˆ¤æ–­å¯¹è±¡çš„ç»“æ„å’ŒåŠŸèƒ½ã€‚</p></blockquote><blockquote><p>å› ä¸ºFoo.prototypeï¼ˆä¸æ˜¯Fooï¼ï¼‰åœ¨a1çš„[[Prototype]]é“¾ä¸Šï¼ˆå‚è§ç¬¬5ç« ï¼‰</p></blockquote><blockquote><p>å†è¯´ä¸€æ¬¡ï¼Œæˆ‘ä»¬è®¤ä¸ºJavaScriptä¸­å¯¹è±¡å…³è”æ¯”ç±»é£æ ¼çš„ä»£ç æ›´åŠ ç®€æ´ï¼ˆè€Œä¸”åŠŸèƒ½ç›¸åŒï¼‰ã€‚</p></blockquote><h2 id="ç« èŠ‚ï¼š6-6-å°ç»“"><a href="#ç« èŠ‚ï¼š6-6-å°ç»“" class="headerlink" title="ç« èŠ‚ï¼š6.6ã€€å°ç»“"></a>ç« èŠ‚ï¼š6.6ã€€å°ç»“</h2><blockquote><p>åœ¨è½¯ä»¶æ¶æ„ä¸­ä½ å¯ä»¥é€‰æ‹©æ˜¯å¦ä½¿ç”¨ç±»å’Œç»§æ‰¿è®¾è®¡æ¨¡å¼ã€‚å¤§å¤šæ•°å¼€å‘è€…ç†æ‰€å½“ç„¶åœ°è®¤ä¸ºç±»æ˜¯å”¯ä¸€ï¼ˆåˆé€‚ï¼‰çš„ä»£ç ç»„ç»‡æ–¹å¼ï¼Œä½†æ˜¯æœ¬ç« ä¸­æˆ‘ä»¬çœ‹åˆ°äº†å¦ä¸€ç§æ›´å°‘è§ä½†æ˜¯æ›´å¼ºå¤§çš„è®¾è®¡æ¨¡å¼ï¼šè¡Œä¸ºå§”æ‰˜ã€‚</p></blockquote><blockquote><p>è¡Œä¸ºå§”æ‰˜è®¤ä¸ºå¯¹è±¡ä¹‹é—´æ˜¯å…„å¼Ÿå…³ç³»ï¼Œäº’ç›¸å§”æ‰˜ï¼Œè€Œä¸æ˜¯çˆ¶ç±»å’Œå­ç±»çš„å…³ç³»ã€‚JavaScriptçš„[[Prototype]]æœºåˆ¶æœ¬è´¨ä¸Šå°±æ˜¯è¡Œä¸ºå§”æ‰˜æœºåˆ¶ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©åœ¨JavaScriptä¸­åŠªåŠ›å®ç°ç±»æœºåˆ¶ï¼ˆå‚è§ç¬¬4å’Œç¬¬5ç« ï¼‰ï¼Œä¹Ÿå¯ä»¥æ‹¥æŠ±æ›´è‡ªç„¶çš„[[Prototype]]å§”æ‰˜æœºåˆ¶ã€‚</p></blockquote><blockquote><p>å½“ä½ åªç”¨å¯¹è±¡æ¥è®¾è®¡ä»£ç æ—¶ï¼Œä¸ä»…å¯ä»¥è®©è¯­æ³•æ›´åŠ ç®€æ´ï¼Œè€Œä¸”å¯ä»¥è®©ä»£ç ç»“æ„æ›´åŠ æ¸…æ™°ã€‚</p></blockquote><blockquote><p>å¯¹è±¡å…³è”ï¼ˆå¯¹è±¡ä¹‹å‰äº’ç›¸å…³è”ï¼‰æ˜¯ä¸€ç§ç¼–ç é£æ ¼ï¼Œå®ƒå€¡å¯¼çš„æ˜¯ç›´æ¥åˆ›å»ºå’Œå…³è”å¯¹è±¡ï¼Œä¸æŠŠå®ƒä»¬æŠ½è±¡æˆç±»ã€‚å¯¹è±¡å…³è”å¯ä»¥ç”¨åŸºäº[[Prototype]]çš„è¡Œä¸ºå§”æ‰˜éå¸¸è‡ªç„¶åœ°å®ç°ã€‚</p></blockquote><h2 id="ç« èŠ‚ï¼šé™„å½•A-ES6ä¸­çš„Class"><a href="#ç« èŠ‚ï¼šé™„å½•A-ES6ä¸­çš„Class" class="headerlink" title="ç« èŠ‚ï¼šé™„å½•Aã€€ES6ä¸­çš„Class"></a>ç« èŠ‚ï¼šé™„å½•Aã€€ES6ä¸­çš„Class</h2><blockquote><p>ç±»æ˜¯ä¸€ç§å¯é€‰ï¼ˆè€Œä¸æ˜¯å¿…é¡»ï¼‰çš„è®¾è®¡æ¨¡å¼ï¼Œè€Œä¸”åœ¨JavaScriptè¿™æ ·çš„[[Prototype]]è¯­è¨€ä¸­å®ç°ç±»æ˜¯å¾ˆåˆ«æ‰­çš„ã€‚</p></blockquote><blockquote><p>ç±»å¹¶ä¸é€‚ç”¨äºJavaScriptã€‚</p></blockquote><h2 id="ç« èŠ‚ï¼šA-1-class"><a href="#ç« èŠ‚ï¼šA-1-class" class="headerlink" title="ç« èŠ‚ï¼šA.1ã€€ class"></a>ç« èŠ‚ï¼šA.1ã€€ class</h2><blockquote><p>é™¤äº†è¯­æ³•æ›´å¥½çœ‹ä¹‹å¤–ï¼ŒES6è¿˜è§£å†³äº†ä»€ä¹ˆé—®é¢˜å‘¢ï¼Ÿ<br>1.ï¼ˆåŸºæœ¬ä¸Šï¼Œä¸‹é¢ä¼šè¯¦ç»†ä»‹ç»ï¼‰ä¸å†å¼•ç”¨æ‚ä¹±çš„.prototypeäº†ã€‚  </p><ol start="2"><li>Buttonå£°æ˜æ—¶ç›´æ¥â€œç»§æ‰¿â€äº†Widgetï¼Œä¸å†éœ€è¦é€šè¿‡Object.create(..)æ¥æ›¿æ¢.prototypeå¯¹è±¡ï¼Œä¹Ÿä¸éœ€è¦è®¾ç½®.<strong>proto</strong>æˆ–è€…Object.setPrototypeOf(..)ã€‚  </li><li>å¯ä»¥é€šè¿‡super(..)æ¥å®ç°ç›¸å¯¹å¤šæ€ï¼Œè¿™æ ·ä»»ä½•æ–¹æ³•éƒ½å¯ä»¥å¼•ç”¨åŸå‹é“¾ä¸Šå±‚çš„åŒåæ–¹æ³•ã€‚è¿™å¯ä»¥è§£å†³ç¬¬4ç« æåˆ°è¿‡çš„é‚£ä¸ªé—®é¢˜ï¼šæ„é€ å‡½æ•°ä¸å±äºç±»ï¼Œæ‰€ä»¥æ— æ³•äº’ç›¸å¼•ç”¨â€”â€”super()å¯ä»¥å®Œç¾è§£å†³æ„é€ å‡½æ•°çš„é—®é¢˜ã€‚  </li><li>classå­—é¢è¯­æ³•ä¸èƒ½å£°æ˜å±æ€§ï¼ˆåªèƒ½å£°æ˜æ–¹æ³•ï¼‰ã€‚çœ‹èµ·æ¥è¿™æ˜¯ä¸€ç§é™åˆ¶ï¼Œä½†æ˜¯å®ƒä¼šæ’é™¤æ‰è®¸å¤šä¸å¥½çš„æƒ…å†µï¼Œå¦‚æœæ²¡æœ‰è¿™ç§é™åˆ¶çš„è¯ï¼ŒåŸå‹é“¾æœ«ç«¯çš„â€œå®ä¾‹â€å¯èƒ½ä¼šæ„å¤–åœ°è·å–å…¶ä»–åœ°æ–¹çš„å±æ€§ï¼ˆè¿™äº›å±æ€§éšå¼è¢«æ‰€æœ‰â€œå®ä¾‹â€æ‰€â€œå…±äº«â€ï¼‰ã€‚æ‰€ä»¥ï¼Œclassè¯­æ³•å®é™… [â€¦]</li></ol></blockquote><h2 id="ç« èŠ‚ï¼šA-2-class-é™·é˜±"><a href="#ç« èŠ‚ï¼šA-2-class-é™·é˜±" class="headerlink" title="ç« èŠ‚ï¼šA.2ã€€ class é™·é˜±"></a>ç« èŠ‚ï¼šA.2ã€€ class é™·é˜±</h2><blockquote><p>é¦–å…ˆï¼Œä½ å¯èƒ½ä¼šè®¤ä¸ºES6çš„classè¯­æ³•æ˜¯å‘JavaScriptä¸­å¼•å…¥äº†ä¸€ç§æ–°çš„â€œç±»â€æœºåˆ¶ï¼Œå…¶å®ä¸æ˜¯è¿™æ ·ã€‚classåŸºæœ¬ä¸Šåªæ˜¯ç°æœ‰[[Prototype]]ï¼ˆå§”æ‰˜ï¼ï¼‰æœºåˆ¶çš„ä¸€ç§è¯­æ³•ç³–ã€‚</p></blockquote><blockquote><p>classå¹¶ä¸ä¼šåƒä¼ ç»Ÿé¢å‘ç±»çš„è¯­è¨€ä¸€æ ·åœ¨å£°æ˜æ—¶é™æ€å¤åˆ¶æ‰€æœ‰è¡Œä¸ºã€‚å¦‚æœä½ ï¼ˆæœ‰æ„æˆ–æ— æ„ï¼‰ä¿®æ”¹æˆ–è€…æ›¿æ¢äº†çˆ¶â€œç±»â€ä¸­çš„ä¸€ä¸ªæ–¹æ³•ï¼Œé‚£å­â€œç±»â€å’Œæ‰€æœ‰å®ä¾‹éƒ½ä¼šå—åˆ°å½±å“ï¼Œå› ä¸ºå®ƒä»¬åœ¨å®šä¹‰æ—¶å¹¶æ²¡æœ‰è¿›è¡Œå¤åˆ¶ï¼Œåªæ˜¯ä½¿ç”¨åŸºäº[[Prototype]]çš„å®æ—¶å§”æ‰˜ï¼š</p></blockquote><blockquote><p>ES6ä¸­çš„classè¯­æ³•ä¸æ˜¯ä¼šè®©ä¼ ç»Ÿç±»å’Œå§”æ‰˜å¯¹è±¡ä¹‹é—´çš„åŒºåˆ«æ›´åŠ éš¾ä»¥å‘ç°å’Œç†è§£å—ï¼Ÿ</p></blockquote><p>æ€è€ƒ</p><blockquote><p>æ— è®ºç›®å‰çš„æ–¹æ³•åœ¨åŸå‹é“¾ä¸­å¤„äºä»€ä¹ˆä½ç½®ï¼Œsuperæ€»ä¼šç»‘å®šåˆ°é“¾ä¸­çš„ä¸Šä¸€å±‚ã€‚</p></blockquote><blockquote><p>ç„¶è€Œï¼Œå‡ºäºæ€§èƒ½è€ƒè™‘ï¼ˆthisç»‘å®šå·²ç»æ˜¯å¾ˆå¤§çš„å¼€é”€äº†ï¼‰ï¼Œsuperå¹¶ä¸æ˜¯åŠ¨æ€ç»‘å®šçš„ï¼Œå®ƒä¼šåœ¨å£°æ˜æ—¶â€œé™æ€â€ç»‘å®š</p></blockquote><blockquote><p>å‡ºäºæ€§èƒ½è€ƒè™‘ï¼Œsuperå¹¶ä¸åƒthisä¸€æ ·æ˜¯æ™šç»‘å®šï¼ˆlate boundï¼Œ æˆ–è€…è¯´åŠ¨æ€ç»‘å®šï¼‰çš„ï¼Œå®ƒåœ¨[[HomeObject]].[[Prototype]]ä¸Šï¼Œ[[HomeObject]]ä¼šåœ¨åˆ›å»ºæ—¶é™æ€ç»‘å®šã€‚</p></blockquote><h2 id="ç« èŠ‚ï¼šA-3-é™æ€å¤§äºåŠ¨æ€å—"><a href="#ç« èŠ‚ï¼šA-3-é™æ€å¤§äºåŠ¨æ€å—" class="headerlink" title="ç« èŠ‚ï¼šA.3ã€€é™æ€å¤§äºåŠ¨æ€å—"></a>ç« èŠ‚ï¼šA.3ã€€é™æ€å¤§äºåŠ¨æ€å—</h2><blockquote><p>åœ¨ä¼ ç»Ÿé¢å‘ç±»çš„è¯­è¨€ä¸­ï¼Œç±»å®šä¹‰ä¹‹åå°±ä¸ä¼šè¿›è¡Œä¿®æ”¹ï¼Œæ‰€ä»¥ç±»çš„è®¾è®¡æ¨¡å¼å°±ä¸æ”¯æŒä¿®æ”¹ã€‚ä½†æ˜¯JavaScriptæœ€å¼ºå¤§çš„ç‰¹æ€§ä¹‹ä¸€å°±æ˜¯å®ƒçš„åŠ¨æ€æ€§ï¼Œä»»ä½•å¯¹è±¡çš„å®šä¹‰éƒ½å¯ä»¥ä¿®æ”¹ï¼ˆé™¤éä½ æŠŠå®ƒè®¾ç½®æˆä¸å¯å˜ï¼‰ã€‚</p></blockquote><blockquote><p>æ¢å¥è¯è¯´ï¼Œclassä¼¼ä¹æƒ³å‘Šè¯‰ä½ ï¼šâ€œåŠ¨æ€å¤ªéš¾å®ç°äº†ï¼Œæ‰€ä»¥è¿™å¯èƒ½ä¸æ˜¯ä¸ªå¥½ä¸»æ„ã€‚è¿™é‡Œæœ‰ä¸€ç§çœ‹èµ·æ¥åƒé™æ€çš„è¯­æ³•ï¼Œæ‰€ä»¥ç¼–å†™é™æ€ä»£ç å§ã€‚â€</p></blockquote><blockquote><p>åŠ¨æ€å¤ªéš¾å®ç°äº†ï¼Œæˆ‘ä»¬å‡è£…æˆé™æ€å§ã€‚ï¼ˆä½†æ˜¯å®é™…ä¸Šå¹¶ä¸æ˜¯ï¼ï¼‰</p></blockquote><blockquote><p>æ€»åœ°æ¥è¯´ï¼ŒES6çš„classæƒ³ä¼ªè£…æˆä¸€ç§å¾ˆå¥½çš„è¯­æ³•é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼Œä½†æ˜¯å®é™…ä¸Šå´è®©é—®é¢˜æ›´éš¾è§£å†³è€Œä¸”è®©JavaScriptæ›´åŠ éš¾ä»¥ç†è§£ã€‚</p></blockquote><h2 id="ç« èŠ‚ï¼šA-4-å°ç»“"><a href="#ç« èŠ‚ï¼šA-4-å°ç»“" class="headerlink" title="ç« èŠ‚ï¼šA.4ã€€å°ç»“"></a>ç« èŠ‚ï¼šA.4ã€€å°ç»“</h2><blockquote><p>classå¾ˆå¥½åœ°ä¼ªè£…æˆJavaScriptä¸­ç±»å’Œç»§æ‰¿è®¾è®¡æ¨¡å¼çš„è§£å†³æ–¹æ¡ˆï¼Œä½†æ˜¯å®ƒå®é™…ä¸Šèµ·åˆ°äº†åä½œç”¨ï¼šå®ƒéšè—äº†è®¸å¤šé—®é¢˜å¹¶ä¸”å¸¦æ¥äº†æ›´å¤šæ›´ç»†å°ä½†æ˜¯å±é™©çš„é—®é¢˜ã€‚</p></blockquote><blockquote><p>classåŠ æ·±äº†è¿‡å»20å¹´ä¸­å¯¹äºJavaScriptä¸­â€œç±»â€çš„è¯¯è§£ï¼Œåœ¨æŸäº›æ–¹é¢ï¼Œå®ƒäº§ç”Ÿçš„é—®é¢˜æ¯”è§£å†³çš„å¤šï¼Œè€Œä¸”è®©æœ¬æ¥ä¼˜é›…ç®€æ´çš„[[Prototype]]æœºåˆ¶å˜å¾—éå¸¸åˆ«æ‰­ã€‚</p></blockquote><blockquote><p>å¦‚æœES6çš„classè®©[[Prototype]]å˜å¾—æ›´åŠ éš¾ç”¨è€Œä¸”éšè—äº†JavaScriptå¯¹è±¡æœ€é‡è¦çš„æœºåˆ¶â€”â€”å¯¹è±¡ä¹‹é—´çš„å®æ—¶å§”æ‰˜å…³è”ï¼Œæˆ‘ä»¬éš¾é“ä¸åº”è¯¥è®¤ä¸ºclassäº§ç”Ÿçš„é—®é¢˜æ¯”è§£å†³çš„å¤šå—ï¼Ÿéš¾é“ä¸åº”è¯¥æŠµåˆ¶è¿™ç§è®¾è®¡æ¨¡å¼å—ï¼Ÿ</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> study notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> study notes </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>UIç»„ä»¶ğŸ”§Ax-View</title>
      <link href="/2018/10/18/4ax-view/"/>
      <url>/2018/10/18/4ax-view/</url>
      
        <content type="html"><![CDATA[<p><img src="/2018/10/18/4ax-view/./wss.jpg" width="250px"><br>åŸºäºvueå®ç°ä¸€äº›å¸¸ç”¨UIç»„ä»¶,å°è£…æˆåº“ï¼Œå–åax-view</p><a id="more"></a><hr><p>æ›´å¤šæ–‡æ¡£ç§»æ­¥GitHubï¼š<a href="https://github.com/Alexixyc/AlexiComponents" target="_blank" rel="noopener">Ax-View</a></p><blockquote><p><a href="http://alexixyc.cn/dist/#/pagination" title="åˆ†é¡µç»„ä»¶pagination">åˆ†é¡µç»„ä»¶</a></p></blockquote><blockquote><p><a href="http://alexixyc.cn/dist/#/input" title="è¾“å…¥æ¡†ç»„ä»¶input">è¾“å…¥æ¡†ç»„ä»¶</a></p></blockquote><blockquote><p><a href="http://alexixyc.cn/dist/#/select" title="é€‰æ‹©å™¨ç»„ä»¶select">é€‰æ‹©å™¨ç»„ä»¶</a></p></blockquote><blockquote><p><a href="http://alexixyc.cn/dist/#/date-picker" title="æ—¥æœŸé€‰æ‹©ç»„ä»¶date-picker">æ—¥æœŸé€‰æ‹©ç»„ä»¶</a></p></blockquote><p>â€¦.æœªå®Œå¾…ç»­</p>]]></content>
      
      
      <categories>
          
          <category> ä¸ªäººé¡¹ç›® </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ui-components </tag>
            
            <tag> personal program </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åˆæ¢å¾®ä¿¡å°ç¨‹åºâ€”â€”mpvueè¸©å‘æ€»ç»“</title>
      <link href="/2018/08/04/3mpvue/"/>
      <url>/2018/08/04/3mpvue/</url>
      
        <content type="html"><![CDATA[<p><img src="/2018/08/04/3mpvue/./wechat.png" width="400px"><br>&emsp;&emsp;å‰æ®µæ—¶é—´ï¼Œåœ¨ç¬¬ä¸€æ¬¡æ¥è§¦å°ç¨‹åºå¼€å‘çš„é¡¹ç›®ä¸­ï¼Œä½¿ç”¨äº†ç¾å›¢çš„å°ç¨‹åºæ¡†æ¶mpvueã€‚æœ¬æ–‡æ—¨åœ¨ç»™å¤§å®¶åˆ†äº«ä¸€äº›ï¼Œè‡ªå·±åœ¨ç¬¬ä¸€æ¬¡æ¥è§¦å°ç¨‹åºå¼€å‘æ—¶é‡åˆ°çš„ä¸€äº›å¸¸è§éœ€æ±‚çš„è§£å†³åŠæ³•ï¼Œä»¥åŠåœ¨ä½¿ç”¨mpvueæ¡†æ¶æ—¶è¸©è¿‡çš„å‘ï¼Œå¸Œæœ›èƒ½å¸®åŠ©åˆ°å¤§å®¶ã€‚</p><a id="more"></a><hr><h1 id="å°ç¨‹åºå¸¸è§éœ€æ±‚"><a href="#å°ç¨‹åºå¸¸è§éœ€æ±‚" class="headerlink" title="å°ç¨‹åºå¸¸è§éœ€æ±‚"></a>å°ç¨‹åºå¸¸è§éœ€æ±‚</h1><h2 id="ç™»å½•"><a href="#ç™»å½•" class="headerlink" title="ç™»å½•"></a>ç™»å½•</h2><blockquote><p>å¸¸ç”¨å‚æ•°<br>&emsp;&emsp;codeï¼šè°ƒç”¨wx.login() è·å–çš„ç”¨æˆ·ç™»å½•å‡­è¯ï¼ˆæœ‰æ•ˆæœŸ5minï¼‰<br>&emsp;&emsp;session_keyï¼šä¼šè¯å¯†é’¥<br>&emsp;&emsp;openidï¼šç”¨æˆ·å”¯ä¸€æ ‡è¯†<br>&emsp;&emsp;unionidï¼šç”¨æˆ·åœ¨å¼€æ”¾å¹³å°çš„å”¯ä¸€æ ‡è¯†ç¬¦</p></blockquote><blockquote><p>ç™»å½•æµç¨‹å›¾<br><img src="/2018/08/04/3mpvue/./api-login.jpg" width="500px"></p></blockquote><h3 id="æ™®é€šç™»å½•"><a href="#æ™®é€šç™»å½•" class="headerlink" title="æ™®é€šç™»å½•"></a>æ™®é€šç™»å½•</h3><ol><li>å°ç¨‹åºå®¢æˆ·ç«¯è°ƒç”¨wx.login()è·å–codeã€‚</li><li>å‘é€codeè‡³å¼€å‘è€…æœåŠ¡ç«¯ï¼Œå¼€å‘è€…åç«¯è°ƒç”¨<a href="https://api.weixin.qq.com/sns/jscode2session?appid=APPID&amp;secret=SECRET&amp;js_code=JSCODE&amp;grant_type=authorization_code" title="è·å–openidï¼Œsession_keyï¼ˆåç«¯è°ƒç”¨ï¼‰" target="_blank" rel="noopener">å¾®ä¿¡æœåŠ¡ç«¯æ¥å£</a>è·å–openidã€session_key(åœ¨æ»¡è¶³ä¸€å®š<a href="https://developers.weixin.qq.com/miniprogram/dev/api/unionID.html" title="UnionIDæœºåˆ¶è¯´æ˜" target="_blank" rel="noopener">æ¡ä»¶</a>ä¸‹è¿˜ä¼šè¿”å›UnionID)ã€‚</li><li>å¼€å‘è€…æœåŠ¡ç«¯è‡ªå®šä¹‰ç™»å½•çŠ¶æ€ï¼Œè¿”å›å°ç¨‹åºå®¢æˆ·ç«¯ä¸€ä¸ªtokenï¼Œå½“åšç”¨æˆ·çš„ç™»å½•çŠ¶æ€ã€‚</li><li>å°ç¨‹åºå®¢æˆ·ç«¯å­˜å‚¨tokenï¼Œåœ¨åç»­çš„ä¸šåŠ¡è¯·æ±‚æ¥å£ä¸­æºå¸¦tokenï¼Œä½œç”¨ç±»ä¼¼äºwebä¸­çš„cookieã€‚</li></ol><h3 id="ç»‘å®šæ‰‹æœºå·ç™»å½•"><a href="#ç»‘å®šæ‰‹æœºå·ç™»å½•" class="headerlink" title="ç»‘å®šæ‰‹æœºå·ç™»å½•"></a>ç»‘å®šæ‰‹æœºå·ç™»å½•</h3><p>&emsp;&emsp;ç»‘å®šæ‰‹æœºå·ç™»å½•å…¶å®å°±æ˜¯å°†ç”¨æˆ·æ‰‹æœºå·å’Œç”¨æˆ·çš„openidç»‘å®šèµ·æ¥å­˜å…¥æ•°æ®åº“ï¼Œå…¶å®ç™»å½•æµç¨‹ä¹Ÿæ˜¯å’Œæ™®é€šçš„ç™»å½•æµç¨‹ä¸€æ ·ï¼Œå”¯ä¸€çš„åŒºåˆ«å°±æ˜¯ï¼Œç¬¬ä¸€æ¬¡ç»‘å®šçš„æ—¶å€™ï¼Œéœ€è¦é¦–å…ˆè®©ç”¨æˆ·æˆæƒè·å–æ‰‹æœºå·ã€‚</p><h2 id="å¾®ä¿¡æˆæƒç”¨æˆ·æ‰‹æœºå·"><a href="#å¾®ä¿¡æˆæƒç”¨æˆ·æ‰‹æœºå·" class="headerlink" title="å¾®ä¿¡æˆæƒç”¨æˆ·æ‰‹æœºå·"></a>å¾®ä¿¡æˆæƒç”¨æˆ·æ‰‹æœºå·</h2><p>&emsp;&emsp;ç›¸å¯¹äºç”¨æˆ·å¤´åƒæ˜µç§°æ¥è¯´ï¼Œç”¨æˆ·æ‰‹æœºå·æ˜¯ä¸€ä¸ªæ›´éšç§çš„ç”¨æˆ·ä¿¡æ¯ï¼Œæ‰€ä»¥æ‰‹æœºå·çš„æˆæƒæ“ä½œä¼šç¹çä¸€äº›ï¼Œå¹¶ä¸”éœ€è¦åç«¯çš„æ”¯æŒã€‚<code>getPhoneNumber(OBJECT)</code>éœ€è¦ç”¨æˆ·ä¸»åŠ¨è§¦å‘æ‰èƒ½å‘èµ·è·å–æ‰‹æœºå·æ¥å£ï¼Œæ‰€ä»¥è¯¥åŠŸèƒ½ä¸ç”±APIæ¥è°ƒç”¨ï¼Œéœ€ç”¨<code>&lt;button&gt;</code>ç»„ä»¶çš„ç‚¹å‡»æ¥è§¦å‘ã€‚</p><ol><li>å°ç¨‹åºå®¢æˆ·ç«¯è°ƒç”¨wx.login()è·å–codeã€‚</li><li>è®¾ç½®<code>&lt;button&gt;</code>ç»„ä»¶<code>open-type</code>çš„å€¼è®¾ç½®ä¸º<code>getPhoneNumber</code>ï¼Œç”¨æˆ·ç‚¹å‡»å¹¶åŒæ„æˆæƒåï¼Œé€šè¿‡<code>bindgetphonenumber</code>äº‹ä»¶å›è°ƒè·å–åˆ°å¾®ä¿¡æœåŠ¡å™¨è¿”å›çš„åŠ å¯†æ•°æ®ã€‚</li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">open-type</span>=<span class="string">"getPhoneNumber"</span> <span class="attr">bindgetphonenumber</span>=<span class="string">"getPhoneNumber"</span>&gt;</span></span><br><span class="line">    å¾®ä¿¡æˆæƒç™»å½•</span><br><span class="line"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">getPhoneNumber(e) &#123;</span><br><span class="line">    <span class="keyword">if</span> (e.mp.detail.encryptedData) &#123;</span><br><span class="line">        <span class="comment">// æˆæƒæˆåŠŸ å°†encryptedDataå’Œivå‘é€ç»™å¼€å‘è€…æœåŠ¡ç«¯</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// æ‹’ç»æ”¶å–ï¼Œåšç›¸åº”çš„é€»è¾‘å¤„ç†</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>å°ç¨‹åºå®¢æˆ·ç«¯å°†åŠ å¯†æ•°æ®å’Œcodeä¸€åŒå‘é€ç»™å¼€å‘è€…æœåŠ¡å™¨ç«¯ã€‚</li><li>å¼€å‘è€…æœåŠ¡ç«¯å°†ï¼Œæ ¹æ®codeè·å–openidï¼Œå’Œé€šè¿‡åŠ å¯†æ•°æ®ã€ä»¥åŠå¾®ä¿¡æä¾›çš„<a href="https://developers.weixin.qq.com/miniprogram/dev/api/signature.html#wxchecksessionobject" title="åŠ å¯†æ•°æ®è§£å¯†ç®—æ³•" target="_blank" rel="noopener">åŠ å¯†æ•°æ®è§£å¯†ç®—æ³•</a>å¾—åˆ°çš„ç”¨æˆ·æ‰‹æœºå·ç»‘å®šåœ¨ä¸€èµ·æ’å…¥æ•°æ®åº“ã€‚</li></ol><p>æ³¨æ„ï¼šç›®å‰è¯¥æ¥å£é’ˆå¯¹éä¸ªäººå¼€å‘è€…ï¼Œä¸”å®Œæˆäº†è®¤è¯çš„å°ç¨‹åºå¼€æ”¾ã€‚éœ€è°¨æ…ä½¿ç”¨ï¼Œè‹¥ç”¨æˆ·ä¸¾æŠ¥è¾ƒå¤šæˆ–è¢«å‘ç°åœ¨ä¸å¿…è¦åœºæ™¯ä¸‹ä½¿ç”¨ï¼Œå¾®ä¿¡æœ‰æƒæ°¸ä¹…å›æ”¶è¯¥å°ç¨‹åºçš„è¯¥æ¥å£æƒé™ã€‚</p><h2 id="å¾®ä¿¡æˆæƒç”¨æˆ·ä¿¡æ¯"><a href="#å¾®ä¿¡æˆæƒç”¨æˆ·ä¿¡æ¯" class="headerlink" title="å¾®ä¿¡æˆæƒç”¨æˆ·ä¿¡æ¯"></a>å¾®ä¿¡æˆæƒç”¨æˆ·ä¿¡æ¯</h2><p>&emsp;&emsp;å¾®ä¿¡å°ç¨‹åºå¯ä»¥é€šè¿‡è°ƒç”¨<code>wx.getUserInfo(OBJECT)</code>æ¥è·å–ç”¨æˆ·å¤´åƒï¼Œæ˜µç§°ç­‰åŸºæœ¬çš„å¾®ä¿¡è´¦å·ä¿¡æ¯ã€‚è¿™ä¸ªåŠŸèƒ½å¾ˆå¸¸è§ï¼Œä¸€èˆ¬æ˜¯ç”¨äºå±•ç¤ºç”¨æˆ·çš„å¾®ä¿¡å¤´åƒå’Œæ˜µç§°ã€‚<br>&emsp;&emsp;ä½†æœ‰ä¸€ç‚¹è¦æ³¨æ„çš„å°±æ˜¯ï¼Œæœ€æ–°çš„å°ç¨‹åºapiä¸­ï¼Œä¸æ”¯æŒç›´æ¥å¼•å¯¼ç”¨æˆ·æˆæƒç”¨æˆ·ä¿¡æ¯äº†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰æˆæƒè¿‡ç”¨æˆ·ä¿¡æ¯çš„è¯ï¼Œç›´æ¥è°ƒç”¨<code>wx.getUserInfo()</code>å°†ä¸ä¼šå†å¼¹å‡ºæˆæƒå¼¹çª—äº†ã€‚å¾®ä¿¡æ¨èçš„æ–¹æ³•æ˜¯ï¼Œè®¾ç½®<code>&lt;button&gt;</code>ç»„ä»¶çš„<code>open-type</code>å±æ€§ä¸º<code>getUserinfo</code>ï¼Œå¼•å¯¼ç”¨æˆ·ä¸»åŠ¨çš„ç‚¹å‡»æŒ‰é’®æ¥è¿›è¡Œæˆæƒæ“ä½œã€‚</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">open-type</span>=<span class="string">"getUserInfo"</span> <span class="attr">bindgetuserinfo</span>=<span class="string">"onGotUserInfo"</span>&gt;</span></span><br><span class="line">    åˆ†äº«å–œæ‚¦ç»™å¥½å‹</span><br><span class="line"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><p>&emsp;&emsp;è¿™ä¸ªå˜åŒ–ç›®å‰å¯¹å·²å‘å¸ƒçš„å°ç¨‹åºæš‚æ—¶æ²¡æœ‰å½±å“ï¼Œä½†æ˜¯ã€å¼€å‘ç‰ˆã€‘å’Œã€ä½“éªŒç‰ˆã€‘å°ç¨‹åºï¼Œå·²ç»æœ‰äº†é™åˆ¶ã€‚<strong><code>æ‰€ä»¥ï¼Œå¦‚æœå°ç¨‹åºéœ€è¦æˆæƒç”¨æˆ·åŸºæœ¬ä¿¡æ¯ï¼Œåœ¨è®¾è®¡æ—¶ï¼Œéœ€è¦è®¾è®¡ä¸€ä¸ªç”¨æˆ·æŒ‰é’®ç‚¹å‡»çš„äº¤äº’ã€‚</code></strong></p><h2 id="ä¸‹æ‹‰åˆ·æ–°ã€ä¸Šæ‹‰åŠ è½½"><a href="#ä¸‹æ‹‰åˆ·æ–°ã€ä¸Šæ‹‰åŠ è½½" class="headerlink" title="ä¸‹æ‹‰åˆ·æ–°ã€ä¸Šæ‹‰åŠ è½½"></a>ä¸‹æ‹‰åˆ·æ–°ã€ä¸Šæ‹‰åŠ è½½</h2><blockquote><p>å°ç¨‹åºè‡ªå¸¦ä¸‹æ‹‰åˆ·æ–°ï¼š<br>&emsp;&emsp;åœ¨é¡µé¢jsoné…ç½®ä¸­å¼€å¯<code>enablePullDownRefresh</code>é€‰é¡¹<br>ç„¶ååœ¨å‡½æ•°<code>onPullDownRefresh()</code>ä¸­ç›‘å¬ç”¨æˆ·ä¸‹æ‹‰åˆ·æ–°äº‹ä»¶ï¼Œå¤„ç†å®Œåˆ·æ–°æ•°æ®åå†ç”¨<code>wx.stopPullDownRefresh()</code>åœæ­¢å½“å‰é¡µé¢çš„ä¸‹æ‹‰åˆ·æ–°ã€‚</p></blockquote><blockquote><p>scroll-viewä¸‹æ‹‰åˆ·æ–°<br>&emsp;&emsp;ä½†æ˜¯å¦‚æœå½“å‰é¡µé¢ä½¿ç”¨äº†<code>scroll-view</code>ç»„ä»¶ï¼Œè¿™ç§è‡ªå¸¦çš„ä¸‹æ‹‰åˆ·æ–°æ˜¯ä¸èƒ½ç”¨çš„ã€‚è¿™ç§æƒ…å†µä¸‹å°±åªèƒ½é€šè¿‡ç›‘å¬<code>scroll-view</code>ç»„ä»¶çš„<code>bindscrollã€ä»¥åŠbindtouchendã€bindtouchstart</code>ç­‰äº‹ä»¶æ¥æ‰‹åŠ¨å®ç°ä¸‹æ‹‰åˆ·æ–°ã€‚</p></blockquote><h2 id="å¾®ä¿¡åˆ†äº«ï¼ˆç¾¤-ç§èŠï¼‰"><a href="#å¾®ä¿¡åˆ†äº«ï¼ˆç¾¤-ç§èŠï¼‰" class="headerlink" title="å¾®ä¿¡åˆ†äº«ï¼ˆç¾¤/ç§èŠï¼‰"></a>å¾®ä¿¡åˆ†äº«ï¼ˆç¾¤/ç§èŠï¼‰</h2><p>&emsp;&emsp;åˆ†äº«åŠŸèƒ½åº”è¯¥å¯ä»¥è¯´æ˜¯æ¯æ¬¾å°ç¨‹åºæ¯”ä¸å¯å°‘åŠŸèƒ½äº†ï¼Œå°ç¨‹åºæ”¯æŒåˆ†äº«åˆ°èŠå¤©å›è¯ï¼Œä¸æ”¯æŒç›´æ¥åˆ†äº«åˆ°æœ‹å‹åœˆã€‚å°ç¨‹åºçš„åˆ†äº«æœ‰å‡ ä¸ªç‰¹ç‚¹ï¼šé¡µé¢å¯é…ç½®ã€æ–‡å­—/å›¾ç‰‡å¯é…ç½®ã€å¯æºå¸¦å‚æ•°ã€‚</p><p>&emsp;&emsp;é¦–å…ˆï¼Œè®¾ç½®<code>&lt;button&gt;</code>ç»„ä»¶çš„<code>open-type</code>å±æ€§ä¸º<code>share</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">open-type</span>=<span class="string">"share"</span>&gt;</span>åˆ†äº«è½¬å‘<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><p>&emsp;&emsp;ç„¶åé€šè¿‡<code>onShareAppMessage(Object)</code>äº‹ä»¶æ¥ç›‘å¬ç”¨æˆ·ç‚¹å‡»è½¬å‘æŒ‰é’®çš„äº‹ä»¶ï¼Œå¹¶è‡ªå®šä¹‰è½¬å‘çš„å†…å®¹ã€‚ï¼ˆå¦‚æœå½“å‰é¡µé¢æ²¡æœ‰å®šä¹‰æ­¤äº‹ä»¶ï¼Œåˆ™ç‚¹å‡»åæ— æ•ˆæœï¼‰<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Page(&#123;</span><br><span class="line">    onShareAppMessage: <span class="function"><span class="keyword">function</span> (<span class="params">res</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (res.from === <span class="string">'button'</span>) &#123;</span><br><span class="line">            <span class="comment">// æ¥è‡ªé¡µé¢å†…è½¬å‘æŒ‰é’® button || menu</span></span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                title: <span class="string">'è‡ªå®šä¹‰è½¬å‘æ ‡é¢˜'</span>,</span><br><span class="line">                path: <span class="string">'/page/sharepage?id=123'</span>,</span><br><span class="line">                imageUrl: <span class="string">'xxx.png'</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                title: <span class="string">'è‡ªå®šä¹‰è½¬å‘æ ‡é¢˜'</span>,</span><br><span class="line">                path: <span class="string">'/page/sharepage?id=123'</span>,</span><br><span class="line">                imageUrl: <span class="string">'xxx.png'</span>,</span><br><span class="line">                success: <span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">                    <span class="built_in">console</span>.log(<span class="string">'è½¬å‘æˆåŠŸ~'</span>)</span><br><span class="line">                &#125;,</span><br><span class="line">                fail: <span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">                    <span class="built_in">console</span>.log(<span class="string">'è½¬å‘å¤±è´¥'</span>, error)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p><p>&emsp;&emsp;æˆ‘ä»¬çœ‹åˆ°åˆ†äº«æ—¶ï¼Œå¯ä»¥ä¼ å…¥å‚æ•°è‡ªå®šä¹‰åˆ†äº«å¡ç‰‡çš„æ ‡é¢˜ï¼Œå›¾ç‰‡ä»¥åŠä»å¡ç‰‡è¿›å…¥æ—¶è·³è½¬çš„é¡µé¢è·¯å¾„ã€‚åœ¨å®˜æ–¹æ–‡æ¡£ä¸Šæ²¡æœ‰çœ‹åˆ°æœ‰å†™å…³äºåˆ†äº«æˆåŠŸæˆ–è€…å¤±è´¥çš„å›è°ƒï¼Œä½†æˆ‘è¯•äº†ä¸€ä¸‹ï¼Œæ˜¯æœ‰çš„ï¼Œå¯èƒ½æ˜¯æ–‡æ¡£ä¸Šæ¼äº†ã€‚è¿™ä¸¤ä¸ªå›è°ƒå¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨åˆ†äº«æ“ä½œç»“æŸåï¼Œæ ¹æ®åˆ†äº«ç»“æœåšä¸€äº›ä¸åŒçš„æ“ä½œå’Œå¤„ç†ã€‚</p><p>&emsp;&emsp;å…¶æ¬¡ï¼Œé€šè¿‡è®¾ç½® <code>withShareTicket</code> å¯ä»¥è·å–æ›´å¤šè½¬å‘ä¿¡æ¯ã€‚åœ¨ç¾¤èŠä¸­æ‰“å¼€åˆ†äº«å¡ç‰‡æ—¶ï¼Œå¯ä»¥å–åˆ°<code>shareTicket</code>ï¼Œé€šè¿‡è°ƒç”¨ <code>wx.getShareInfo()</code> æ¥å£ï¼Œä¼ å…¥ <code>shareTicket</code> å¯ä»¥è·å–åˆ°è½¬å‘ä¿¡æ¯ã€‚<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ps: å¦‚æœè®¾ç½®äº†withShareTicket: trueï¼Œåœ¨èŠå¤©å¯¹è¯ä¸­ï¼Œé•¿æŒ‰åˆ†äº«å‘ç‰‡æ˜¯ä¸å¯ä»¥ç›´æ¥äºŒæ¬¡è½¬å‘çš„ã€‚</span></span><br><span class="line">wx.showShareMenu(&#123;</span><br><span class="line">    withShareTicket: <span class="literal">true</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p><p>&emsp;&emsp;ä½†æ˜¯å¦‚æœé‡åˆ°ä¸€ä¸ªéœ€æ±‚ï¼Œè¦è®©ä½ åŒºåˆ«æ˜¯åˆ†äº«åˆ°ç¾¤è¿˜æ˜¯åˆ†äº«åˆ°ç§èŠå›è¯ï¼Œæ€ä¹ˆåŠå‘¢ï¼Ÿå…¶å®ï¼Œåœ¨åˆ†äº«çš„è¿™ä¸€æ­¥ï¼Œæ˜¯æ²¡åŠæ³•åˆ¤æ–­ç”¨æˆ·åˆ°åº•åˆ†äº«ç»™è°çš„ï¼Œæ‰€ä»¥åªèƒ½åœ¨è¿›å…¥å°ç¨‹åºçš„æ—¶å€™ï¼Œæ ¹æ®åœºæ™¯å€¼æ¥åˆ¤æ–­äº†ã€‚</p><h2 id="åœºæ™¯å€¼"><a href="#åœºæ™¯å€¼" class="headerlink" title="åœºæ™¯å€¼"></a>åœºæ™¯å€¼</h2><p>&emsp;&emsp;<a href="https://developers.weixin.qq.com/miniprogram/en/dev/framework/app-service/scene.html?search-key=%E5%9C%BA%E6%99%AF%E5%80%BC" title="å°ç¨‹åºåœºæ™¯å€¼" target="_blank" rel="noopener">åœºæ™¯å€¼</a>å¯ä»¥ç”¨æ¥åˆ¤æ–­å°ç¨‹åºæ˜¯ä»å“ªä¸ªåœºæ™¯ä¸‹è¢«æ‰“å¼€çš„ã€‚åœºæ™¯å€¼å¯ä»¥åœ¨ App çš„ <code>onlaunch</code> å’Œ <code>onshow</code> ä¸­è·å–åˆ°ã€‚æ ¹æ®ä¸åŒçš„åœºæ™¯å€¼ï¼Œå¯ä»¥çŸ¥é“ç”¨æˆ·æ˜¯ä»ç¾¤èŠè¿˜æ˜¯ç§èŠå¯¹è¯ä¸­è¿›å…¥å°ç¨‹åºï¼Œä»è€Œå¯ä»¥åšä¸€äº›ä¸åŒçš„é€»è¾‘å¤„ç†ã€‚</p><h2 id="å°ç¨‹åºäºŒç»´ç ç”Ÿæˆ"><a href="#å°ç¨‹åºäºŒç»´ç ç”Ÿæˆ" class="headerlink" title="å°ç¨‹åºäºŒç»´ç ç”Ÿæˆ"></a>å°ç¨‹åºäºŒç»´ç ç”Ÿæˆ</h2><p>&emsp;&emsp;å°ç¨‹åºäºŒç»´ç çš„ç”Ÿæˆå®˜æ–¹æä¾›äº†ä¸‰ç§<a href="https://developers.weixin.qq.com/miniprogram/dev/api/qrcode.html?search-key=%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%A0%81" target="_blank" rel="noopener">æ¥å£</a>ï¼Œåˆ†åˆ«æœ‰ä¸åŒçš„ç‰¹ç‚¹ï¼Œå¯ä»¥æ ¹æ®éœ€æ±‚æ¥é€‰æ‹©æ¥å£ã€‚å®˜æ–¹çš„æè¿°æ˜¯ï¼š</p><blockquote><p>Aæ¥å£:ç”Ÿæˆå°ç¨‹åºç ï¼Œå¯æ¥å—pathå‚æ•°è¾ƒé•¿ï¼Œç”Ÿæˆä¸ªæ•°å—é™ã€‚<br>Bæ¥å£:ç”Ÿæˆå°ç¨‹åºç ï¼Œå¯æ¥å—é¡µé¢å‚æ•°è¾ƒçŸ­ï¼Œç”Ÿæˆä¸ªæ•°ä¸å—é™ã€‚<br>Cæ¥å£:ç”ŸæˆäºŒç»´ç ï¼Œå¯æ¥å—pathå‚æ•°è¾ƒé•¿ï¼Œç”Ÿæˆä¸ªæ•°å—é™ã€‚</p></blockquote><p>&emsp;&emsp;ç”ŸæˆäºŒç»´ç çš„æ“ä½œä¸€èˆ¬æ˜¯å¼€å‘è€…æœåŠ¡ç«¯æ¥å®Œæˆçš„ï¼Œå¾®ä¿¡å®˜æ–¹æ¨èç”Ÿæˆå¹¶ä½¿ç”¨å°ç¨‹åºç ï¼Œè€Œå…¶ä¸­Bæ¥å£åˆæ˜¯æœ€å¸¸ç”¨çš„ï¼Œå› ä¸ºBæ¥å£ç”Ÿæˆçš„å°ç¨‹åºç æ°¸ä¹…æœ‰æ•ˆä¸”ä¸é™åˆ¶ä¸ªæ•°ã€‚<br>&emsp;&emsp;éœ€è¦æ³¨æ„çš„å‡ ç‚¹:</p><ul><li>Bæ¥å£çš„è·¯å¾„ä¸æºå¸¦å‚æ•°ï¼Œå‚æ•°éƒ½éœ€è¦æ”¾åœ¨ <code>scene</code> å­—æ®µé‡Œï¼Œåœ¨ <code>onLoad()</code> ä¸­å¯ä»¥è·å–åˆ°äºŒç»´ç ä¸­çš„ <code>scene</code> å­—æ®µçš„å€¼</li><li><code>page</code> å‚æ•°æŒ‡å®šçš„è·¯å¾„å¿…é¡»æ˜¯å·²ç»å‘å¸ƒçš„å°ç¨‹åºå­˜åœ¨çš„é¡µé¢ï¼Œå¦åˆ™æŠ¥é”™</li><li>è°ƒè¯•é˜¶æ®µå¯ä»¥ä½¿ç”¨å¼€å‘å·¥å…·çš„æ¡ä»¶ç¼–è¯‘è‡ªå®šä¹‰å‚æ•° <code>scene=xxxx</code> è¿›è¡Œæ¨¡æ‹Ÿ</li></ul><p><img src="/2018/08/04/3mpvue/./compile-mode.jpg" width="600px"></p><h2 id="å…¶ä»–å°é—®é¢˜"><a href="#å…¶ä»–å°é—®é¢˜" class="headerlink" title="å…¶ä»–å°é—®é¢˜"></a>å…¶ä»–å°é—®é¢˜</h2><h3 id="tabBar"><a href="#tabBar" class="headerlink" title="tabBar"></a>tabBar</h3><p>å¦‚æœä½¿ç”¨å°ç¨‹åºæä¾›çš„è‡ªå¸¦çš„tabæ ï¼Œæ ¹æ®å®˜æ–¹æ–‡æ¡£è¿›è¡Œé…ç½®å³å¯ï¼Œtabæ çš„é¡µé¢é…ç½®æœ€å°‘2ä¸ªã€æœ€å¤š5ä¸ªã€‚</p><blockquote><p>å”¯ä¸€éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼šå°ç¨‹åºçš„é¦–é¡µå¿…é¡»é…ç½®åœ¨è¿™å‡ ä¸ªtabæ ä¸­ï¼Œå¦åˆ™å°±ä¸èƒ½ä½¿ç”¨å®˜æ–¹çš„tabBarï¼Œè€Œåªèƒ½æ‰‹å†™tabBarï¼Œè¿™ç‚¹åœ¨è®¾è®¡çš„æ—¶å€™éœ€è¦æ³¨æ„ä¸€ä¸‹ã€‚</p></blockquote><p>å…³äºæ‰‹åŠ¨å®ç°tabBarï¼Œé‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯åœ¨åˆ‡æ¢tabæ ‡ç­¾æ—¶ï¼Œä¼šç”¨ <code>wx.redirectTo()</code> è¿›è¡Œæ•´ä¸ªpageé¡µé¢ä¹‹é—´çš„è·³è½¬ï¼Œæœ‰çš„æ—¶å€™åº•éƒ¨çš„tabæ å°±ä¼šå‡ºç°é—ªçƒçš„é—®é¢˜ï¼Œæš‚æ—¶æ²¡æƒ³åˆ°æ›´å¥½çš„æ–¹æ¡ˆã€‚</p><h3 id="å›¾ç‰‡-å­—ä½“çš„å¼•ç”¨"><a href="#å›¾ç‰‡-å­—ä½“çš„å¼•ç”¨" class="headerlink" title="å›¾ç‰‡/å­—ä½“çš„å¼•ç”¨"></a>å›¾ç‰‡/å­—ä½“çš„å¼•ç”¨</h3><p>&emsp;&emsp;ç”±äºå°ç¨‹åºä»£ç åŒ…å¤§å°ä¸Šé™æ˜¯2Mï¼Œæ‰€ä»¥å»ºè®®ä¸è¦å¼•ç”¨æœ¬åœ°å›¾ç‰‡å­—ä½“ï¼Œå…¨éƒ¨æ”¹æˆå¼•ç”¨ç½‘ç»œèµ„æºï¼Œä¹Ÿä¸è¦é™æ€èµ„æºæ‰“åŒ…åˆ°å°ç¨‹åºçš„ä»£ç åŒ…é‡Œã€‚</p><h3 id="WXSS"><a href="#WXSS" class="headerlink" title="WXSS"></a>WXSS</h3><ul><li><p>WXSSä¸­background-imageåªæ”¯æŒç½‘ç»œå›¾ç‰‡ï¼Œæˆ–è€…base64æ ¼å¼çš„å›¾ç‰‡ã€‚</p></li><li><p>æ–°å¢äº†å°ºå¯¸å•ä½rpxï¼Œå¼€å‘è€…ä¸éœ€è¦è€ƒè™‘è®¾é…é—®é¢˜ï¼Œå…¨éƒ½äº¤ç»™å°ç¨‹åºåº•å±‚æ¥æ¢ç®—ã€‚</p></li><li><p>WXSSä¸å†æ”¯æŒåª’ä½“æŸ¥è¯¢ï¼Œé€šè¿‡ <code>wx.getSystemInfo()</code> æ¥è·å–è®¾å¤‡ä¿¡æ¯ã€‚</p></li></ul><h1 id="mpvue"><a href="#mpvue" class="headerlink" title="mpvue"></a>mpvue</h1><p><br><a href="http://mpvue.com/mpvue/" target="_blank" rel="noopener">mpvue</a> ç»§æ‰¿è‡ª <code>Vue.js</code>ï¼Œå…¶æŠ€æœ¯è§„èŒƒå’Œè¯­æ³•ç‰¹ç‚¹ä¸ <code>Vue.js</code> ä¿æŒä¸€è‡´ã€‚</p><h2 id="å¼€å§‹é¡¹ç›®"><a href="#å¼€å§‹é¡¹ç›®" class="headerlink" title="å¼€å§‹é¡¹ç›®"></a>å¼€å§‹é¡¹ç›®</h2><ol><li><p>æ–°å»ºé¡¹ç›®æ¨¡æ¿</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªåŸºäº mpvue-quickstart æ¨¡æ¿çš„æ–°é¡¹ç›®</span></span><br><span class="line">vue init mpvue/mpvue-quickstart my-project</span><br><span class="line">npm install</span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure></li><li><p>å¾®ä¿¡å¼€å‘è€…å·¥å…·ä¸­é€‰æ‹©é¡¹ç›®distç›®å½•</p></li></ol><h2 id="è¸©å‘æ€»ç»“"><a href="#è¸©å‘æ€»ç»“" class="headerlink" title="è¸©å‘æ€»ç»“"></a>è¸©å‘æ€»ç»“</h2><ul><li><p>æ–°å»ºpagesåï¼Œéœ€è¦é‡æ–° npm run dev ä¸€ä¸‹ã€‚</p></li><li><p>mpvue ä¸­ä½¿ç”¨ vuex: </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Vue.prototype.$store = store</span><br></pre></td></tr></table></figure></li><li><p>ä¸æ”¯æŒvue-router</p></li><li><p>åœ¨å¼•ç”¨å­ç»„ä»¶æ—¶ï¼Œä¸æ”¯æŒåœ¨ç»„ä»¶ä¸Šå®šä¹‰v-showï¼Œåªèƒ½ä½¿ç”¨v-ifæ›¿ä»£ã€‚</p></li><li><p>ä¸æ”¯æŒç»„ä»¶ä¸Šå®šä¹‰classï¼Œstyleç­‰æ ·å¼å±æ€§ï¼Œå»ºè®®å†™åœ¨å†…éƒ¨é¡¶çº§å…ƒç´ ä¸Šã€‚</p></li><li><p>å°ç¨‹åºåœ¨ <code>page</code> <code>onLoad</code> æ—¶ä¼ é€’çš„ <code>options</code> , å¯ä»¥åœ¨æ‰€æœ‰é¡µé¢çš„ç»„ä»¶å†…é€šè¿‡ <code>this.$root.$mp.query</code> è·å–åˆ°ã€‚</p></li><li><p>å°ç¨‹åºåœ¨ <code>app</code> <code>onLaunch/onShow</code> æ—¶ä¼ é€’çš„ <code>options</code> , å¯ä»¥åœ¨æ‰€æœ‰é¡µé¢çš„ç»„ä»¶å†…é€šè¿‡ <code>this.$root.$mp.appOptions</code> è·å–åˆ°ã€‚</p></li><li><p>ä¸æ”¯æŒtransitionè¿‡æ¸¡</p></li><li><p>è®¾ç½®æ¨ªå‘æ»‘åŠ¨ï¼š</p><blockquote><p>è®¾ç½®æ¨ªå‘æ»‘åŠ¨ scroll-x=â€trueâ€;<br>scroll-viewéœ€è¦è®¾ç½®å®½åº¦ï¼Œå¹¶ä¸”è®¾ç½®white-spaceå±æ€§ä¸ºnowrap;<br>itemè®¾ç½®display: inline-blockå±æ€§;</p></blockquote></li><li><p>å¼•ç”¨ç½‘ç»œå­—ä½“æ–‡ä»¶æ—¶ï¼Œå¼€å‘å·¥å…·ä¸Šå¯ä»¥æ”¯æŒhttpã€ä½†çœŸæœºä¸Šåªèƒ½å¼•ç”¨httpsæ–‡ä»¶ã€‚</p></li><li><p>å®šä¹‰vueç»„ä»¶åæ—¶éœ€è¦æ³¨æ„ï¼Œ<a href="http://mpvue.com/qa/#_3" target="_blank" rel="noopener">ä¸€äº›ä¿ç•™å…³é”®å­—</a>ï¼Œæš‚ä¸æ”¯æŒä½œä¸ºç»„ä»¶åç§°ã€‚ï¼ˆè‡ªå®šä¹‰tabbaræ—¶é‡åˆ°çš„å¤§å‘ï¼ï¼ï¼ï¼‰</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> share </category>
          
      </categories>
      
      
        <tags>
            
            <tag> share </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‰ç«¯æ•°æ®Mock---Express + Mockjs</title>
      <link href="/2018/04/24/2fe-mock/"/>
      <url>/2018/04/24/2fe-mock/</url>
      
        <content type="html"><![CDATA[<p><img src="/2018/04/24/2fe-mock/./mock.jpg" width="400px"><br>å‰ç«¯å¼€å‘ä¸­ï¼Œæ•°æ®mockæ˜¯ä¸€ä¸ªå¯å¤§å¯å°ã€å¯ç¹å¯ç®€çš„å¼€å‘æµç¨‹ï¼Œå®Œæ•´çš„å‰ç«¯æ•°æ®mockæœ€å¤§çš„ç›®çš„æ˜¯æ—¨åœ¨<strong>é™ä½å‰åç«¯æ¥å£è”è°ƒçš„æˆæœ¬</strong>ã€‚<br>æœ¬æ–‡ç»™å¤§å®¶åˆ†äº«è‡ªå·±åœ¨å¼€å‘ä¸­çš„mockæ•°æ®çš„æ–¹æ³•ï¼Œå†…å®¹ç®€å•æ˜“æ‡‚ï¼Œæ¬¢è¿å„ä½å¤§ä½¬æ‰¹è¯„æŒ‡æ­£ã€‚</p><a id="more"></a><hr><h1 id="å‰ç«¯æ•°æ®æ¨¡æ‹Ÿ"><a href="#å‰ç«¯æ•°æ®æ¨¡æ‹Ÿ" class="headerlink" title="å‰ç«¯æ•°æ®æ¨¡æ‹Ÿ"></a>å‰ç«¯æ•°æ®æ¨¡æ‹Ÿ</h1><p>åœ¨å‰åç«¯åˆ†ç¦»çš„å¼€å‘æ¨¡å¼ä¸­ï¼Œå‰åç«¯é€šå¸¸æ˜¯å…ˆçº¦å®šå¥½æ¥å£çš„è¾“å…¥è¾“å‡ºä»¥åŠæ ¼å¼ï¼Œç„¶åå„è‡ªæŒ‰ç…§æ¥å£æ ¼å¼æ¥è¿›è¡ŒåŒæ­¥çš„å¼€å‘ï¼Œç­‰åç«¯æ¥å£å®ç°å®Œæˆï¼Œå‰ç«¯æ•°æ®é€»è¾‘å¤„ç†ä¹Ÿå®Œæˆåï¼Œå†è¿›è¡Œå‰åç«¯è”è°ƒã€‚</p><p>æ‰€ä»¥å½“é¡¹ç›®æ¥å£æ¯”è¾ƒå¤šï¼Œè€Œä¸”åç«¯æ¥å£è¿˜æœªå…¨éƒ¨å®ç°çš„æ—¶å€™ï¼Œå‰ç«¯éœ€è¦å¯¹æ¥å£æ•°æ®è¿›è¡Œæ¨¡æ‹Ÿï¼Œä»¥ä¾¿ç¼–å†™å‰ç«¯çš„äº¤äº’é€»è¾‘ç­‰åŠŸèƒ½æ€§çš„ä»£ç ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦å°½å¯èƒ½å…¨é¢åœ°æ¨¡æ‹Ÿæ¥å£æ•°æ®çš„å„ç§æƒ…å†µï¼Œè¿™æ ·çš„è¯ï¼Œå½“åç«¯æ¥å£å…¨éƒ¨å®ç°åï¼Œå¯ä»¥é™ä½å‰åç«¯çš„è”è°ƒæˆæœ¬ã€‚</p><h1 id="MockJs"><a href="#MockJs" class="headerlink" title="MockJs"></a>MockJs</h1><p>mockJsæ˜¯ä¸€ä¸ªå¯ä»¥æ¨¡æ‹Ÿæ¥å£æ•°æ®çš„æ’ä»¶ï¼Œå®ƒå¯ä»¥å¾ˆæ–¹ä¾¿åœ°æ¨¡æ‹Ÿå„ç§ç±»å‹çš„æ¥å£æ•°æ®ï¼Œè€Œä¸”æ¨¡æ‹Ÿçš„æ•°æ®æ—¶å¯éšæœºçš„ã€‚è™½ç„¶è¿™ä¸ªåº“æœ‰ä¸å°‘çš„å‘ç‚¹ï¼ˆåé¢ä¼šè®²ï¼‰è€Œä¸”è²Œä¼¼å·²ç»å¾ˆä¹…æ²¡æœ‰ç»´æŠ¤äº†ï¼Œä½†æ˜¯ä»…ä»…ç”¨æ¥åšæ•°æ®æ¨¡æ‹Ÿè¿˜æ˜¯æŒºæ–¹ä¾¿çš„ï¼Œé¦–å…ˆï¼Œéœ€è¦å®‰è£…ä¸€ä¸‹ï¼š</p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install mockjs --save-dev</span><br></pre></td></tr></table></figure><h2 id="ç®€å•ç”¨æ³•"><a href="#ç®€å•ç”¨æ³•" class="headerlink" title="ç®€å•ç”¨æ³•"></a>ç®€å•ç”¨æ³•</h2><p>é¦–å…ˆï¼Œæ–°å»ºä¸€ä¸ª<code>mock.js</code>æ–‡ä»¶ï¼Œæ¨¡æ‹Ÿä¸€ä¸ªç®€å•çš„æ¥å£ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> Mock = <span class="built_in">require</span>(<span class="string">'mockjs'</span>)</span><br><span class="line">Mock.mock(<span class="string">'//mock/base/getUserInfoFromPC'</span>, &#123;</span><br><span class="line">    <span class="string">'code'</span>: <span class="number">200</span>,</span><br><span class="line">    <span class="string">'data'</span>: &#123;</span><br><span class="line">        <span class="string">'nickName'</span>: <span class="string">'alexixiang'</span>,</span><br><span class="line">        <span class="string">'id'</span>: <span class="number">1707000766</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>ä¸Šé¢çš„ä»£ç å°±æ¨¡æ‹Ÿäº†ä¸€ä¸ªæ¥å£åä¸º<code>/base/getUserInfoFromPC</code>çš„æ¥å£ã€‚æˆ‘ä¸€èˆ¬ä¼šåœ¨åç«¯å®šä¹‰çš„çœŸå®æ¥å£å‰é¢åŠ ä¸€ä¸ªæ ‡å¿—ä½ï¼Œè¿™é‡Œæ˜¯åŠ ä¸€ä¸ª<code>mock</code>ï¼Œç›®çš„æ˜¯æ–¹ä¾¿åŒºåˆ†ä»€ä¹ˆæ—¶å€™å–è‡ªå·±æ¨¡æ‹Ÿçš„æ•°æ®ï¼Œæ—¶å€™å–åç«¯çœŸå®æ¥å£çš„æ•°æ®ã€‚</p><p>ç„¶åï¼Œåœ¨é¡¹ç›®çš„è¯·æ±‚å°è£…çš„æ–‡ä»¶ä¸­æ·»åŠ ä¸‹åˆ—ä»£ç ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> mock = <span class="literal">true</span> <span class="comment">// true</span></span><br><span class="line"><span class="keyword">let</span> baseURL = mock ? <span class="string">'//mock/'</span> : <span class="string">`//activity.f***s.cn/`</span></span><br></pre></td></tr></table></figure><p>åœ¨é¡¹ç›®å‰åç«¯ç‹¬ç«‹å¼€å‘é˜¶æ®µï¼Œè®¾ç½®<code>mock</code>ä¸ºtrueï¼Œæ‰€æœ‰çš„è¯·æ±‚éƒ½ä¼šä»¥<code>//mock</code>å¼€å¤´ï¼Œåˆšå¥½å’Œæˆ‘ä»¬<code>mock.js</code>ä¸­è®¾ç½®çš„ä¸€ä¸€å¯¹åº”ï¼Œmockjsä¼šæ‹¦æˆªåˆ°æ‰€æœ‰<code>//mock</code>å¼€å¤´çš„è¯·æ±‚ï¼Œå¹¶ä¸”è¿”å›å®ƒè‡ªå·±æ¨¡æ‹Ÿçš„æ•°æ®ã€‚ç­‰åˆ°å‰åç«¯è”è°ƒçš„æ—¶å€™ï¼Œå†è®¾ç½®ä¸ºfalseï¼Œç„¶åæ‰€æœ‰çš„è¯·æ±‚å°±ä¼šæŒ‰ç…§çœŸå®çš„åç«¯æ¥å£åœ°å€æ¥å‘é€è¯·æ±‚ã€‚</p><h2 id="éšæœºæ•°æ®"><a href="#éšæœºæ•°æ®" class="headerlink" title="éšæœºæ•°æ®"></a>éšæœºæ•°æ®</h2><p>mockjså¯ä»¥éšæœºåœ°æ¨¡æ‹Ÿå„ç±»çš„æ•°æ®ï¼Œå¸¸ç”¨çš„åŒ…æ‹¬æ—¥æœŸæ—¶é—´ã€åŸå¸‚çœä»½ã€å§“åã€é¢œè‰²ã€å…³é”®å­—ã€emailã€å¥å­æ®µè½ã€ç”šè‡³å¯ä»¥æŒ‰å°ºå¯¸æ¨¡æ‹Ÿå›¾ç‰‡ã€å¸¦æ–‡å­—çš„å›¾ç‰‡ç­‰ç­‰ã€‚è¿™é‡Œå°±ä¸¾ä¸€ä¸ªç®€å•ä¾‹å­ï¼Œæ›´å¤šç§ç±»çš„æ•°æ®å¯ä»¥æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£ã€‚</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> data = Mock.mock(&#123;</span><br><span class="line">    <span class="string">'code'</span>: <span class="number">200</span>,</span><br><span class="line">    <span class="string">'message'</span>: <span class="string">'success'</span>,</span><br><span class="line">    <span class="string">'data'</span>: &#123;</span><br><span class="line">        <span class="string">'list|5-10'</span>: [&#123;     <span class="comment">// éšæœºè¿”å›ä¸€ä¸ªåŒ…å«5åˆ°10ä¸ªå¯¹è±¡çš„æ•°ç»„</span></span><br><span class="line">            <span class="string">'num|0-100'</span>: <span class="number">0</span>, <span class="comment">// éšæœºè¿”å›ä¸€ä¸ª0åˆ°100çš„æ•´æ•°</span></span><br><span class="line">            <span class="string">'name'</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// éšæœºè¿”å›ä¸€ä¸ªå§“å</span></span><br><span class="line">                <span class="keyword">return</span> Mock.mock(<span class="string">'@cname'</span>)</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">'date'</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// éšæœºè¿”å›ä¸€ä¸ªæŒ‡å®šæ ¼å¼çš„æ—¥æœŸ</span></span><br><span class="line">                <span class="keyword">return</span> Mock.Random.date(<span class="string">'yyyy-MM-dd'</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;],</span><br><span class="line">        <span class="string">'img'</span>: Mock.Random.image(<span class="string">'450x400'</span>, <span class="string">'#50B347'</span>, <span class="string">'#FFF'</span>, <span class="string">'Hello!Mock.js!'</span>)</span><br><span class="line">        <span class="comment">// è¿”å›æŒ‡å®šå°ºå¯¸ã€é¢œè‰²å’Œæ–‡å­—çš„ä¸€å¼ å›¾</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>mockjsåœ¨æ¨¡æ‹Ÿæ•°æ®è¿™ä¸€å—éå¸¸çš„æ–¹ä¾¿ï¼Œç”šè‡³æœ‰æ—¶å€™mockjsæ¨¡æ‹Ÿçš„æ•°æ®æ¯”è”è°ƒçš„æ—¶å€™ï¼Œåç«¯åœ¨å¼€å‘ç¯å¢ƒæ•°æ®åº“é‡Œæ¨¡æ‹Ÿçš„æ•°æ®æ›´å…¨é¢ã€æƒ…å†µæ›´å¤šã€‚å‰ç«¯åœ¨æ‹¿åˆ°æ¥å£æ ¼å¼åï¼Œå¯ä»¥ç‹¬ç«‹äºåç«¯è¿›è¡Œå¼€å‘ï¼Œå¹¶ä¸”å‰åç«¯çš„å¼€å‘è¿›åº¦åŸºæœ¬ä¸Šä¸ä¼šç›¸äº’å½±å“ï¼Œè”è°ƒæˆæœ¬ä¹Ÿä¼šå¤§å¤§é™ä½ã€‚ä½†æ˜¯åœ¨å®é™…çš„åº”ç”¨ä¸­ï¼Œæˆ‘è¿˜æ˜¯å‘ç°mockjså­˜åœ¨ä¸€äº›å‘ç‚¹ï¼Œæ¯•ç«Ÿè¿™ä¸ªåº“çš„GitHubä¸Šissuesè¿˜æ˜¯æŒºå¤šçš„ã€‚</p><h2 id="å‘ç‚¹1ï¼šgetè¯·æ±‚ä¸èƒ½ä¼ å‚"><a href="#å‘ç‚¹1ï¼šgetè¯·æ±‚ä¸èƒ½ä¼ å‚" class="headerlink" title="å‘ç‚¹1ï¼šgetè¯·æ±‚ä¸èƒ½ä¼ å‚"></a>å‘ç‚¹1ï¼šgetè¯·æ±‚ä¸èƒ½ä¼ å‚</h2><p>mockjsåªä¼šæ‹¦æˆªä½ çš„è¯·æ±‚ï¼Œä½†ä¸ä¼šå¯¹ä½ è¯·æ±‚å‘é€çš„å‚æ•°è¿›è¡Œä»»ä½•éªŒè¯å¤„ç†ç­‰ã€‚æ‰€ä»¥åœ¨æ¨¡æ‹Ÿpostè¯·æ±‚æ•°æ®æ—¶ï¼Œæˆ‘å¯ä»¥æŒ‰ç…§çœŸå®æ¥å£çš„è¯·æ±‚æ–¹å¼ï¼ŒæŠŠè¯·æ±‚çš„å‚æ•°å®Œæ•´çš„å†™åœ¨ä»£ç é‡Œï¼Œå› ä¸ºæ— è®ºå‘é€ä»€ä¹ˆå‚æ•°ï¼Œæ•°æ®éƒ½ä¼šæŒ‰ç…§mockçš„æ ¼å¼æ­£ç¡®è¿”å›ã€‚</p><p>ä½†æ˜¯ï¼Œæˆ‘åœ¨æ¨¡æ‹Ÿgetè¯·æ±‚çš„æ—¶å€™ï¼Œå¦‚æœæºå¸¦ä¸Šæ¥å£éœ€è¦çš„å‚æ•°ï¼Œgetè¯·æ±‚ä¼šå°†å‚æ•°åŠ è½½è¯·æ±‚çš„urlåé¢ã€‚ä¾‹å¦‚ï¼Œæˆ‘åœ¨<code>mock.js</code>ä¸­è®¾ç½®çš„æ¥å£æ˜¯<code>//mock/base/getSomeData</code>,ç„¶åå‘é€getè¯·æ±‚å¹¶æºå¸¦å‚æ•°åï¼ŒçœŸå®åœ°å€å˜æˆäº†<code>//mock/base/getSomeData?userId=12345</code>ã€‚è¿™ä¸ªæ—¶å€™æˆ‘å‘ç°mockjså°±æ²¡åŠæ³•æ­£ç¡®çš„è¿”å›mockæ•°æ®äº†ï¼Œæˆ‘æŸ¥é˜…äº†mockjsæ–‡æ¡£ï¼Œæœ‰çœ‹åˆ°å…³äºgetè¯·æ±‚çš„æ¨¡æ‹Ÿï¼Œä½†æ˜¯å°è¯•ä¹‹åå‘ç°ä»»ç„¶æ²¡ç”¨ï¼Œæ‰€ä»¥æˆ‘å°±åªèƒ½åœ¨å°è£…getè¯·æ±‚çš„æ—¶å€™ï¼Œåˆ¤æ–­ä¸€ä¸‹å½“å‰çŠ¶æ€æ˜¯mockçŠ¶æ€è¿˜æ˜¯émockçŠ¶æ€ï¼Œå¦‚æœæ˜¯mockçŠ¶æ€å°±ä¸æºå¸¦å‚æ•°ï¼Œè™½ç„¶æ–¹æ³•æœ‰ç‚¹ç¬¨ï¼Œä½†ä¹Ÿç®—æ˜¯è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œå¹¶ä¸”åœ¨è”è°ƒçš„æ—¶å€™ï¼Œä¸éœ€è¦ä¿®æ”¹ä¸šåŠ¡é€»è¾‘å±‚çš„ä»£ç ã€‚å¦‚ä¸‹ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> mock = <span class="literal">true</span> <span class="comment">// false</span></span><br><span class="line"><span class="keyword">let</span> baseURL = mock ? <span class="string">'//mock/'</span> : <span class="string">`//activity.f***s.cn/`</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    get(url, params) &#123;</span><br><span class="line">        <span class="keyword">return</span> Axios(&#123;</span><br><span class="line">            url: url,</span><br><span class="line">            method: <span class="string">'get'</span>,</span><br><span class="line">            baseURL: baseURL,</span><br><span class="line">            params: mock ? &#123;&#125; : params,</span><br><span class="line">            withCredentials: <span class="literal">true</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="å‘ç‚¹2ï¼šæ— æ³•æºå¸¦cookie"><a href="#å‘ç‚¹2ï¼šæ— æ³•æºå¸¦cookie" class="headerlink" title="å‘ç‚¹2ï¼šæ— æ³•æºå¸¦cookie"></a>å‘ç‚¹2ï¼šæ— æ³•æºå¸¦cookie</h2><p>è¿™ä¸ªå‘å°±å‰å®³äº†ï¼Œæ›¾ç»æ•´æ•´æŠ˜ç£¨äº†æˆ‘ä¸€ä¸ªä¸‹åˆã€‚ã€‚ã€‚ã€‚ã€‚ã€‚</p><p>å‰ä¸ä¹…ï¼Œåœ¨å¼€å‘ä¸€ä¸ªåå°ç®¡ç†é¡¹ç›®çš„æ—¶å€™ï¼Œåç«¯å†™å¥½äº†ä¸€ä¸ªç”¨æˆ·ä¿¡æ¯éªŒè¯æ¥å£å‡†å¤‡å’Œæˆ‘ä¸€èµ·è°ƒè¯•ä¸€ä¸‹ï¼Œè¿™ä¸ªæ¥å£éœ€è¦æºå¸¦cookieã€‚æˆ‘å°±ä»mockæ¨¡å¼åˆ‡æ¢åˆ°émockæ¨¡å¼ï¼Œä»…ä»…ä¿®æ”¹äº†å°è£…è¯·æ±‚çš„jsæ–‡ä»¶ä¸­çš„<code>let mock = false</code>ï¼Œç„¶åæˆ‘å°±å¤©çœŸåœ°ä»¥ä¸ºï¼Œå¯ä»¥é¡ºåˆ©çš„è°ƒè¯•æ­£å¼æ¥å£äº†ã€‚ä½†æˆ‘å‘ç°æˆ‘å‰ç«¯è¯·æ±‚å¤´è®¾ç½®äº†<code>withCredentials: true</code>ï¼Œåç«¯å“åº”å¤´ä¹Ÿè®¾ç½®äº†<code>&#39;Access-Control-Allow-Credentials&#39;, &#39;true&#39;</code>ï¼Œä½†æ˜¯å‘é€çš„è¯·æ±‚å°±æ˜¯æ­»æ´»æºå¸¦ä¸ä¸Šcookie ğŸ™‚æˆ‘å’Œéš”å£ç»„ä¸¤ä¸ªå‰ç«¯ï¼Œä¸‰ä¸ªäººèŠ±äº†å¤§åŠä¸ªä¸‹åˆçš„æ—¶é—´ï¼Œæœ€åå‘ç°æ˜¯å¼•ç”¨äº†mockjsæ¨¡å—çš„åŸå› ã€‚åæ¥å»GitHubä¸Šæœäº†mockjsçš„æºç ï¼Œæœç´¢å‡ºæ¥è¿™ä¹ˆä¸€è¡Œã€‚</p><p><img src="/2018/04/24/2fe-mock/fe-mock/withCredentials.jpg" alt="mockjs"></p><p>ç„¶åæˆ‘å½“æ—¶å°±å¿ƒé‡ŒMMPäº†ğŸ™‚ã€‚ã€‚ã€‚<br>å®ƒæ‹¦æˆªäº†æˆ‘çš„è¯·æ±‚ï¼Œå¹¶ä¸”ä¿®æ”¹äº†<code>withCredentials</code>ï¼Œæ‰€ä»¥cookieæºå¸¦ä¸ä¸Šã€‚æˆ‘çš„æ‰€ä»¥ä¸‹æ¬¡â€œåˆ‡æ¢émockæ¨¡å¼â€çš„æ—¶å€™ï¼Œè¿˜éœ€è¦æ³¨é‡Šæ‰<code>require(&#39;mockjs)</code>ï¼Œä¹Ÿç®—æ˜¯åƒä¸€å ‘é•¿ä¸€æ™ºå§ã€‚</p><h1 id="Express-Mockjs"><a href="#Express-Mockjs" class="headerlink" title="Express+Mockjs"></a>Express+Mockjs</h1><p>expressæ˜¯ä¸€ä¸ªåŸºäºNode.jså¹³å°çš„webå¼€å‘æ¡†æ¶ã€‚<br>mockjsæ¨¡æ‹Ÿæ•°æ®å›ºç„¶å¾ˆæ–¹ä¾¿ï¼Œä½†å®ƒä»…ä»…ä½¿ç”¨æ¥æ¨¡æ‹Ÿæ¥å£æ•°æ®çš„ï¼Œå¦‚æœæƒ³æŠŠå‰ç«¯æ•°æ®mockçš„è¿‡ç¨‹æ›´çœŸå®ï¼Œæ›´æ¥è¿‘æ­£å¼çš„è¯·æ±‚ï¼Œé‚£å¯ä»¥ç»“åˆexpressæ¥èµ·ä¸€ä¸ªåç«¯æœåŠ¡å™¨ï¼Œæ¨¡æ‹Ÿæ•´ä¸ªè¯·æ±‚çš„å‘é€æ¥æ”¶è¿‡ç¨‹ã€‚</p><h2 id="å®‰è£…-1"><a href="#å®‰è£…-1" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>æ–°å»ºä¸€ä¸ªmockæœåŠ¡ç«¯çš„å°demoï¼Œå®‰è£…mockjså’Œexpressï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install express mockjs --save-dev</span><br></pre></td></tr></table></figure><h2 id="æ­å»ºæœåŠ¡"><a href="#æ­å»ºæœåŠ¡" class="headerlink" title="æ­å»ºæœåŠ¡"></a>æ­å»ºæœåŠ¡</h2><p>æ–°å»ºä¸€ä¸ª<code>server.js</code>æ–‡ä»¶:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"><span class="keyword">let</span> app = express()</span><br><span class="line"></span><br><span class="line">app.all(<span class="string">'/api/demo'</span>, (req, res) =&gt; &#123;</span><br><span class="line">    res.send(<span class="string">'Mock!! This is MockData!!'</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">let</span> server = app.listen(<span class="number">9999</span>, () =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> port = server.address().port</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'server running successful...'</span>)</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`server listening at http://localhost:<span class="subst">$&#123;port&#125;</span>`</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>è¿è¡Œ<code>node server.js</code>æŠŠæœåŠ¡è·‘èµ·æ¥åï¼Œæµè§ˆå™¨æ‰“å¼€<code>http://localhost:9999/api/demo</code>ï¼Œå¯ä»¥çœ‹åˆ°<code>Mock!! This is MockData!!</code>ã€‚</p><h2 id="å¼•å…¥mockjs"><a href="#å¼•å…¥mockjs" class="headerlink" title="å¼•å…¥mockjs"></a>å¼•å…¥mockjs</h2><p>ä¿®æ”¹<code>server.js</code>æ–‡ä»¶ï¼ŒæŠŠå‰é¢ä»‹ç»çš„mockjsæ¨¡æ‹Ÿçš„æ•°æ®ï¼Œå¹¶æ”¾åˆ°responseä¸­:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"><span class="keyword">let</span> Mock = <span class="built_in">require</span>(<span class="string">'mockjs'</span>)</span><br><span class="line"><span class="keyword">let</span> app = express()</span><br><span class="line"></span><br><span class="line">app.all(<span class="string">'/api/demo'</span>, (req, res) =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> data = Mock.mock(&#123;</span><br><span class="line">        <span class="string">'code'</span>: <span class="number">200</span>,</span><br><span class="line">        <span class="string">'message'</span>: <span class="string">'success'</span>,</span><br><span class="line">        <span class="string">'data'</span>: &#123;</span><br><span class="line">            <span class="string">'list|5-10'</span>: [&#123;     <span class="comment">// éšæœºè¿”å›ä¸€ä¸ªåŒ…å«5åˆ°10ä¸ªå¯¹è±¡çš„æ•°ç»„</span></span><br><span class="line">                <span class="string">'num|0-100'</span>: <span class="number">0</span>, <span class="comment">// éšæœºè¿”å›ä¸€ä¸ª0åˆ°100çš„æ•´æ•°</span></span><br><span class="line">                <span class="string">'name'</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// éšæœºè¿”å›ä¸€ä¸ªå§“å</span></span><br><span class="line">                    <span class="keyword">return</span> Mock.mock(<span class="string">'@cname'</span>)</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="string">'date'</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123; <span class="comment">// éšæœºè¿”å›ä¸€ä¸ªæŒ‡å®šæ ¼å¼çš„æ—¥æœŸ</span></span><br><span class="line">                    <span class="keyword">return</span> Mock.Random.date(<span class="string">'yyyy-MM-dd'</span>)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;],</span><br><span class="line">            <span class="string">'img'</span>: Mock.Random.image(<span class="string">'450x400'</span>, <span class="string">'#50B347'</span>, <span class="string">'#FFF'</span>, <span class="string">'Hello!Mock.js!'</span>)</span><br><span class="line">            <span class="comment">// è¿”å›æŒ‡å®šå°ºå¯¸ã€é¢œè‰²å’Œæ–‡å­—çš„ä¸€å¼ å›¾</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    res.json(data)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">let</span> server = app.listen(<span class="number">9999</span>, () =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> port = server.address().port</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'server running successfully...'</span>)</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`server listening at http://localhost:<span class="subst">$&#123;port&#125;</span>`</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>æµè§ˆå™¨è®¿é—®<code>http://localhost:9999/api/demo</code>åå¯ä»¥çœ‹åˆ°ç›¸åº”çš„æ¨¡æ‹Ÿæ•°æ®ã€‚</p><h2 id="ä¿®æ”¹å‰ç«¯è¯·æ±‚å°è£…"><a href="#ä¿®æ”¹å‰ç«¯è¯·æ±‚å°è£…" class="headerlink" title="ä¿®æ”¹å‰ç«¯è¯·æ±‚å°è£…"></a>ä¿®æ”¹å‰ç«¯è¯·æ±‚å°è£…</h2><p>æœ‰äº†å‰é¢çš„æ€è·¯ï¼Œæˆ‘ä»¬ä¿®æ”¹å‰ç«¯é¡¹ç›®å°è£…è¯·æ±‚çš„æ–‡ä»¶ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> mock = <span class="literal">true</span> <span class="comment">// true</span></span><br><span class="line"><span class="keyword">let</span> baseURL = mock ? <span class="string">'//localhost:9999/'</span> : <span class="string">`//activity.f***s.cn/`</span></span><br></pre></td></tr></table></figure><p>å³åœ¨â€œmockæ¨¡å¼ä¸‹â€ï¼Œå‰ç«¯çš„è¯·æ±‚å…¨éƒ½å»è¯·æ±‚æœ¬åœ°çš„<code>9999</code>ç«¯å£çš„æœåŠ¡ã€‚</p><h2 id="å®Œå–„mockæœåŠ¡ç«¯"><a href="#å®Œå–„mockæœåŠ¡ç«¯" class="headerlink" title="å®Œå–„mockæœåŠ¡ç«¯"></a>å®Œå–„mockæœåŠ¡ç«¯</h2><p>ç„¶åï¼Œæˆ‘ä»¬å†æŠŠmockæœåŠ¡ç«¯é¡¹ç›®å®Œå–„ä¸€ä¸‹ã€‚ä¸ºäº†æ–¹ä¾¿å’Œåç«¯çš„æ­£å¼æ¥å£ä¸€ä¸€å¯¹åº”ï¼Œæˆ‘åœ¨mockæœåŠ¡ç«¯é¡¹ç›®æ–°å»ºä¸€ä¸ªmockApiæ–‡ä»¶å¤¹ï¼Œå¹¶åœ¨é‡Œé¢æŒ‰ç…§æ­£å¼æ¥å£çš„åç§°å±‚çº§ï¼Œåˆ›å»ºæ¯ä¸ªæ¥å£å¯¹åº”çš„mockæ–‡ä»¶ã€‚ä¾‹å¦‚ï¼Œæœ‰ä¸ªåç§°ä¸º<code>/base/getUserInfoFromPC</code>çš„æ¥å£ï¼Œå°±åœ¨<code>./mockApi/base</code>ç›®å½•ä¸‹æ–°å»ºgetUserInfoFromPC.jsæ–‡ä»¶ï¼Œæ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> Mock = <span class="built_in">require</span>(<span class="string">'mockjs'</span>)</span><br><span class="line"><span class="keyword">let</span> data = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> Mock.mock(&#123;</span><br><span class="line">        <span class="string">'code'</span>: <span class="number">200</span>,</span><br><span class="line">        <span class="string">'data'</span>: &#123;</span><br><span class="line">            <span class="string">'nickName'</span>: <span class="string">'alexixiang'</span>,</span><br><span class="line">            <span class="string">'id'</span>: <span class="number">1707000766</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">module</span>.exports = data</span><br></pre></td></tr></table></figure><p>ç„¶åä¿®æ”¹server.jsæ–‡ä»¶ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> express = <span class="built_in">require</span>(<span class="string">'express'</span>)</span><br><span class="line"><span class="keyword">let</span> app = express()</span><br><span class="line"><span class="keyword">let</span> baseRoot = <span class="string">'./mockApi'</span> <span class="comment">// mockæ•°æ®æ–‡ä»¶å¤¹è·¯å¾„</span></span><br><span class="line">app.post(<span class="string">'/base/getUserInfoFromPC'</span>, (req, res) =&gt; &#123;</span><br><span class="line">    res.json(<span class="built_in">require</span>(<span class="string">`<span class="subst">$&#123;baseRoot&#125;</span>/base/getUserInfoFromPC.js`</span>)())</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">let</span> server = app.listen(<span class="number">9999</span>, () =&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> port = server.address().port</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'server running successfully...'</span>)</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">`server listening at http://localhost:<span class="subst">$&#123;port&#125;</span>`</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨å¼€å‘ä¸­ï¼Œæœ¬åœ°éœ€è¦è·‘ä¸¤ä¸ªæœåŠ¡ï¼Œä¸€ä¸ªæ˜¯mockæœåŠ¡ç«¯ï¼Œå¦ä¸€ä¸ªæ˜¯æœ¬åœ°çš„å‰ç«¯é¡µé¢ã€‚é€šå¸¸ä¸¤ä¸ªæœåŠ¡çš„ç«¯å£ä¸ä¸€æ ·ï¼Œå­˜åœ¨è·¨åŸŸé—®é¢˜ï¼Œæ‰€ä»¥è¿˜éœ€è¦åœ¨<code>server.js</code>ä¸­æ·»åŠ é…ç½®è·¨åŸŸï¼Œå¦‚æœéœ€è¦æºå¸¦cookieè¿˜éœ€è¦è®¾ç½®<code>&#39;Access-Control-Allow-Credentials&#39;, &#39;true&#39;</code>:</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ä¸­é—´ä»¶</span></span><br><span class="line">app.use(<span class="function">(<span class="params">req, res, next</span>) =&gt;</span> &#123;</span><br><span class="line">    res.header(<span class="string">'Access-Control-Allow-Origin'</span>, req.headers.origin)</span><br><span class="line">    res.header(<span class="string">'Access-Control-Allow-Headers'</span>, <span class="string">'Content-Type'</span>)</span><br><span class="line">    res.header(<span class="string">'Access-Control-Allow-Methods'</span>, <span class="string">'PUT, GET, POST, DELETE, OPTIONS'</span>)</span><br><span class="line">    res.header(<span class="string">'Access-Control-Allow-Credentials'</span>, <span class="string">'true'</span>)</span><br><span class="line">    next()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>è‡³æ­¤ï¼Œåˆ©ç”¨expresså’Œmockjsæ­å»ºçš„mockæœåŠ¡ç«¯å°±åŸºæœ¬å®Œæˆäº†ã€‚æˆ‘è§‰å¾—è¿™ç§æ–¹æ³•ç›¸æ¯”äºç¬¬ä¸€ç§æ–¹æ³•å¥½å¤„æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š</p><ul><li>å‰é¢è®²åˆ°çš„ä¸¤ä¸ªå‘ç‚¹ï¼Œä¸ä¼šå†å‡ºç°äº†ã€‚</li><li>mockä»£ç éƒ½åœ¨mockæœåŠ¡ç«¯å†™ï¼Œå‰ç«¯é¡¹ç›®ä¸å†™mockç›¸å…³ä»£ç ã€‚æŠŠå‰ç«¯é¡¹ç›®çš„ä¸šåŠ¡é€»è¾‘ã€æ¥å£è¯·æ±‚å’Œmockæ•°æ®çš„ä»£ç ç‹¬ç«‹å¼€æ¥ï¼Œä¸ä¼šç›¸äº’å½±å“ã€‚</li><li>è€Œä¸”åœ¨mockæœåŠ¡ç«¯è¿˜å¯ä»¥å¯¹è¯·æ±‚çš„ä¼ å‚è¿›è¡Œä¸€äº›ç®€å•çš„åˆ¤æ–­å’Œå¤„ç†ç­‰ï¼Œä»è€Œè®©æ•´ä¸ªmockæ•°æ®çš„è¿‡ç¨‹æ›´æ¥è¿‘æ­£å¼è”è°ƒæ¥å£çš„çŠ¶æ€ã€‚</li></ul><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>å‰ç«¯æ•°æ®mockæœ¬èº«æ˜¯ä¸€ä¸ªå¯å¤§å¯å°ã€å¯ç¹å¯ç®€çš„å¼€å‘æµç¨‹ã€‚ä½†æ˜¯åœ¨å®é™…å¼€å‘ä¸­ï¼Œä¸€ä¸ªæ–°çš„é¡¹ç›®é€šå¸¸éƒ½æ˜¯å‰åç«¯åŒæ—¶è¿›è¡Œå¼€å‘ï¼Œä¸ºäº†é™ä½å‰åç«¯æ¥å£è”è°ƒçš„æˆæœ¬ï¼Œæé«˜è”è°ƒæ•ˆç‡ï¼Œå®Œå–„å‰ç«¯mockæ•°æ®å’Œmockæ¥å£è¯·æ±‚çš„è¿‡ç¨‹æ˜¯å¾ˆæœ‰å¿…è¦çš„ã€‚<br>å‰ç«¯mockçš„æ–¹æ³•å°±ç®€å•ä»‹ç»åˆ°è¿™é‡Œï¼Œæ¬¢è¿å„ä½å¤§ä½¬æ‰¹è¯„æŒ‡æ­£ã€‚</p><h1 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h1><ul><li>mockï¼š<a href="http://mockjs.com/" target="_blank" rel="noopener">http://mockjs.com/</a></li><li>expressï¼š<a href="http://www.expressjs.com.cn/" target="_blank" rel="noopener">http://www.expressjs.com.cn/</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> share </category>
          
      </categories>
      
      
        <tags>
            
            <tag> share </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>VUEXå­¦ä¹ ç¬”è®°</title>
      <link href="/2018/03/07/1vuex/"/>
      <url>/2018/03/07/1vuex/</url>
      
        <content type="html"><![CDATA[<p><img src="/2018/03/07/1vuex/./vuex.png" width="400px"><br>vuexå­¦ä¹ ç¬”è®°</p><a id="more"></a><hr><h1 id="Vuex-ç®€ä»‹"><a href="#Vuex-ç®€ä»‹" class="headerlink" title="Vuex ç®€ä»‹"></a>Vuex ç®€ä»‹</h1><p>Vuex æ˜¯ä¸€ä¸ªä¸“ä¸º Vue.js åº”ç”¨ç¨‹åºå¼€å‘çš„çŠ¶æ€ç®¡ç†æ¨¡å¼ã€‚æˆ‘ä»¬å¯ä»¥åˆ©ç”¨vuexæ¥ç®¡ç†å¤šä¸ªç»„ä»¶çš„å…±äº«çŠ¶æ€ã€‚</p><p>æ¯ä¸€ä¸ª Vuex åº”ç”¨çš„æ ¸å¿ƒå°±æ˜¯ storeï¼ˆä»“åº“ï¼‰ã€‚â€œstoreâ€åŸºæœ¬ä¸Šå°±æ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œå®ƒåŒ…å«ç€ä½ çš„åº”ç”¨ä¸­å¤§éƒ¨åˆ†çš„çŠ¶æ€ (state)ã€‚Vuex å’Œå•çº¯çš„å…¨å±€å¯¹è±¡æœ‰ä»¥ä¸‹ä¸¤ç‚¹ä¸åŒï¼š</p><ul><li><p>Vuex çš„çŠ¶æ€å­˜å‚¨æ˜¯å“åº”å¼çš„ã€‚å½“ Vue ç»„ä»¶ä» store ä¸­è¯»å–çŠ¶æ€çš„æ—¶å€™ï¼Œè‹¥ store ä¸­çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆç›¸åº”çš„ç»„ä»¶ä¹Ÿä¼šç›¸åº”åœ°å¾—åˆ°é«˜æ•ˆæ›´æ–°ã€‚</p></li><li><p>ä½ ä¸èƒ½ç›´æ¥æ”¹å˜ store ä¸­çš„çŠ¶æ€ã€‚æ”¹å˜ store ä¸­çš„çŠ¶æ€çš„å”¯ä¸€é€”å¾„å°±æ˜¯æ˜¾å¼åœ°æäº¤ (commit) mutationã€‚è¿™æ ·ä½¿å¾—æˆ‘ä»¬å¯ä»¥æ–¹ä¾¿åœ°è·Ÿè¸ªæ¯ä¸€ä¸ªçŠ¶æ€çš„å˜åŒ–ï¼Œä»è€Œè®©æˆ‘ä»¬èƒ½å¤Ÿå®ç°ä¸€äº›å·¥å…·å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°äº†è§£æˆ‘ä»¬çš„åº”ç”¨ã€‚</p></li></ul><h1 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h1><p>ä½¿ç”¨npmå®‰è£…vuex<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install vuex --save-dev</span><br></pre></td></tr></table></figure></p><h1 id="ç®€å•ç”¨æ³•"><a href="#ç®€å•ç”¨æ³•" class="headerlink" title="ç®€å•ç”¨æ³•"></a>ç®€å•ç”¨æ³•</h1><p>é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦åœ¨srcç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªstoreç›®å½•ï¼Œç”¨æ¥å¯¹é¡¹ç›®çš„å„ä¸ªçŠ¶æ€è¿›è¡Œç®¡ç†ã€‚å†storeæ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸€ä¸ªindex.jsï¼Œä½œä¸ºæ•´ä¸ªé¡¹ç›®çŠ¶æ€ç®¡ç†çš„å…¥å£æ–‡ä»¶ï¼ˆå°±å¥½æ¯”äºrouteæ–‡ä»¶ä¸‹çš„index.jsï¼‰ã€‚ç„¶ååœ¨index.jsä¸­æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> vuex <span class="keyword">from</span> <span class="string">'vuex'</span></span><br><span class="line">Vue.use(vuex)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> vuex.Store(&#123;</span><br><span class="line">    state: &#123;</span><br><span class="line">        hasLogin: <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store</span><br></pre></td></tr></table></figure></p><p>è¿™æ ·æˆ‘ä»¬å°±å®šä¹‰å¥½äº†ä¸€ä¸ªç®€å•çš„storeï¼Œæ¥ä¸‹æ¥éœ€è¦åœ¨é¡¹ç›®å…¥å£æ–‡ä»¶çš„Vueå®ä¾‹ä¸­è½½å…¥è¿™ä¸ªstoreã€‚ä¿®æ”¹main.jså¦‚ä¸‹ï¼š<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./App'</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">'./store'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    el: <span class="string">'#app'</span>,</span><br><span class="line">    store,</span><br><span class="line">    components: &#123; App &#125;,</span><br><span class="line">    template: <span class="string">'&lt;App/&gt;'</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p><p>ç„¶åæˆ‘ä»¬åœ¨é¡µé¢ä¸Šä½¿ç”¨ <code>this.$store.state.hasLogin</code> å°±å¯ä»¥è·å–åˆ°hasLoginè¿™ä¸ªçŠ¶æ€ã€‚<br>ä½†æ˜¯åœ¨å®é™…å¼€å‘ä¸­ï¼Œæœ‰æ—¶å€™è¿™æ ·ç®€å•çš„ç”¨æ³•ä¸èƒ½æ»¡è¶³å¤æ‚çš„çŠ¶æ€ç®¡ç†éœ€æ±‚ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦è¿›ä¸€æ­¥çš„å­¦ä¹ Vuexçš„å‡ ä¸ªæ ¸å¿ƒæ¦‚å¿µã€‚</p><h1 id="State"><a href="#State" class="headerlink" title="State"></a>State</h1><p>stateå¯ä»¥ç†è§£æˆçŠ¶æ€ï¼Œå®ƒè®°å½•äº†æ•´ä¸ªé¡¹ç›®çš„å„ä¸ªçŠ¶æ€å±æ€§ã€‚Vuexä½¿ç”¨å•ä¸€çŠ¶æ€æ ‘ï¼Œç®€å•çš„è¯´ï¼Œå°±æ˜¯æ¯ä¸ªåº”ç”¨ä»…ä»…åŒ…å«ä¸€ä¸ªstoreå®ä¾‹ã€‚åªè¦åœ¨æ ¹å®ä¾‹ä¸­æ³¨å†Œäº† store é€‰é¡¹ï¼Œè¯¥ store å®ä¾‹ä¼šæ³¨å…¥åˆ°æ ¹ç»„ä»¶ä¸‹çš„æ‰€æœ‰å­ç»„ä»¶ä¸­ï¼Œç„¶åå­ç»„ä»¶å°±éƒ½å¯ä»¥é€šè¿‡ <code>this.$store</code> è®¿é—®åˆ°äº†ã€‚ä¾‹å¦‚ä¸Šé¢çš„ä»£ç ä¸­ï¼Œåœ¨æ•´ä¸ªé¡¹ç›®çš„vueç»„ä»¶ä¸­éƒ½å¯ä»¥ä½¿ç”¨<code>this.$store.state.hasLogin</code> æ¥è·å–hasLoginè¿™ä¸ªçŠ¶æ€ã€‚åœ¨Vueç»„ä»¶ä¸­ï¼Œé€šå¸¸ä½¿ç”¨è®¡ç®—å±æ€§è¿”å›æŸä¸ªçŠ¶æ€ï¼Œæ¥è·å¾—VuexçŠ¶æ€ã€‚</p><h1 id="Getter"><a href="#Getter" class="headerlink" title="Getter"></a>Getter</h1><p>æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦ä»storeä¸­çš„stateä¸­æ´¾ç”Ÿå‡ºä¸€äº›çŠ¶æ€ï¼Œä¾‹å¦‚æŸä¸ªstateçš„å€¼æ˜¯éšç€å¦ä¸ªstateçš„å€¼çš„å˜åŒ–è€Œå˜åŒ–çš„ã€‚è¿™æ—¶å€™æˆ‘ä»¬å°±éœ€è¦ç”¨åˆ°getterï¼Œå¯ä»¥ç†è§£ä¸º store çš„è®¡ç®—å±æ€§ã€‚getter çš„è¿”å›å€¼ä¼šæ ¹æ®å®ƒçš„ä¾èµ–è¢«ç¼“å­˜èµ·æ¥ï¼Œä¸”åªæœ‰å½“å®ƒçš„ä¾èµ–å€¼å‘ç”Ÿäº†æ”¹å˜æ‰ä¼šè¢«é‡æ–°è®¡ç®—ã€‚<br>ä¿®æ”¹storeæ–‡ä»¶å¤¹ä¸‹çš„index.jsï¼š<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> vuex <span class="keyword">from</span> <span class="string">'vuex'</span></span><br><span class="line">Vue.use(vuex)</span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> vuex.Store(&#123;</span><br><span class="line">    state: &#123;</span><br><span class="line">        userId: <span class="number">123456</span>,</span><br><span class="line">        hasLogin: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// æ ¹æ®æŸä¸ªstateè®¡ç®—ä¸€äº›è·Ÿå®ƒæœ‰å…³ç³»çš„çŠ¶æ€ç­‰</span></span><br><span class="line">    getters: &#123;</span><br><span class="line">        defaultName(state) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">`user<span class="subst">$&#123;state.userId&#125;</span>`</span></span><br><span class="line">        &#125;,</span><br><span class="line">        isVisitor(state) &#123;</span><br><span class="line">            <span class="keyword">return</span> !state.hasLogin</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store</span><br></pre></td></tr></table></figure></p><p>åƒä¸Šé¢è¿™æ ·å®šä¹‰äº†ä¸¤ä¸ªgetterä¹‹åï¼Œå¯ä»¥åœ¨ä»»ä½•ç»„ä»¶ä¸­è®¿é—®è¿™äº›å€¼ï¼š<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.$store.getters.defaultName <span class="comment">// user123456</span></span><br><span class="line"><span class="keyword">this</span>.$store.getters.isVisitor <span class="comment">// false</span></span><br></pre></td></tr></table></figure></p><p>ä¸€æ—¦getterå¯¹è±¡ä¸­çš„å±æ€§æ‰€ä¾èµ–çš„stateå‘ç”Ÿäº†å˜åŒ–ï¼Œé‚£å¯¹åº”çš„getterå±æ€§ä¹Ÿä¼šè·Ÿç€å˜åŒ–</p><h1 id="Mutation"><a href="#Mutation" class="headerlink" title="Mutation"></a>Mutation</h1><p>mutationæ˜¯ç”¨æ¥ä¿®æ”¹Vuexçš„storeä¸­çš„çŠ¶æ€stateçš„ï¼Œå¹¶ä¸”è¿™æ˜¯å”¯ä¸€çš„æ–¹æ³•ã€‚åœ¨index.jsä¸­æ·»åŠ mutation:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> vuex <span class="keyword">from</span> <span class="string">'vuex'</span></span><br><span class="line">Vue.use(vuex)</span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> vuex.Store(&#123;</span><br><span class="line">    state: &#123;</span><br><span class="line">        userId: <span class="number">123456</span>,</span><br><span class="line">        hasLogin: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// æ ¹æ®æŸä¸ªstateè®¡ç®—ä¸€äº›è·Ÿå®ƒæœ‰å…³ç³»çš„çŠ¶æ€ç­‰</span></span><br><span class="line">    getters: &#123;</span><br><span class="line">        defaultName(state) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">`ç”¨æˆ·<span class="subst">$&#123;state.userId&#125;</span>`</span></span><br><span class="line">        &#125;,</span><br><span class="line">        isVisitor(state) &#123;</span><br><span class="line">            <span class="keyword">return</span> !state.hasLogin</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// ä¿®æ”¹stateä¸­çš„å±æ€§</span></span><br><span class="line">    mutations: &#123;</span><br><span class="line">        <span class="comment">// ç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥stateï¼Œç¬¬äºŒä¸ªå‚æ•°(å¯é€‰)ä¼ å…¥é¢å¤–çš„å‚æ•°(è½½è·payload)</span></span><br><span class="line">        switchUser(state, newId) &#123;</span><br><span class="line">            <span class="comment">// åˆ‡æ¢ç”¨æˆ·ï¼Œä¿®æ”¹å­˜å‚¨çš„ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">            state.userId = newId</span><br><span class="line">        &#125;,</span><br><span class="line">        logout(state) &#123;</span><br><span class="line">            state.hasLogin = !state.hasLogin</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store</span><br></pre></td></tr></table></figure></p><p>å®šä¹‰å¥½mutationåï¼Œåœ¨ä»»ä½•ç»„ä»¶ä¸­è°ƒç”¨ store.commit æ–¹æ³•å°±å¯ä»¥å¯¹stateè¿›è¡Œä¿®æ”¹ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.$store.commit(<span class="string">'switchUser'</span>, <span class="number">654321</span>)</span><br><span class="line"><span class="keyword">this</span>.$store.commit(<span class="string">'logout'</span>)</span><br></pre></td></tr></table></figure><h1 id="Action"><a href="#Action" class="headerlink" title="Action"></a>Action</h1><p>Action å’Œ mutationæ¯”è¾ƒç±»ä¼¼ï¼Œä½†ä¸åŒåœ¨äºï¼š</p><ul><li>Actionæäº¤çš„æ˜¯mutationï¼Œè€Œä¸æ˜¯ç›´æ¥å˜æ›´çŠ¶æ€ã€‚</li><li>Actionå¯ä»¥åŒ…å«ä»»æ„å¼‚æ­¥æ“ä½œã€‚</li></ul><p>åœ¨index.jsä¸­æ·»åŠ action:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> vuex <span class="keyword">from</span> <span class="string">'vuex'</span></span><br><span class="line">Vue.use(vuex)</span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> vuex.Store(&#123;</span><br><span class="line">    state: &#123;</span><br><span class="line">        userId: <span class="number">123456</span>,</span><br><span class="line">        hasLogin: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// æ ¹æ®æŸä¸ªstateè®¡ç®—ä¸€äº›è·Ÿå®ƒæœ‰å…³ç³»çš„çŠ¶æ€ç­‰</span></span><br><span class="line">    getters: &#123;</span><br><span class="line">        defaultName(state) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">`ç”¨æˆ·<span class="subst">$&#123;state.userId&#125;</span>`</span></span><br><span class="line">        &#125;,</span><br><span class="line">        isVisitor(state) &#123;</span><br><span class="line">            <span class="keyword">return</span> !state.hasLogin</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// ä¿®æ”¹stateä¸­çš„å±æ€§</span></span><br><span class="line">    mutations: &#123;</span><br><span class="line">        <span class="comment">// ç¬¬ä¸€ä¸ªå‚æ•°ä¼ å…¥stateï¼Œç¬¬äºŒä¸ªå‚æ•°(å¯é€‰)ä¼ å…¥é¢å¤–çš„å‚æ•°(è½½è·payload)</span></span><br><span class="line">        switchUser(state, newId) &#123;</span><br><span class="line">            <span class="comment">// åˆ‡æ¢ç”¨æˆ·ï¼Œä¿®æ”¹å­˜å‚¨çš„ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">            state.userId = newId</span><br><span class="line">        &#125;,</span><br><span class="line">        logout(state) &#123;</span><br><span class="line">            state.hasLogin = !state.hasLogin</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// æ“ä½œmutation</span></span><br><span class="line">    actions: &#123;</span><br><span class="line">        logout(context) &#123;</span><br><span class="line">            context.commit(<span class="string">'logout'</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store</span><br></pre></td></tr></table></figure></p><p>Action å‡½æ•°æ¥å—ä¸€ä¸ªä¸ store å®ä¾‹å…·æœ‰ç›¸åŒæ–¹æ³•å’Œå±æ€§çš„ context å¯¹è±¡ï¼Œå› æ­¤åœ¨actionä¸­ï¼Œå¯ä»¥è°ƒç”¨ <code>context.commit</code> æäº¤ä¸€ä¸ª mutationï¼Œæˆ–è€…é€šè¿‡ <code>context.state</code> å’Œ <code>context.getters</code> æ¥è·å– state å’Œ gettersã€‚</p><p>å®šä¹‰å¥½actionåï¼Œvueç»„ä»¶ä¸­é€šè¿‡<code>store.dispatch</code>è§¦å‘ï¼š<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">this</span>.$store.dispatch(<span class="string">'login'</span>)</span><br></pre></td></tr></table></figure></p><p>actionå†…éƒ¨å¯ä»¥æ‰§è¡Œå¼‚æ­¥æ“ä½œï¼Œä¹Ÿå¯ä»¥åƒmutationä¸€æ ·ç”¨è½½è·çš„æ–¹å¼åˆ†å‘ã€‚</p><h1 id="Module"><a href="#Module" class="headerlink" title="Module"></a>Module</h1><p>å¦‚æœé¡¹ç›®æœ‰å¾ˆå¤šçš„çŠ¶æ€éœ€è¦ç®¡ç†ï¼Œä½†å´æŠŠstoreå…¨éƒ½å†™åœ¨index.jsä¸­ï¼Œä¼šæ˜¾å¾—å¾ˆè‡ƒè‚¿ä¸ä¾¿äºç»´æŠ¤ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å°†storeæ‹†åˆ†æˆä¸åŒçš„æ¨¡å—ï¼ˆmoduleï¼‰ï¼Œæ¯ä¸ªæ¨¡å—å¯ä»¥æ‹¥æœ‰è‡ªå·±çš„stateï¼Œmutationï¼Œactionã€‚<br>åœ¨storeæ–‡ä»¶å¤¹ä¸‹æ–°å»ºä¸€ä¸ªåä¸ºmodulesçš„æ–‡ä»¶å¤¹ï¼Œä¸‹é¢å¯ä»¥æ–°å»ºä¸€ä¸ªauthority.jsï¼Œå®šä¹‰ä¸€ä¸ªæ¨¡å—ï¼š<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç”¨æˆ·æƒé™çŠ¶æ€</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    state: &#123;</span><br><span class="line">        roles: []</span><br><span class="line">    &#125;,</span><br><span class="line">    getters: &#123;</span><br><span class="line">    &#125;,</span><br><span class="line">    mutations: &#123;</span><br><span class="line">    &#125;,</span><br><span class="line">    actions: &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p>ç„¶åä¿®æ”¹index.js:<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> vuex <span class="keyword">from</span> <span class="string">'vuex'</span></span><br><span class="line"><span class="keyword">import</span> authority <span class="keyword">from</span> <span class="string">'./modules/authority'</span></span><br><span class="line">Vue.use(vuex)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> vuex.Store(&#123;</span><br><span class="line">    modules: &#123;</span><br><span class="line">        authority: authority</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p><p>ç„¶ååœ¨ç»„ä»¶ä¸­é€šè¿‡<code>this.$store.state.authority.roles</code>æ¥è·å–state</p><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>vuexçš„åŸºæœ¬ç”¨æ³•å°±å†™åˆ°è¿™é‡Œï¼Œç®—æ˜¯è®°å½•å¹¶æ¢³ç†ä¸€ä¸‹è‡ªå·±å­¦ä¹ vuexçš„è¿‡ç¨‹ï¼Œæ¬¢è¿å„ä½å¤§ä½¬æ‰¹è¯„æŒ‡æ­£ã€‚<br>æ›´å¤šå…³äºvuexçš„é«˜çº§ç”¨æ³•å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ã€‚<br></p><h1 id="å‚è€ƒæ–‡çŒ®"><a href="#å‚è€ƒæ–‡çŒ®" class="headerlink" title="å‚è€ƒæ–‡çŒ®"></a>å‚è€ƒæ–‡çŒ®</h1><ul><li><a href="https://vuex.vuejs.org/zh-cn/" target="_blank" rel="noopener">https://vuex.vuejs.org/zh-cn/</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> study notes </category>
          
      </categories>
      
      
        <tags>
            
            <tag> study notes </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>First Blog</title>
      <link href="/2018/02/26/0firstblog/"/>
      <url>/2018/02/26/0firstblog/</url>
      
        <content type="html"><![CDATA[<p><img src="/2018/02/26/0firstblog/./alexi.jpg" width="400px"><br>Welcome to my personal website, this is my first blog.</p><a id="more"></a><hr><p>Metal never die.</p>]]></content>
      
      
      
        <tags>
            
            <tag> welcome </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
